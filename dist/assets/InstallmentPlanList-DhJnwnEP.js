import{r as n,K as z,c as p,a,b as o,w as s,o as g,t as i,C as f,h as I,m as h,n as N}from"./index-DPR0tjT6.js";import{u as A}from"./useApi-CTBDEoea.js";import{A as B}from"./AppDataTable-CV9gFKLg.js";import{_ as D}from"./AppButton-DiF3_7lr.js";import"./usePermissions-BOh6stgy.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const E={class:"installment-plans-page"},L={class:"px-6 pb-6"},S={key:0,class:"d-flex flex-column"},$={class:"font-weight-bold text-primary"},G={class:"text-caption text-grey"},T={key:1,class:"text-grey-lighten-1"},U={class:"font-weight-black text-h6"},j={class:"d-flex justify-end"},O={__name:"InstallmentPlanList",setup(F){const y=N(),x=A("/api/installment-plans"),_=n([]),r=n(!1),v=n(0),c=n(1),u=n(10),b=[{title:"الفاتورة",key:"invoice"},{title:"المبلغ الإجمالي",key:"total_amount",align:"end"},{title:"عدد الأقساط",key:"installments_count"},{title:"الحالة",key:"status"},{title:"الإجراءات",key:"actions",sortable:!1,align:"end"}],k=e=>e?new Intl.NumberFormat("ar-EG",{style:"currency",currency:"EGP"}).format(e):"0.00 ج.م",w=e=>({active:"success",completed:"info",cancelled:"error"})[e]||"grey",P=e=>({active:"نشط",completed:"مكتمل",cancelled:"ملغي"})[e]||e,C=e=>{y.push(`/installments/${e.id}`)},d=async()=>{r.value=!0;try{const e=await x.get({page:c.value,per_page:u.value},{showLoading:!1});_.value=e.data||[],v.value=e.total||0}finally{r.value=!1}},V=e=>{u.value=e,c.value=1,d()};return z(d),(e,l)=>(g(),p("div",E,[l[1]||(l[1]=a("div",{class:"mb-6 px-6 pt-6"},[a("h1",{class:"text-h4 font-weight-bold"},"خطط التقسيط"),a("p",{class:"text-body-1 text-grey"},"متابعة وإدارة جدول تحصيل الأقساط والمدفوعات الآجلة")],-1)),a("div",L,[o(B,{headers:b,items:_.value,loading:r.value,"items-length":v.value,"items-per-page":u.value,page:c.value,title:"سجل خطط التقسيط",icon:"ri-calendar-schedule-line","onUpdate:page":l[0]||(l[0]=t=>{c.value=t,d()}),"onUpdate:itemsPerPage":V},{"item.invoice":s(({item:t})=>{var m;return[t.invoice?(g(),p("div",S,[a("span",$,"فاتورة #"+i(t.invoice.invoice_number),1),a("span",G,"العميل: "+i(((m=t.invoice.customer)==null?void 0:m.name)||"غير معروف"),1)])):(g(),p("span",T,"غير مرتبط بفاتورة"))]}),"item.total_amount":s(({item:t})=>[a("div",U,i(k(t.total_amount)),1)]),"item.installments_count":s(({item:t})=>[o(f,{size:"small",variant:"flat",color:"secondary-lighten-5",class:"text-secondary font-weight-bold"},{default:s(()=>[o(I,{icon:"ri-grid-line",size:"14",class:"me-1"}),h(" "+i(t.installments_count)+" قسط ",1)]),_:2},1024)]),"item.status":s(({item:t})=>[o(f,{color:w(t.status),size:"small",variant:"flat",class:"font-weight-bold px-3"},{default:s(()=>[h(i(P(t.status)),1)]),_:2},1032,["color"])]),"item.actions":s(({item:t})=>[a("div",j,[o(D,{icon:"ri-eye-line",size:"x-small",variant:"text",color:"info",tooltip:"عرض التفاصيل",onClick:m=>C(t)},null,8,["onClick"])])]),_:1},8,["items","loading","items-length","items-per-page","page"])])]))}};export{O as default};
