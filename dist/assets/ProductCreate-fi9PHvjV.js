import{a as E,z as K,o as x,c as A,d as e,w as l,b as r,B as D,i as z,e as j,f as _,an as U,D as T,n as $,aj as oe,h as S,r as v,A as fe,l as L,x as I,F as O,j as G,ao as ve,M as R,C as ge,H as k,E as B,ap as q,aq as re,ar as W,a7 as H,a3 as J,k as X,as as Y,P as Z,at as ee,au as ne,v as Q,ah as be,av as ie,aw as Ve,K as se,O as ye,Q as xe,a4 as we,a5 as he,L as _e,p as ke,U as $e}from"./index-a34Ydvtq.js";import{u as Ue}from"./useProductsData-BMA8xTto.js";import{u as N}from"./useApi-DR0m7am6.js";import{c as Ce,b as Ae}from"./brand.service-BsxnUKZB.js";const Se={class:"product-general-info"},ze={class:"d-flex align-center gap-3 mb-6"},Pe={class:"d-flex align-center justify-space-between mb-2 px-1"},Ie={__name:"ProductGeneral",props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue"],setup(w,{emit:h}){const V=w,c=h,t=K({get:()=>V.modelValue,set:m=>c("update:modelValue",m)});return(m,n)=>(x(),A("div",Se,[e(S,{variant:"flat",class:"pa-6 rounded-xl border bg-white mb-6"},{default:l(()=>[r("div",ze,[e(D,{color:"info-lighten-5",rounded:"lg"},{default:l(()=>[e(z,{icon:"ri-information-line",color:"info"})]),_:1}),n[4]||(n[4]=r("h3",{class:"text-subtitle-1 font-weight-black"},"المعلومات الأساسية",-1))]),e(j,{dense:""},{default:l(()=>[e(_,{cols:"12"},{default:l(()=>[e(U,{modelValue:t.value.name,"onUpdate:modelValue":n[0]||(n[0]=i=>t.value.name=i),label:"اسم المنتج",placeholder:"مثال: آيفون 15 برو ماكس",variant:"solo",flat:"","bg-color":"grey-lighten-5",class:"premium-input-field",rules:[i=>!!i||"اسم المنتج مطلوب"],"persistent-placeholder":""},null,8,["modelValue","rules"])]),_:1}),e(_,{cols:"12",md:"6"},{default:l(()=>[e(U,{modelValue:t.value.sku,"onUpdate:modelValue":n[1]||(n[1]=i=>t.value.sku=i),label:"SKU (كود المنتج)",placeholder:"اتركه فارغاً للتوليد التلقائي",variant:"solo",flat:"","bg-color":"grey-lighten-5",class:"premium-input-field","persistent-placeholder":""},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",md:"6"},{default:l(()=>[e(U,{modelValue:t.value.barcode,"onUpdate:modelValue":n[2]||(n[2]=i=>t.value.barcode=i),label:"الباركود (Barcode)",placeholder:"رقم الباركود العالمي",variant:"solo",flat:"","bg-color":"grey-lighten-5",class:"premium-input-field","persistent-placeholder":""},null,8,["modelValue"])]),_:1}),e(_,{cols:"12"},{default:l(()=>[r("div",Pe,[n[6]||(n[6]=r("span",{class:"text-subtitle-2 font-weight-bold"},"وصف المنتج",-1)),e(T,{size:"x-small",color:"grey",variant:"tonal"},{default:l(()=>n[5]||(n[5]=[$("يدعم التنسيق الغني")])),_:1})]),e(oe,{modelValue:t.value.desc,"onUpdate:modelValue":n[3]||(n[3]=i=>t.value.desc=i),placeholder:"اكتب وصفاً جذاباً للمنتج...",variant:"solo",flat:"","bg-color":"grey-lighten-5",class:"premium-input-field",rows:"4","auto-grow":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]))}},De=E(Ie,[["__scopeId","data-v-227731d5"]]),je={class:"product-media-manager overflow-hidden"},Be={key:0,class:"overlay-actions d-flex align-center justify-center gap-2"},Ee={key:2,class:"drag-handle"},Me={__name:"ProductMedia",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(w,{emit:h}){const V=w,c=h,t=v(!1),m=v([...V.modelValue]),n=s=>{t.value=!1;const a=Array.from(s.dataTransfer.files);p(a)},i=s=>{const a=Array.from(s.target.files);p(a)},p=s=>{const a=s.filter(b=>b.type.startsWith("image/")).map(b=>({file:b,preview:URL.createObjectURL(b),id:Math.random().toString(36).substr(2,9)}));m.value=[...m.value,...a],c("update:modelValue",m.value)},o=s=>{m.value.splice(s,1),c("update:modelValue",m.value)},d=s=>{const a=m.value.splice(s,1)[0];m.value.unshift(a),c("update:modelValue",m.value)};return(s,a)=>(x(),A("div",je,[r("div",{class:fe(["upload-zone pa-8 rounded-xl border-dashed border-2 text-center transition-all",{"border-primary bg-primary-lighten-5 scale-98":t.value}]),onDragover:a[0]||(a[0]=L(b=>t.value=!0,["prevent"])),onDragleave:a[1]||(a[1]=L(b=>t.value=!1,["prevent"])),onDrop:L(n,["prevent"]),onClick:a[2]||(a[2]=b=>s.$refs.fileInput.click())},[r("input",{ref:"fileInput",type:"file",multiple:"",accept:"image/*",class:"d-none",onChange:i},null,544),e(D,{size:"64",color:"primary-lighten-5",class:"mb-4"},{default:l(()=>[e(z,{icon:"ri-upload-cloud-2-line",color:"primary",size:"32"})]),_:1}),a[4]||(a[4]=r("h3",{class:"text-h6 font-weight-black mb-1"},"اسحب وأفلت صور المنتج هنا",-1)),a[5]||(a[5]=r("p",{class:"text-body-2 text-grey-darken-1"},"أو اضغط لاختيار ملفات من جهازك (يدعم JPG, PNG, WebP)",-1)),e(T,{size:"small",variant:"tonal",color:"primary",class:"mt-2 text-caption"},{default:l(()=>a[3]||(a[3]=[$(" يسع حتى 10 صور بدقة عالية ")])),_:1})],34),m.value.length?(x(),I(j,{key:0,class:"mt-6",dense:""},{default:l(()=>[(x(!0),A(O,null,G(m.value,(b,u)=>(x(),I(_,{key:b.id||u,cols:"6",sm:"4",md:"3",lg:"2"},{default:l(()=>[e(ve,null,{default:l(({isHovering:f,props:y})=>[e(S,R({ref_for:!0},y,{class:["media-item-card rounded-xl overflow-hidden elevation-1 relative",{"is-primary":u===0}]}),{default:l(()=>[e(ge,{src:b.preview||b.url,"aspect-ratio":"1",cover:""},{default:l(()=>[f?(x(),A("div",Be,[e(k,{icon:"ri-delete-bin-line",color:"error",size:"x-small",variant:"flat",onClick:L(g=>o(u),["stop"])},null,8,["onClick"]),u!==0?(x(),I(k,{key:0,icon:"ri-star-line",color:"primary",size:"x-small",variant:"flat",title:"تعيين كصورة أساسية",onClick:L(g=>d(u),["stop"])},null,8,["onClick"])):B("",!0)])):B("",!0),u===0?(x(),I(T,{key:1,size:"x-small",color:"primary",variant:"flat",class:"primary-label px-2"},{default:l(()=>a[6]||(a[6]=[$(" الأساسية ")])),_:1})):B("",!0),f?(x(),A("div",Ee,[e(z,{icon:"ri-drag-move-2-line",color:"white",size:"18"})])):B("",!0)]),_:2},1032,["src"])]),_:2},1040,["class"])]),_:2},1024)]),_:2},1024))),128))]),_:1})):B("",!0)]))}},Le=E(Me,[["__scopeId","data-v-74c0c5b5"]]),Te={class:"product-pricing-inventory"},Re={class:"d-flex align-center gap-3 mb-6"},Fe={class:"d-flex align-center gap-3 mb-6"},Ne={__name:"ProductPricing",props:{modelValue:{type:Object,required:!0},warehouses:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(w,{emit:h}){const V=w,c=h,t=K({get:()=>V.modelValue,set:m=>c("update:modelValue",m)});return(m,n)=>(x(),A("div",Te,[e(j,null,{default:l(()=>[e(_,{cols:"12",md:"6"},{default:l(()=>[e(S,{variant:"flat",class:"pa-6 rounded-xl border bg-white h-100"},{default:l(()=>[r("div",Re,[e(D,{color:"primary-lighten-5",rounded:"lg"},{default:l(()=>[e(z,{icon:"ri-money-dollar-circle-line",color:"primary"})]),_:1}),n[6]||(n[6]=r("h3",{class:"text-subtitle-1 font-weight-black"},"إعدادات التسعير",-1))]),e(j,{dense:""},{default:l(()=>[e(_,{cols:"12",sm:"6"},{default:l(()=>[e(U,{modelValue:t.value.retail_price,"onUpdate:modelValue":n[0]||(n[0]=i=>t.value.retail_price=i),modelModifiers:{number:!0},label:"سعر البيع (قطاعي)",prefix:"ج.م",variant:"solo",flat:"","bg-color":"grey-lighten-5",class:"premium-input-field",type:"number","persistent-placeholder":""},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",sm:"6"},{default:l(()=>[e(U,{modelValue:t.value.wholesale_price,"onUpdate:modelValue":n[1]||(n[1]=i=>t.value.wholesale_price=i),modelModifiers:{number:!0},label:"سعر البيع (جمله)",prefix:"ج.م",variant:"solo",flat:"","bg-color":"grey-lighten-5",class:"premium-input-field",type:"number","persistent-placeholder":""},null,8,["modelValue"])]),_:1}),e(_,{cols:"12"},{default:l(()=>[e(U,{modelValue:t.value.tax,"onUpdate:modelValue":n[2]||(n[2]=i=>t.value.tax=i),modelModifiers:{number:!0},label:"الضريبة المفروضة",suffix:"%",variant:"solo",flat:"","bg-color":"grey-lighten-5",class:"premium-input-field",type:"number","persistent-placeholder":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(_,{cols:"12",md:"6"},{default:l(()=>[e(S,{variant:"flat",class:"pa-6 rounded-xl border bg-white h-100"},{default:l(()=>[r("div",Fe,[e(D,{color:"warning-lighten-5",rounded:"lg"},{default:l(()=>[e(z,{icon:"ri-home-gear-line",color:"warning"})]),_:1}),n[7]||(n[7]=r("h3",{class:"text-subtitle-1 font-weight-black"},"المخزون واللوجستيات",-1))]),e(j,{dense:""},{default:l(()=>[e(_,{cols:"12"},{default:l(()=>[e(q,{modelValue:t.value.warehouse_id,"onUpdate:modelValue":n[3]||(n[3]=i=>t.value.warehouse_id=i),items:w.warehouses,"item-title":"name","item-value":"id",label:"المخزن الافتراضي",variant:"solo",flat:"","bg-color":"grey-lighten-5",class:"premium-input-field"},null,8,["modelValue","items"])]),_:1}),e(_,{cols:"6"},{default:l(()=>[e(U,{modelValue:t.value.min_quantity,"onUpdate:modelValue":n[4]||(n[4]=i=>t.value.min_quantity=i),modelModifiers:{number:!0},label:"الحد الأدنى",variant:"solo",flat:"","bg-color":"grey-lighten-5",class:"premium-input-field",type:"number",hint:"تنبيه عند نقص الكمية","container-class":"pb-0"},null,8,["modelValue"])]),_:1}),e(_,{cols:"6"},{default:l(()=>[e(U,{modelValue:t.value.weight,"onUpdate:modelValue":n[5]||(n[5]=i=>t.value.weight=i),modelModifiers:{number:!0},label:"الوزن (كجم)",variant:"solo",flat:"","bg-color":"grey-lighten-5",class:"premium-input-field",type:"number"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]))}},qe=E(Ne,[["__scopeId","data-v-154dfc1c"]]);class Oe extends re{constructor(){super("attributes")}async toggle(h){return this.apiClient.patch(`${this.resource}/${h}/toggle`)}}const Ge=new Oe,Qe={__name:"QuickAddAttribute",emits:["saved"],setup(w,{emit:h}){const V=h,c=v(!1),t=v(!1),m=v(!1),n=v(null),i=v(""),p=v(""),o=async()=>{const{valid:d}=await n.value.validate();if(d){t.value=!0;try{const s={name:i.value,name_en:p.value,active:1},a=await Ge.create(s,{showToast:!0});a.status&&(V("saved",a.data[0]),c.value=!1,i.value="",p.value="")}finally{t.value=!1}}};return(d,s)=>(x(),I(ee,{modelValue:c.value,"onUpdate:modelValue":s[4]||(s[4]=a=>c.value=a),"max-width":"500px"},{activator:l(({props:a})=>[W(d.$slots,"activator",{props:a},()=>[e(k,R({icon:"ri-add-line",size:"small",variant:"text",color:"primary"},a),null,16)])]),default:l(()=>[e(S,{rounded:"xl",class:"pa-4"},{default:l(()=>[e(H,{class:"d-flex align-center gap-2"},{default:l(()=>[e(D,{color:"primary-lighten-5",rounded:"lg",size:"40"},{default:l(()=>[e(z,{icon:"ri-settings-5-line",color:"primary"})]),_:1}),s[5]||(s[5]=r("span",{class:"font-weight-black"},"إضافة سمة جديدة",-1))]),_:1}),e(J,{class:"mt-4"},{default:l(()=>[e(X,{ref_key:"form",ref:n,modelValue:m.value,"onUpdate:modelValue":s[2]||(s[2]=a=>m.value=a)},{default:l(()=>[e(U,{modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=a=>i.value=a),label:"اسم السمة (AR)",placeholder:"مثال: اللون، المقاس، الخامة",variant:"solo-filled",flat:"",rounded:"lg",rules:[a=>!!a||"اسم السمة مطلوب"],autofocus:""},null,8,["modelValue","rules"]),e(U,{modelValue:p.value,"onUpdate:modelValue":s[1]||(s[1]=a=>p.value=a),label:"اسم السمة (EN)",placeholder:"e.g. Color, Size, Material",variant:"solo-filled",flat:"",rounded:"lg",class:"mt-2 text-left",dir:"ltr"},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),e(Y,{class:"pa-4"},{default:l(()=>[e(Z),e(k,{variant:"text",color:"grey",onClick:s[3]||(s[3]=a=>c.value=!1),disabled:t.value},{default:l(()=>s[6]||(s[6]=[$("إلغاء")])),_:1},8,["disabled"]),e(k,{color:"primary",variant:"flat",rounded:"lg",class:"px-6 font-weight-bold",loading:t.value,onClick:o},{default:l(()=>s[7]||(s[7]=[$(" حفظ السمة ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:3},8,["modelValue"]))}};class Ke extends re{constructor(){super("attribute-values")}}const We=new Ke,He={class:"product-variants-builder"},Je={class:"variants-setup-glass pa-6 rounded-xl border mb-6"},Xe={class:"d-flex align-center justify-space-between mb-6"},Ye={key:0,class:"text-center mt-6"},Ze={key:0,class:"variants-matrix mt-8"},el={class:"d-flex align-center justify-space-between mb-4 px-2"},ll={class:"text-subtitle-1 font-weight-black"},al={class:"d-flex gap-2"},tl={class:"glass-table-wrapper rounded-xl border overflow-hidden"},sl={class:"font-weight-bold"},ol={class:"d-flex align-center gap-2"},rl={class:"text-center"},nl={class:"text-center"},il={__name:"ProductVariants",props:{modelValue:{type:Array,default:()=>[]},availableAttributes:{type:Array,default:()=>[]}},emits:["update:modelValue","refresh-attributes"],setup(w,{emit:h}){const V=w,c=h,t=v([]),m=v([...V.modelValue]),n=v(!1),i=b=>{t.value.splice(b,1)},p=b=>{const u=t.value[b],f=V.availableAttributes.find(y=>y.id===u.id);f&&(u.availableValues=f.values||[])},o=async b=>{const u=t.value[b];if(!u.id)return;const f=u.selectedValues[u.selectedValues.length-1];if(typeof f=="string")try{const y=await We.create({attribute_id:u.id,name:f,active:1});y.status&&(u.selectedValues[u.selectedValues.length-1]=y.data[0],u.availableValues.push(y.data[0]))}catch(y){console.error("Failed to create attribute value:",y),u.selectedValues.pop()}},d=()=>{n.value=!0;const b=t.value.reduce((u,f)=>{if(f.selectedValues.length===0)return u;const y=[];return f.selectedValues.forEach(g=>{u.length===0?y.push({label:g.name||g,values:[g]}):u.forEach(M=>{y.push({label:`${M.label} / ${g.name||g}`,values:[...M.values,g]})})}),y},[]);m.value=b.map(u=>({label:u.label,values:u.values,sku:"",price_modifier:0,stock:0,enabled:!0})),n.value=!1,c("update:modelValue",m.value)},s=b=>{m.value.splice(b,1),c("update:modelValue",m.value)},a=b=>{c("refresh-attributes"),t.value.push({id:b.id,selectedValues:[],availableValues:b.values||[]})};return(b,u)=>(x(),A("div",He,[r("div",Je,[r("div",Xe,[u[1]||(u[1]=r("div",null,[r("h3",{class:"text-h6 font-weight-black mb-1"},"بناء المتغيرات"),r("p",{class:"text-body-2 text-grey-darken-1"},"أضف سمات مثل (اللون، المقاس، الخامة) لتوليد تشكيلات المنتج")],-1)),e(Qe,{onSaved:a},{activator:l(({props:f})=>[e(k,R({color:"primary","prepend-icon":"ri-add-line",variant:"tonal",rounded:"xl"},f),{default:l(()=>u[0]||(u[0]=[$(" إضافة سمة ")])),_:2},1040)]),_:1})]),(x(!0),A(O,null,G(t.value,(f,y)=>(x(),A("div",{key:y,class:"attr-row-glass pa-4 rounded-lg mb-4 bg-white border"},[e(j,{dense:"",align:"center"},{default:l(()=>[e(_,{cols:"12",md:"3"},{default:l(()=>[e(q,{modelValue:f.id,"onUpdate:modelValue":[g=>f.id=g,g=>p(y)],items:w.availableAttributes,"item-title":"name","item-value":"id",label:"السمة",placeholder:"اختر السمة...",variant:"solo",flat:"",density:"comfortable","hide-details":"","bg-color":"grey-lighten-4"},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),e(_,{cols:"12",md:"7"},{default:l(()=>[e(ne,{modelValue:f.selectedValues,"onUpdate:modelValue":[g=>f.selectedValues=g,g=>o(y)],items:f.availableValues,"item-title":"name",label:"القيم المختارة",multiple:"",chips:"","closable-chips":"",variant:"solo",flat:"",density:"comfortable","hide-details":"","bg-color":"grey-lighten-4",placeholder:"مثال: أحمر، أخضر، XL..."},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),e(_,{cols:"12",md:"2",class:"text-end"},{default:l(()=>[e(k,{icon:"ri-delete-bin-7-line",color:"error",variant:"text",onClick:g=>i(y)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]))),128)),t.value.length>0?(x(),A("div",Ye,[e(k,{color:"primary",size:"large",class:"px-8 font-weight-black",rounded:"xl","prepend-icon":"ri-magic-line",loading:n.value,onClick:d},{default:l(()=>u[2]||(u[2]=[$(" توليد تشكيلات المتغيرات ")])),_:1},8,["loading"])])):B("",!0)]),e(Ve,null,{default:l(()=>[m.value.length>0?(x(),A("div",Ze,[r("div",el,[r("h4",ll,"تشكيلات المتغيرات المختارة ("+Q(m.value.length)+")",1),r("div",al,[e(k,{size:"small",variant:"text",color:"primary","prepend-icon":"ri-edit-line"},{default:l(()=>u[3]||(u[3]=[$("تعديل جماعي")])),_:1})])]),r("div",tl,[e(be,{density:"comfortable",class:"premium-table"},{default:l(()=>[u[4]||(u[4]=r("thead",null,[r("tr",{class:"bg-grey-lighten-5"},[r("th",{class:"text-right"},"المتغير"),r("th",{class:"text-right"},"SKU"),r("th",{class:"text-right"},"السعر الإضافي"),r("th",{class:"text-right"},"الكمية"),r("th",{class:"text-center"},"الحالة"),r("th",{class:"text-center"},"حذف")])],-1)),r("tbody",null,[(x(!0),A(O,null,G(m.value,(f,y)=>(x(),A("tr",{key:y,class:"variant-row"},[r("td",sl,[r("div",ol,[e(D,{size:"32",color:"grey-lighten-4",class:"rounded-lg"},{default:l(()=>[e(z,{icon:"ri-box-3-line",size:"16"})]),_:1}),r("span",null,Q(f.label),1)])]),r("td",null,[e(U,{modelValue:f.sku,"onUpdate:modelValue":g=>f.sku=g,variant:"plain",density:"compact","hide-details":"",class:"sku-input"},null,8,["modelValue","onUpdate:modelValue"])]),r("td",null,[e(U,{modelValue:f.price_modifier,"onUpdate:modelValue":g=>f.price_modifier=g,modelModifiers:{number:!0},prefix:"+",variant:"plain",density:"compact","hide-details":"",type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),r("td",null,[e(U,{modelValue:f.stock,"onUpdate:modelValue":g=>f.stock=g,modelModifiers:{number:!0},variant:"plain",density:"compact","hide-details":"",type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),r("td",rl,[e(ie,{modelValue:f.enabled,"onUpdate:modelValue":g=>f.enabled=g,color:"primary","hide-details":"",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])]),r("td",nl,[e(k,{icon:"ri-close-circle-line",size:"x-small",color:"grey",variant:"text",onClick:g=>s(y)},null,8,["onClick"])])]))),128))])]),_:1})])])):B("",!0)]),_:1})]))}},dl=E(il,[["__scopeId","data-v-69862169"]]),ul={__name:"QuickAddCategory",emits:["saved"],setup(w,{emit:h}){const V=h,c=v(!1),t=v(!1),m=v(!1),n=v(null),i=v(""),p=v(""),o=async()=>{const{valid:d}=await n.value.validate();if(d){t.value=!0;try{const s={name:i.value,name_en:p.value,active:1},a=await Ce.create(s,{showToast:!0});a.status&&(V("saved",a.data[0]),c.value=!1,i.value="",p.value="")}finally{t.value=!1}}};return(d,s)=>(x(),I(ee,{modelValue:c.value,"onUpdate:modelValue":s[4]||(s[4]=a=>c.value=a),"max-width":"500px"},{activator:l(({props:a})=>[W(d.$slots,"activator",{props:a},()=>[e(k,R({icon:"ri-add-line",size:"small",variant:"text",color:"primary"},a),null,16)])]),default:l(()=>[e(S,{rounded:"xl",class:"pa-4"},{default:l(()=>[e(H,{class:"d-flex align-center gap-2"},{default:l(()=>[e(D,{color:"primary-lighten-5",rounded:"lg",size:"40"},{default:l(()=>[e(z,{icon:"ri-folder-add-line",color:"primary"})]),_:1}),s[5]||(s[5]=r("span",{class:"font-weight-black"},"إضافة قسم جديد",-1))]),_:1}),e(J,{class:"mt-4"},{default:l(()=>[e(X,{ref_key:"form",ref:n,modelValue:m.value,"onUpdate:modelValue":s[2]||(s[2]=a=>m.value=a)},{default:l(()=>[e(U,{modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=a=>i.value=a),label:"اسم القسم (AR)",placeholder:"مثال: الهواتف الذكية",variant:"solo-filled",flat:"",rounded:"lg",rules:[a=>!!a||"اسم القسم مطلوب"],autofocus:""},null,8,["modelValue","rules"]),e(U,{modelValue:p.value,"onUpdate:modelValue":s[1]||(s[1]=a=>p.value=a),label:"اسم القسم (EN)",placeholder:"Smartphones",variant:"solo-filled",flat:"",rounded:"lg",class:"mt-2 text-left",dir:"ltr"},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),e(Y,{class:"pa-4"},{default:l(()=>[e(Z),e(k,{variant:"text",color:"grey",onClick:s[3]||(s[3]=a=>c.value=!1),disabled:t.value},{default:l(()=>s[6]||(s[6]=[$("إلغاء")])),_:1},8,["disabled"]),e(k,{color:"primary",variant:"flat",rounded:"lg",class:"px-6 font-weight-bold",loading:t.value,onClick:o},{default:l(()=>s[7]||(s[7]=[$(" حفظ القسم ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:3},8,["modelValue"]))}},ml={__name:"QuickAddBrand",emits:["saved"],setup(w,{emit:h}){const V=h,c=v(!1),t=v(!1),m=v(!1),n=v(null),i=v(""),p=v(""),o=async()=>{const{valid:d}=await n.value.validate();if(d){t.value=!0;try{const s={name:i.value,name_en:p.value,active:1},a=await Ae.create(s,{showToast:!0});a.status&&(V("saved",a.data[0]),c.value=!1,i.value="",p.value="")}finally{t.value=!1}}};return(d,s)=>(x(),I(ee,{modelValue:c.value,"onUpdate:modelValue":s[4]||(s[4]=a=>c.value=a),"max-width":"500px"},{activator:l(({props:a})=>[W(d.$slots,"activator",{props:a},()=>[e(k,R({icon:"ri-add-line",size:"small",variant:"text",color:"primary"},a),null,16)])]),default:l(()=>[e(S,{rounded:"xl",class:"pa-4"},{default:l(()=>[e(H,{class:"d-flex align-center gap-2"},{default:l(()=>[e(D,{color:"primary-lighten-5",rounded:"lg",size:"40"},{default:l(()=>[e(z,{icon:"ri-verified-badge-line",color:"primary"})]),_:1}),s[5]||(s[5]=r("span",{class:"font-weight-black"},"إضافة علامة تجارية جديدة",-1))]),_:1}),e(J,{class:"mt-4"},{default:l(()=>[e(X,{ref_key:"form",ref:n,modelValue:m.value,"onUpdate:modelValue":s[2]||(s[2]=a=>m.value=a)},{default:l(()=>[e(U,{modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=a=>i.value=a),label:"اسم العلامة التجارية (AR)",placeholder:"مثال: سامسونج",variant:"solo-filled",flat:"",rounded:"lg",rules:[a=>!!a||"الاسم مطلوب"],autofocus:""},null,8,["modelValue","rules"]),e(U,{modelValue:p.value,"onUpdate:modelValue":s[1]||(s[1]=a=>p.value=a),label:"اسم العلامة التجارية (EN)",placeholder:"Samsung",variant:"solo-filled",flat:"",rounded:"lg",class:"mt-2 text-left",dir:"ltr"},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),e(Y,{class:"pa-4"},{default:l(()=>[e(Z),e(k,{variant:"text",color:"grey",onClick:s[3]||(s[3]=a=>c.value=!1),disabled:t.value},{default:l(()=>s[6]||(s[6]=[$("إلغاء")])),_:1},8,["disabled"]),e(k,{color:"primary",variant:"flat",rounded:"lg",class:"px-6 font-weight-bold",loading:t.value,onClick:o},{default:l(()=>s[7]||(s[7]=[$(" حفظ البراند ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:3},8,["modelValue"]))}},cl={class:"product-form-overhaul"},pl={class:"sticky-header pa-4 glass-blur border-b"},fl={class:"container-premium d-flex align-center justify-space-between mx-auto"},vl={class:"d-flex align-center gap-4"},gl={class:"text-caption text-grey d-flex align-center gap-1"},bl={class:"text-h6 font-weight-black mb-0"},Vl={class:"d-flex align-center gap-3"},yl={class:"main-content-wrapper pa-6 bg-grey-lighten-5 min-h-screen"},xl={class:"container-premium mx-auto"},wl={class:"d-flex flex-column gap-6"},hl={class:"d-flex align-center gap-3 mb-6"},_l={class:"sticky-sidebar d-flex flex-column gap-6"},kl={class:"d-flex align-center justify-space-between mb-1"},$l={class:"d-flex align-center justify-space-between mb-1"},Ul={__name:"ProductForm",props:{modelValue:{type:Object,required:!0},categories:{type:Array,default:()=>[]},brands:{type:Array,default:()=>[]},warehouses:{type:Array,default:()=>[]},availableAttributes:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},errors:{type:Object,default:()=>({})},isEdit:{type:Boolean,default:!1}},emits:["update:modelValue","submit","cancel","refresh-categories","refresh-brands"],setup(w,{emit:h}){const V=w,c=h,t=v({...V.modelValue,images:V.modelValue.images||[],variants:V.modelValue.variants||[],tags:V.modelValue.tags||[],active:V.modelValue.active??!0});se(()=>V.modelValue,p=>{t.value={...p}},{deep:!0}),se(t,p=>{c("update:modelValue",p)},{deep:!0});const m=()=>{c("submit",t.value)},n=p=>{c("refresh-categories"),t.value.category_id=p.id},i=p=>{c("refresh-brands"),t.value.brand_id=p.id};return(p,o)=>(x(),A("div",cl,[r("div",pl,[r("div",fl,[r("div",vl,[e(k,{icon:"ri-arrow-right-line",variant:"text",onClick:o[0]||(o[0]=d=>p.$emit("cancel"))}),r("div",null,[r("div",gl,[o[11]||(o[11]=r("span",null,"المنتجات",-1)),e(z,{icon:"ri-arrow-left-s-line",size:"14"}),o[12]||(o[12]=r("span",null,"إضافة منتج جديد",-1))]),r("h1",bl,Q(t.value.name||"منتج بدون اسم تحليلي"),1)])]),r("div",Vl,[t.value.active?(x(),I(T,{key:0,color:"success",size:"small",variant:"flat",class:"font-weight-bold"},{default:l(()=>o[13]||(o[13]=[$("نشط")])),_:1})):(x(),I(T,{key:1,color:"grey",size:"small",variant:"flat",class:"font-weight-bold"},{default:l(()=>o[14]||(o[14]=[$("مسودة")])),_:1})),e(ye,{vertical:"",class:"mx-2"}),e(k,{variant:"text",color:"grey-darken-1",class:"font-weight-bold",onClick:o[1]||(o[1]=d=>p.$emit("cancel"))},{default:l(()=>o[15]||(o[15]=[$("تجاهل")])),_:1}),e(k,{color:"primary",size:"large",rounded:"xl",class:"px-8 font-weight-black elevation-4",loading:w.loading,"prepend-icon":"ri-shield-check-line",onClick:m},{default:l(()=>o[16]||(o[16]=[$(" حفظ المنتج النهائي ")])),_:1},8,["loading"])])])]),r("div",yl,[r("div",xl,[e(j,null,{default:l(()=>[e(_,{cols:"12",lg:"8"},{default:l(()=>[r("div",wl,[e(De,{modelValue:t.value,"onUpdate:modelValue":o[2]||(o[2]=d=>t.value=d)},null,8,["modelValue"]),e(S,{variant:"flat",class:"pa-6 rounded-xl border bg-white"},{default:l(()=>[r("div",hl,[e(D,{color:"secondary-lighten-5",rounded:"lg"},{default:l(()=>[e(z,{icon:"ri-image-2-line",color:"secondary"})]),_:1}),o[17]||(o[17]=r("h3",{class:"text-subtitle-1 font-weight-black"},"معرض الصور",-1))]),e(Le,{modelValue:t.value.images,"onUpdate:modelValue":o[3]||(o[3]=d=>t.value.images=d)},null,8,["modelValue"])]),_:1}),e(qe,{modelValue:t.value,"onUpdate:modelValue":o[4]||(o[4]=d=>t.value=d),warehouses:w.warehouses},null,8,["modelValue","warehouses"]),e(S,{variant:"flat",class:"pa-6 rounded-xl border bg-white mb-6"},{default:l(()=>[e(dl,{modelValue:t.value.variants,"onUpdate:modelValue":o[5]||(o[5]=d=>t.value.variants=d),"available-attributes":w.availableAttributes},null,8,["modelValue","available-attributes"])]),_:1})])]),_:1}),e(_,{cols:"12",lg:"4"},{default:l(()=>[r("div",_l,[e(S,{variant:"flat",class:"pa-6 rounded-xl border bg-white"},{default:l(()=>[o[20]||(o[20]=r("h3",{class:"text-subtitle-1 font-weight-black mb-6"},"التصنيف والبراند",-1)),e(j,{dense:""},{default:l(()=>[e(_,{cols:"12"},{default:l(()=>[r("div",kl,[o[18]||(o[18]=r("label",{class:"text-caption font-weight-bold text-grey-darken-1"},"الفئة الأساسية",-1)),e(ul,{onSaved:n})]),e(q,{modelValue:t.value.category_id,"onUpdate:modelValue":o[6]||(o[6]=d=>t.value.category_id=d),items:w.categories,"item-title":"name","item-value":"id",placeholder:"اختر الفئة...",variant:"solo",flat:"","bg-color":"grey-lighten-4",class:"premium-input-field"},null,8,["modelValue","items"])]),_:1}),e(_,{cols:"12"},{default:l(()=>[r("div",$l,[o[19]||(o[19]=r("label",{class:"text-caption font-weight-bold text-grey-darken-1"},"العلامة التجارية",-1)),e(ml,{onSaved:i})]),e(q,{modelValue:t.value.brand_id,"onUpdate:modelValue":o[7]||(o[7]=d=>t.value.brand_id=d),items:w.brands,"item-title":"name","item-value":"id",placeholder:"اختر البراند...",variant:"solo",flat:"","bg-color":"grey-lighten-4",class:"premium-input-field"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),e(S,{variant:"flat",class:"pa-6 rounded-xl border bg-white"},{default:l(()=>[o[23]||(o[23]=r("h3",{class:"text-subtitle-1 font-weight-black mb-4"},"الحالة والظهور",-1)),e(xe,{class:"pa-0"},{prepend:l(()=>[e(z,{icon:"ri-eye-line",color:"grey"})]),append:l(()=>[e(ie,{modelValue:t.value.active,"onUpdate:modelValue":o[8]||(o[8]=d=>t.value.active=d),color:"success","hide-details":"",density:"compact"},null,8,["modelValue"])]),default:l(()=>[e(we,{class:"text-body-2"},{default:l(()=>o[21]||(o[21]=[$("ظهور المنتج")])),_:1}),e(he,{class:"text-caption"},{default:l(()=>o[22]||(o[22]=[$("تحديد ما إذا كان المنتج متاحاً للعملاء")])),_:1})]),_:1})]),_:1}),e(S,{variant:"flat",class:"pa-6 rounded-xl border bg-white"},{default:l(()=>[o[24]||(o[24]=r("h3",{class:"text-subtitle-1 font-weight-black mb-1"},"الكلمات الدلالية",-1)),o[25]||(o[25]=r("p",{class:"text-caption text-grey mb-4"},"تساعد على تسريع البحث داخل النظام",-1)),e(ne,{modelValue:t.value.tags,"onUpdate:modelValue":o[9]||(o[9]=d=>t.value.tags=d),multiple:"",chips:"","closable-chips":"",variant:"solo",flat:"","bg-color":"grey-lighten-4",placeholder:"أضف تاجات...",class:"premium-input-field"},null,8,["modelValue"])]),_:1}),e(S,{variant:"flat",class:"pa-6 rounded-xl border bg-white"},{default:l(()=>[o[26]||(o[26]=r("h3",{class:"text-subtitle-1 font-weight-black mb-1"},"ملاحظات داخلية",-1)),o[27]||(o[27]=r("p",{class:"text-caption text-grey mb-4"},"ملاحظات لا يراها العميل",-1)),e(oe,{modelValue:t.value.internal_note,"onUpdate:modelValue":o[10]||(o[10]=d=>t.value.internal_note=d),variant:"solo",flat:"","bg-color":"grey-lighten-4",class:"premium-input-field",rows:"3"},null,8,["modelValue"])]),_:1})])]),_:1})]),_:1})])])]))}},Cl=E(Ul,[["__scopeId","data-v-18d2a194"]]),Al={class:"product-create-container"},Sl={__name:"ProductCreate",setup(w){const h=ke(),V=$e(),{getProduct:c,createProduct:t,updateProduct:m}=Ue(),n=N("/api/categories"),i=N("/api/brands"),p=N("/api/warehouses"),o=N("/api/attributes"),d=v(!1),s=v({}),a=v([]),b=v([]),u=v([]),f=v([]),y=v({name:"",sku:"",barcode:"",category_id:null,brand_id:null,desc:"",desc_long:"",retail_price:0,wholesale_price:0,tax:0,warehouse_id:null,min_quantity:1,weight:0,active:!0,featured:!1,returnable:!0,images:[],variants:[],tags:[],internal_note:""}),g=K(()=>!!V.params.id),M=async()=>{const C=await n.get({per_page:100},{showLoading:!1});a.value=C.data||[]},le=async()=>{const C=await i.get({per_page:100},{showLoading:!1});b.value=C.data||[]},de=async()=>{const C=await p.get({per_page:100},{showLoading:!1});u.value=C.data||[]},ae=async()=>{const C=await o.get({per_page:100},{showLoading:!1});f.value=C.data||[]},ue=async()=>{try{await Promise.all([M(),le(),de(),ae()])}catch(C){console.error("Failed to load initial data:",C)}},me=async()=>{if(g.value)try{const P=(await c(V.params.id)).data;y.value={...P,images:P.images||[],variants:P.variants||[],tags:P.tags||[]}}catch(C){console.error("Error loading product:",C),h.push("/products")}},ce=async C=>{var P,F;d.value=!0,s.value={};try{g.value?await m(V.params.id,C):await t(C),h.push("/products")}catch(te){(F=(P=te.response)==null?void 0:P.data)!=null&&F.errors&&(s.value=te.response.data.errors)}finally{d.value=!1}},pe=()=>{h.push("/products")};return _e(async()=>{await ue(),g.value&&await me()}),(C,P)=>(x(),A("div",Al,[e(Cl,{modelValue:y.value,"onUpdate:modelValue":P[0]||(P[0]=F=>y.value=F),categories:a.value,brands:b.value,warehouses:u.value,"available-attributes":f.value,loading:d.value,errors:s.value,"is-edit":g.value,onSubmit:ce,onCancel:pe,onRefreshCategories:M,onRefreshBrands:le,onRefreshAttributes:ae},null,8,["modelValue","categories","brands","warehouses","available-attributes","loading","errors","is-edit"])]))}},jl=E(Sl,[["__scopeId","data-v-6d7df950"]]);export{jl as default};
