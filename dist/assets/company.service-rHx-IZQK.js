import{ap as u,aG as c,y as i}from"./index-Flp88uEA.js";class d extends u{constructor(){super("invoices")}async getOneWithDetails(t,e={}){return this.getOne(t,{...e,full:!0})}async getPDF(t,e={}){const{showToast:r=!1}=e;try{const n=await c.get(`invoice/${t}/pdf`,{responseType:"blob"}),o=window.URL.createObjectURL(new Blob([n.data])),s=document.createElement("a");return s.href=o,s.setAttribute("download",`invoice-${t}.pdf`),document.body.appendChild(s),s.click(),s.remove(),r&&toast.success("تم تحميل الفاتورة بنجاح"),n.data}catch(n){return this.handleError(n,r)}}async sendEmail(t,e,r={}){const{showToast:n=!0,loading:o=!0}=r,s=useUserStore();o&&(s.loadingApi=!0);try{const a=await c.post(`invoice/${t}/send-email`,e);return this.handleSuccess(a,n)}catch(a){return this.handleError(a,n)}}async getItems(t,e={}){const{showToast:r=!1,loading:n=!0}=e,o=useUserStore();n&&(o.loadingApi=!0);try{const s=await c.get(`invoice/${t}/items`);return this.handleSuccess(s,r)}catch(s){return this.handleError(s,r)}}async addItem(t,e,r={}){const{showToast:n=!0,loading:o=!0}=r,s=useUserStore();o&&(s.loadingApi=!0);try{const a=await c.post(`invoice/${t}/items`,e);return this.handleSuccess(a,n)}catch(a){return this.handleError(a,n)}}async updateItem(t,e,r,n={}){const{showToast:o=!0,loading:s=!0}=n,a=useUserStore();s&&(a.loadingApi=!0);try{const h=await c.put(`invoice/${t}/items/${e}`,r);return this.handleSuccess(h,o)}catch(h){return this.handleError(h,o)}}async deleteItem(t,e,r={}){const{showToast:n=!0,loading:o=!0}=r,s=useUserStore();o&&(s.loadingApi=!0);try{const a=await c.delete(`invoice/${t}/items/${e}`);return this.handleSuccess(a,n)}catch(a){return this.handleError(a,n)}}async getByType(t,e={},r={}){return this.getAll({...e,type:t},r)}async getSales(t={},e={}){return this.getByType("sale",t,e)}async getPurchases(t={},e={}){return this.getByType("purchase",t,e)}async getInstallments(t={},e={}){return this.getByType("installment_sale",t,e)}}new d;class p extends u{constructor(){super("products")}async getVariants(t,e={},r={}){const{showToast:n=!1,loading:o=!0}=r,s=i();o&&(s.loadingApi=!0);try{const a=await c.get(`product/${t}/variants`,{params:e});return this.handleSuccess(a,n)}catch(a){return this.handleError(a,n)}}async addVariant(t,e,r={}){const{showToast:n=!0,loading:o=!0}=r,s=i();o&&(s.loadingApi=!0);try{const a=await c.post(`product/${t}/variants`,e);return this.handleSuccess(a,n)}catch(a){return this.handleError(a,n)}}async updateVariant(t,e,r,n={}){const{showToast:o=!0,loading:s=!0}=n,a=i();s&&(a.loadingApi=!0);try{const h=await c.put(`product/${t}/variants/${e}`,r);return this.handleSuccess(h,o)}catch(h){return this.handleError(h,o)}}async deleteVariant(t,e,r={}){const{showToast:n=!0,loading:o=!0}=r,s=i();o&&(s.loadingApi=!0);try{const a=await c.delete(`product/${t}/variants/${e}`);return this.handleSuccess(a,n)}catch(a){return this.handleError(a,n)}}async getStock(t,e={}){const{showToast:r=!1,loading:n=!0}=e,o=i();n&&(o.loadingApi=!0);try{const s=await c.get(`product/${t}/stock`);return this.handleSuccess(s,r)}catch(s){return this.handleError(s,r)}}async searchByBarcode(t,e={}){const{showToast:r=!1,loading:n=!1}=e,o=i();n&&(o.loadingApi=!0);try{const s=await c.get("products",{params:{barcode:t}});return this.handleSuccess(s,r)}catch(s){return this.handleError(s,r)}}}new p;class y extends u{constructor(){super("payments")}async getByInvoice(t,e={}){return this.getAll({invoice_id:t},e)}async getByCustomer(t,e={}){return this.getAll({customer_id:t},e)}async getSummary(t={},e={}){const{showToast:r=!1,loading:n=!0}=e,o=useUserStore();n&&(o.loadingApi=!0);try{const s=await apiClient.get("payments/summary",{params:t});return this.handleSuccess(s,r)}catch(s){return this.handleError(s,r)}}}new y;class g extends u{constructor(){super("installment-plans")}async getPlans(t={},e={}){return this.getAll(t,e)}async createPlan(t,e={}){const{showToast:r=!0,loading:n=!0}=e,o=i();n&&(o.loadingApi=!0);try{const s={...t,remaining_amount:t.total_amount-(t.down_payment||0),number_of_installments:t.installment_count,status:t.status||"active",end_date:t.end_date||this.calculateEndDate(t.start_date,t.installment_count)},a=await c.post("installment-plan",s);return this.handleSuccess(a,r)}catch(s){return this.handleError(s,r)}}async updatePlan(t,e,r={}){return this.save(e,t,r)}async getPayments(t={},e={}){const{showToast:r=!1,loading:n=!0}=e,o=i();n&&(o.loadingApi=!0);try{const s=await c.get("installment-payments",{params:t});return this.handleSuccess(s,r)}catch(s){return this.handleError(s,r)}}async createPayment(t,e={}){const{showToast:r=!0,loading:n=!0}=e,o=i();n&&(o.loadingApi=!0);try{const s=await c.post("installment-payment",t);return this.handleSuccess(s,r)}catch(s){return this.handleError(s,r)}}async getPaymentDetails(t={},e={}){const{showToast:r=!1,loading:n=!0}=e,o=i();n&&(o.loadingApi=!0);try{const s=await c.get("installment-payment-details",{params:t});return this.handleSuccess(s,r)}catch(s){return this.handleError(s,r)}}calculateEndDate(t,e){const r=new Date(t);return r.setMonth(r.getMonth()+e),r.toISOString().split("T")[0]}}const _=new g;class w extends u{constructor(){super("installment-payment-details")}async getByPayment(t,e={}){return this.getAll({installment_payment_id:t},e)}async getByInstallment(t,e={}){return this.getAll({installment_id:t},e)}async createDetail(t,e={}){return this.save(t,null,e)}async updateDetail(t,e,r={}){throw console.warn("InstallmentDetailService.updateDetail: Backend endpoint has known issue (500 error)"),console.warn("Workaround: Consider deleting old record and creating new one"),new Error("Update endpoint disabled - use delete + create workaround")}async replaceDetail(t,e,r={}){const{showToast:n=!0,loading:o=!0}=r;try{return await this.delete(t,{showToast:!1,loading:o}),await this.createDetail(e,{showToast:n,loading:o})}catch(s){throw console.error("Error replacing installment detail:",s),s}}async getSummary(t,e={}){const{showToast:r=!1,loading:n=!0}=e,o=i();n&&(o.loadingApi=!0);try{const s=await c.get("installment-payment-details/summary",{params:{installment_plan_id:t}});return this.handleSuccess(s,r)}catch(s){return this.handleError(s,r)}}validateDetail(t){const e=[];return t.installment_payment_id||e.push("installment_payment_id is required"),t.installment_id||e.push("installment_id is required"),(!t.amount_paid||t.amount_paid<=0)&&e.push("amount_paid must be greater than 0"),{valid:e.length===0,errors:e}}}const k=new w;class S extends u{constructor(){super("warehouses")}async getStock(t,e={},r={}){const{showToast:n=!1,loading:o=!0}=r,s=i();o&&(s.loadingApi=!0);try{const a=await c.get(`warehouse/${t}/stock`,{params:e});return this.handleSuccess(a,n)}catch(a){return this.handleError(a,n)}}}const $=new S;class m extends u{constructor(){super("stock")}async getMovements(t={},e={}){return this.getAll(t,e)}async addStock(t,e={}){const{showToast:r=!0,loading:n=!0}=e,o=i();n&&(o.loadingApi=!0);try{const s=await c.post("stock/add",t);return this.handleSuccess(s,r)}catch(s){return this.handleError(s,r)}}async subtractStock(t,e={}){const{showToast:r=!0,loading:n=!0}=e,o=i();n&&(o.loadingApi=!0);try{const s=await c.post("stock/subtract",t);return this.handleSuccess(s,r)}catch(s){return this.handleError(s,r)}}async transferStock(t,e={}){const{showToast:r=!0,loading:n=!0}=e,o=i();n&&(o.loadingApi=!0);try{const s=await c.post("stock/transfer",t);return this.handleSuccess(s,r)}catch(s){return this.handleError(s,r)}}async adjustStock(t,e={}){const{showToast:r=!0,loading:n=!0}=e,o=i();n&&(o.loadingApi=!0);try{const s=await c.post("stock/adjust",t);return this.handleSuccess(s,r)}catch(s){return this.handleError(s,r)}}async getByProduct(t,e={}){return this.getAll({product_id:t},e)}async getByWarehouse(t,e={}){return this.getAll({warehouse_id:t},e)}async getLowStock(t={}){const{showToast:e=!1,loading:r=!0}=t,n=i();r&&(n.loadingApi=!0);try{const o=await c.get("stock/low-stock");return this.handleSuccess(o,e)}catch(o){return this.handleError(o,e)}}}new m;class f extends u{constructor(){super("reports")}async getSalesReport(t={},e={}){const{showToast:r=!1,loading:n=!0}=e,o=i();n&&(o.loadingApi=!0);try{const s=await c.get("reports/sales",{params:t});return this.handleSuccess(s,r)}catch(s){return this.handleError(s,r)}}async getStockReport(t={},e={}){const{showToast:r=!1,loading:n=!0}=e,o=i();n&&(o.loadingApi=!0);try{const s=await c.get("reports/stock",{params:t});return this.handleSuccess(s,r)}catch(s){return this.handleError(s,r)}}async getProfitLossReport(t={},e={}){const{showToast:r=!1,loading:n=!0}=e,o=i();n&&(o.loadingApi=!0);try{const s=await c.get("reports/profit-loss",{params:t});return this.handleSuccess(s,r)}catch(s){return this.handleError(s,r)}}async getCashFlowReport(t={},e={}){const{showToast:r=!1,loading:n=!0}=e,o=i();n&&(o.loadingApi=!0);try{const s=await c.get("reports/cash-flow",{params:t});return this.handleSuccess(s,r)}catch(s){return this.handleError(s,r)}}async getTaxReport(t={},e={}){const{showToast:r=!1,loading:n=!0}=e,o=i();n&&(o.loadingApi=!0);try{const s=await c.get("reports/tax",{params:t});return this.handleSuccess(s,r)}catch(s){return this.handleError(s,r)}}async getCustomerSupplierReport(t={},e={}){const{showToast:r=!1,loading:n=!0}=e,o=i();n&&(o.loadingApi=!0);try{const s=await c.get("reports/customer-supplier",{params:t});return this.handleSuccess(s,r)}catch(s){return this.handleError(s,r)}}async exportToExcel(t,e={},r={}){const{showToast:n=!1}=r;try{const o=await c.get(`reports/${t}/export`,{params:e,responseType:"blob"}),s=window.URL.createObjectURL(new Blob([o.data])),a=document.createElement("a");return a.href=s,a.setAttribute("download",`report-${t}-${Date.now()}.xlsx`),document.body.appendChild(a),a.click(),a.remove(),n&&toast.success("تم تصدير التقرير بنجاح"),o.data}catch(o){return this.handleError(o,n)}}async printReport(t,e={},r={}){const{showToast:n=!1}=r;try{const o=await c.get(`reports/${t}/print`,{params:e,responseType:"blob"}),s=window.URL.createObjectURL(new Blob([o.data],{type:"application/pdf"}));return window.open(s).print(),o.data}catch(o){return this.handleError(o,n)}}}new f;class T extends u{constructor(){super("roles")}async getAll(t={},e={}){const{showToast:r=!1}=e;try{const n=await c.get("roles",{params:t});return this.handleSuccess(n,r)}catch(n){return this.handleError(n,r)}}async assignToUser(t,e,r={}){const{showToast:n=!0}=r;try{const o=await c.post(`users/${t}/roles`,{roles:e});return this.handleSuccess(o,n)}catch(o){return this.handleError(o,n)}}async create(t,e={}){const{showToast:r=!0}=e;try{const n=await c.post("roles",t);return this.handleSuccess(n,r)}catch(n){return this.handleError(n,r)}}async update(t,e,r={}){const{showToast:n=!0}=r;try{const o=await c.put(`roles/${t}`,e);return this.handleSuccess(o,n)}catch(o){return this.handleError(o,n)}}async delete(t,e={}){const{showToast:r=!0}=e;try{const n=await c.delete(`roles/${t}`);return this.handleSuccess(n,r)}catch(n){return this.handleError(n,r)}}async batchDelete(t,e={}){const{showToast:r=!0}=e;try{const n=await c.post("roles/batch-delete",{item_ids:t});return this.handleSuccess(n,r)}catch(n){return this.handleError(n,r)}}}const b=new T;class E extends u{constructor(){super("permissions")}async getAll(t={}){const{showToast:e=!1}=t;try{const r=await c.get("permissions");return this.handleSuccess(r,e)}catch(r){return this.handleError(r,e)}}}const x=new E;class v extends u{constructor(){super("companies")}}const B=new v;export{k as a,B as c,_ as i,x as p,b as r,$ as w};
