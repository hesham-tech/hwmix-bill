import{aR as U,aS as ae,aT as ue,aU as M,r as y,h as T,aV as K,aW as j,d as l,F as B,aX as oe,m as D,aY as ce,aZ as de,a_ as ve,a$ as fe,b0 as me,b1 as ge,H as q,v as he,b2 as pe,b3 as be,I as z,a9 as P,az as W,K as Ve,L as we,b4 as Ie,b5 as Ce,a3 as F,b6 as ke,b7 as xe,b8 as ye,b9 as k,ba as X,bb as Te,bc as Pe,bd as Se,G as Y,P as _e,k as Z,j as C,aG as Ae,aj as De,o as H,b as L,ap as J,M as Le,a as Ge,u as $e,q as Ee,U as Q,t as ee,a1 as Fe,a6 as Be,be as Re,aq as Ue,Y as Me,X as Ke,$ as E,Z as Ne,aF as Oe}from"./index-Tc2OuKZg.js";const je=U({...ae(ue({collapseIcon:"$treeviewCollapse",expandIcon:"$treeviewExpand"}),["subgroup"])},"VTreeviewGroup"),te=M()({name:"VTreeviewGroup",props:je(),setup(e,V){let{slots:v}=V;const t=y(),u=T(()=>{var m;return(m=t.value)!=null&&m.isOpen?e.collapseIcon:e.expandIcon}),h=T(()=>{var m;return{VTreeviewItem:{prependIcon:void 0,appendIcon:void 0,active:(m=t.value)==null?void 0:m.isOpen,toggleIcon:u.value}}});return K(()=>{const m=j.filterProps(e);return l(j,D(m,{ref:t,class:["v-treeview-group",e.class],subgroup:!0}),{...v,activator:v.activator?o=>l(B,null,[l(oe,{defaults:h.value},{default:()=>{var f;return[(f=v.activator)==null?void 0:f.call(v,o)]}})]):void 0})}),{}}}),ne=Symbol.for("vuetify:v-treeview"),qe=U({loading:Boolean,toggleIcon:ce,...de({slim:!0})},"VTreeviewItem"),le=M()({name:"VTreeviewItem",props:qe(),setup(e,V){let{attrs:v,slots:t,emit:u}=V;const h=ve(e,v),m=T(()=>e.value===void 0?h.href.value:e.value),o=y(),{activate:f,isActivated:p,select:w,isSelected:g,isIndeterminate:I,isGroupActivator:x,root:a,id:i}=fe(m,!1),c=T(()=>a.activatable.value&&x),{densityClasses:d}=me(e,"v-list-item"),s=T(()=>({isActive:p.value,select:w,isSelected:g.value,isIndeterminate:I.value})),n=T(()=>{var b;return!e.disabled&&e.link!==!1&&(e.link||h.isClickable.value||e.value!=null&&!!((b=o.value)!=null&&b.list))});function r(b){var G,$;!n.value||!c.value&&x||a.activatable.value&&(c.value?f(!p.value,b):($=o.value)==null||$.activate(!((G=o.value)!=null&&G.isActivated),b))}function S(b){(b.key==="Enter"||b.key===" ")&&(b.preventDefault(),r(b))}const _=ge(ne,{visibleIds:y()}).visibleIds;return K(()=>{var N;const b=t.title||e.title!=null,G=t.subtitle||e.subtitle!=null,$=q.filterProps(e),re=t.prepend||e.toggleIcon;return c.value?he(l("div",{class:["v-list-item","v-list-item--one-line","v-treeview-item","v-treeview-item--activetable-group-activator",{"v-list-item--active":p.value||g.value,"v-treeview-item--filtered":_.value&&!_.value.has(i.value)},d.value,e.class],onClick:r},[l(B,null,[be(p.value||g.value,"v-list-item"),e.toggleIcon&&l(z,{start:!1},{default:()=>[l(P,{density:"compact",icon:e.toggleIcon,loading:e.loading,variant:"text",onClick:e.onClick},{loader(){return l(W,{indeterminate:"disable-shrink",size:"20",width:"2"},null)}})]})]),l("div",{class:"v-list-item__content","data-no-activator":""},[b&&l(Ve,{key:"title"},{default:()=>{var A;return[((A=t.title)==null?void 0:A.call(t,{title:e.title}))??e.title]}}),G&&l(we,{key:"subtitle"},{default:()=>{var A;return[((A=t.subtitle)==null?void 0:A.call(t,{subtitle:e.subtitle}))??e.subtitle]}}),(N=t.default)==null?void 0:N.call(t,s.value)])]),[[pe("ripple"),n.value&&e.ripple]]):l(q,D({ref:o},$,{class:["v-treeview-item",{"v-treeview-item--filtered":_.value&&!_.value.has(i.value)},e.class],value:i.value,onClick:r,onKeydown:n.value&&S}),{...t,prepend:re?A=>{var O;return l(B,null,[e.toggleIcon&&l(z,{start:!1},{default:()=>[l(P,{density:"compact",icon:e.toggleIcon,loading:e.loading,variant:"text"},{loader(){return l(W,{indeterminate:"disable-shrink",size:"20",width:"2"},null)}})]}),(O=t.prepend)==null?void 0:O.call(t,A)])}:void 0})}),{}}}),ie=U({loadChildren:Function,loadingIcon:{type:String,default:"$loading"},items:Array,selectable:Boolean,selectStrategy:[String,Function,Object]},"VTreeviewChildren"),R=M()({name:"VTreeviewChildren",props:ie(),setup(e,V){let{emit:v,slots:t}=V;const u=Ie(null);function h(o){return new Promise(f=>{var p,w;if(!((p=e.items)!=null&&p.length)||!e.loadChildren)return f();if(((w=o==null?void 0:o.children)==null?void 0:w.length)===0){u.value=o.value,e.loadChildren(o).then(f);return}f()}).finally(()=>{u.value=null})}function m(o,f){e.selectable&&o(!f)}return()=>{var o,f;return((o=t.default)==null?void 0:o.call(t))??((f=e.items)==null?void 0:f.map(p=>{var d;let{children:w,props:g,raw:I}=p;const x=u.value===I.value,a={prepend:s=>{var n;return l(B,null,[e.selectable&&(!w||w&&!["leaf","single-leaf"].includes(e.selectStrategy))&&l("div",null,[l(Ce,{key:I.value,modelValue:s.isSelected,loading:x,indeterminate:s.isIndeterminate,onClick:F(()=>m(s.select,s.isSelected),["stop"]),onKeydown:r=>{["Enter","Space"].includes(r.key)&&(r.stopPropagation(),m(s.select,s.isSelected))}},null)]),(n=t.prepend)==null?void 0:n.call(t,{...s,item:I})])},append:t.append?s=>{var n;return(n=t.append)==null?void 0:n.call(t,{...s,item:I})}:void 0,title:t.title?s=>{var n;return(n=t.title)==null?void 0:n.call(t,{...s,item:I})}:void 0},i=te.filterProps(g),c=R.filterProps(e);return w?l(te,D({value:g==null?void 0:g.value},i),{activator:s=>{let{props:n}=s;const r={...g,...n,value:g==null?void 0:g.value};return l(le,D(r,{loading:x,onClick:()=>h(I)}),a)},default:()=>l(R,D(c,{items:w}),t)}):((d=t.item)==null?void 0:d.call(t,{props:g}))??l(le,g,a)}))}}});function se(e){let V=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];for(const v of e)V.push(v),v.children&&se(v.children,V);return V}const ze=U({openAll:Boolean,search:String,...ke({filterKeys:["title"]}),...ie(),...ae(xe({collapseIcon:"$treeviewCollapse",expandIcon:"$treeviewExpand",slim:!0}),["nav"])},"VTreeview"),We=M()({name:"VTreeview",props:ze(),emits:{"update:opened":e=>!0,"update:activated":e=>!0,"update:selected":e=>!0,"click:open":e=>!0,"click:select":e=>!0},setup(e,V){let{slots:v}=V;const{items:t}=ye(e),u=k(e,"activeColor"),h=k(e,"baseColor"),m=k(e,"color"),o=X(e,"activated"),f=X(e,"selected"),p=y(),w=T(()=>e.openAll?d(t.value):e.opened),g=T(()=>se(t.value)),I=k(e,"search"),{filteredItems:x}=Te(e,g,I),a=T(()=>I.value?new Set(x.value.flatMap(s=>[...i(s.props.value),...c(s.props.value)])):null);function i(s){var S;const n=[];let r=s;for(;r!=null;)n.unshift(r),r=(S=p.value)==null?void 0:S.parents.get(r);return n}function c(s){var S,_;const n=[],r=(((S=p.value)==null?void 0:S.children.get(s))??[]).slice();for(;r.length;){const b=r.shift();b&&(n.push(b),r.push(...(((_=p.value)==null?void 0:_.children.get(b))??[]).slice()))}return n}function d(s){let n=[];for(const r of s)r.children&&(n.push(r.value),r.children&&(n=n.concat(d(r.children))));return n}return Pe(ne,{visibleIds:a}),Se({VTreeviewGroup:{activeColor:u,baseColor:h,color:m,collapseIcon:k(e,"collapseIcon"),expandIcon:k(e,"expandIcon")},VTreeviewItem:{activeClass:k(e,"activeClass"),activeColor:u,baseColor:h,color:m,density:k(e,"density"),disabled:k(e,"disabled"),lines:k(e,"lines"),variant:k(e,"variant")}}),K(()=>{const s=Y.filterProps(e),n=R.filterProps(e);return l(Y,D({ref:p},s,{class:["v-treeview",e.class],style:e.style,opened:w.value,activated:o.value,"onUpdate:activated":r=>o.value=r,selected:f.value,"onUpdate:selected":r=>f.value=r}),{default:()=>[l(R,D(n,{items:t.value}),v)]})}),{open}}}),Xe={style:{width:"max-content"}},Ze={__name:"Categories",setup(e){const V=y([]),v=y([]),t=y(!1),u=y({name:"",description:"",parent_id:null}),h=y(!1);function m(a){h.value=!1,a?u.value.parent_id=a.id:u.value.parent_id=null,u.value.name="",u.value.description="",t.value=!0}function o(a){h.value=!0,u.value={...a},t.value=!0}function f(){t.value=!1,h.value=!1,u.value={name:"",description:"",parent_id:null}}function p(a){const i={};a.forEach(d=>{d.children=d.children||[],i[d.id]=d});const c=[];return a.forEach(d=>{d.parent_id?i[d.parent_id]&&i[d.parent_id].children.push(d):c.push(d)}),c}function w(){De("categories").then(a=>{V.value=a.data,console.log(V.value),v.value=p(V.value),console.log(v.value)})}const g=a=>({expandIcon:a.children&&a.children.length?"ri-folder-line":"ri-checkbox-blank-circle-line",collapseIcon:a.children&&a.children.length?"ri-folder-open-line":"ri-checkbox-blank-circle-line"});_e(()=>{w()});function I(){if(!u.value.name){E.error("اسم الفئة مطلوب");return}const a=h.value&&u.value.id;Ne("category",u.value,a?u.value.id:!1,!0,!0).then(()=>{w(),f()}).catch(()=>E.error(a?"حدث خطأ أثناء تعديل الفئة":"حدث خطأ أثناء حفظ الفئة"))}function x(a){confirm("هل أنت متأكد من حذف هذه الفئة؟")&&Oe("category",a).then(()=>{w(),E.success("تم حذف الفئة بنجاح")}).catch(()=>E.error("حدث خطأ أثناء حذف الفئة"))}return(a,i)=>(H(),Z(Ae,null,{default:C(()=>[l(P,{color:"primary",class:"mb-4",onClick:i[0]||(i[0]=c=>m(null))},{default:C(()=>i[4]||(i[4]=[L("اضافة فئة رئيسية جديدة")])),_:1}),l(Q,{class:"mt-4 pa-3",outlined:"",style:{"overflow-x":"auto"}},{default:C(()=>[l(J,null,{default:C(()=>i[5]||(i[5]=[L("الفئات الهرمية")])),_:1}),l(Le),Ge("div",Xe,[v.value.length?(H(),Z($e(We),{key:0,items:v.value,"item-title":"name","item-value":"id","open-on-click":"","item-props":g,class:"treeview-border ma-auto","max-width":"unset"},{append:C(({item:c})=>[l(P,{icon:"ri-add-line",variant:"text",color:"primary",onClick:F(d=>m(c),["stop"]),title:"إضافة فرعية",class:"mx-1"},null,8,["onClick"]),l(P,{icon:"ri-edit-line",variant:"text",color:"primary",onClick:F(d=>o(c),["stop"]),title:"تعديل الفئة",class:"mx-1"},null,8,["onClick"]),l(P,{icon:"ri-delete-bin-line",variant:"text",color:"error",onClick:F(d=>x(c.id),["stop"]),title:"حذف الفئة",class:"mx-1"},null,8,["onClick"])]),_:1},8,["items"])):Ee("",!0)])]),_:1}),l(Ke,{modelValue:t.value,"onUpdate:modelValue":i[3]||(i[3]=c=>t.value=c),"max-width":"500px",persistent:""},{default:C(()=>[l(Q,null,{default:C(()=>[l(J,null,{default:C(()=>[L(ee(h.value?"تعديل فئة":"اضافة فئة جديدة"),1)]),_:1}),l(Fe,null,{default:C(()=>[l(Be,{class:"pa-2",modelValue:u.value.name,"onUpdate:modelValue":i[1]||(i[1]=c=>u.value.name=c),label:"اسم الفئة",required:""},null,8,["modelValue"]),l(Re,{class:"pa-2",modelValue:u.value.description,"onUpdate:modelValue":i[2]||(i[2]=c=>u.value.description=c),label:"الوصف"},null,8,["modelValue"])]),_:1}),l(Ue,null,{default:C(()=>[l(Me),l(P,{text:"",onClick:f},{default:C(()=>i[6]||(i[6]=[L("الغاء")])),_:1}),l(P,{text:"",color:"blue darken-1",onClick:I},{default:C(()=>[L(ee(h.value?"تعديل":"حفظ"),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};export{Ze as default};
