import{r as z,o as f,x as v,w as e,d as t,f as b,h as S,a3 as V,b as s,v as r,u as _,B as A,i as $,e as L,D as E,n as k,R as q,c as P,F as j,j as N,Q as F,a4 as at,a5 as nt,z as U,E as O,A as R,a as H,t as ft,H as Q,G as mt,y as W,p as ot,L as X,a6 as et,a7 as lt,P as it,O as rt,a8 as pt,l as gt,a9 as _t,aa as yt,ab as st,ac as ht,ad as xt,ae as bt,M as vt,T as wt}from"./index-B0c0aplS.js";import{u as G}from"./useApi-C9JqAxpT.js";import{_ as ct}from"./AppButton-CoaWq9vh.js";import{f as M}from"./formatters-CKQiR5Fb.js";import{_ as kt}from"./AppCard-D6Bc5W2v.js";import{A as J}from"./AppDataTable-DRQWa6GE.js";import{S as $t}from"./SalesTrendChart-BPE-QiVF.js";import"./usePermissions-D1W15K8H.js";function dt(){const m=G("/api/invoices");G("/api/products"),G("/api/users"),G("/api/payments");const p=G("/api/installments"),i=z(!0),u=z(!1),g=z(!1),d=z(!1),h=z({totalInvoices:0,totalProducts:0,totalUsers:0,totalPayments:0,totalSales:0,monthlySales:0,pendingPayments:0}),y=z([]),x=z([]),C=z([]),n=z([]),c=z([]),a=async()=>{var w,I,B,K,Y,Z;i.value=!0;try{const T=(await G("/api/dashboard/summary").get({},{showLoading:!1})).data;T&&(h.value={totalSales:((w=T.kpis)==null?void 0:w.total_sales)||0,monthlySales:((I=T.kpis)==null?void 0:I.monthly_sales)||0,pendingPayments:((B=T.kpis)==null?void 0:B.pending_payments)||0,totalCustomers:((K=T.kpis)==null?void 0:K.total_customers)||0,totalProducts:((Y=T.kpis)==null?void 0:Y.total_products)||0,totalInvoices:((Z=T.recent_invoices)==null?void 0:Z.length)||0},n.value=T.sales_trend||[],y.value=T.recent_invoices||[],c.value=T.top_products||[])}catch(tt){console.error("Error fetching dashboard summary:",tt)}finally{i.value=!1}},o=async()=>{u.value=!0;try{const w=new Date,I=new Date;I.setDate(w.getDate()+5);const B=await m.get({payment_status:"unpaid,partial",due_date_from:w.toISOString().split("T")[0],due_date_to:I.toISOString().split("T")[0],per_page:5},{showLoading:!1});x.value=B.data||[]}finally{u.value=!1}},l=async()=>{g.value=!0;try{const w=new Date,I=new Date;I.setDate(w.getDate()+5);const B=await p.get({status:"pending",due_date_from:w.toISOString().split("T")[0],due_date_to:I.toISOString().split("T")[0],per_page:5},{showLoading:!1});C.value=B.data||[]}finally{g.value=!1}};return{stats:h,recentInvoices:y,upcomingPayments:x,upcomingInstallments:C,salesTrend:n,topProducts:c,loading:i,loadingUpcoming:u,loadingInstallments:g,refreshing:d,fetchDashboardData:a,fetchUpcomingPayments:o,fetchUpcomingInstallments:l,refreshAll:async()=>{d.value=!0;try{await Promise.all([a(),o(),l()])}finally{d.value=!1}}}}const Dt={class:"d-flex align-center justify-space-between"},Ct={class:"text-h5 font-weight-black text-success"},zt={class:"d-flex align-center justify-space-between"},St={class:"text-h5 font-weight-black text-primary"},It={class:"d-flex align-center justify-space-between"},Tt={class:"text-h5 font-weight-black text-error"},Vt={class:"d-flex align-center justify-space-between"},At={class:"text-h5 font-weight-black text-info"},Pt={__name:"StatsCards",props:{stats:{type:Object,required:!0}},setup(m){return(p,i)=>(f(),v(L,{dense:""},{default:e(()=>[t(b,{cols:"12",sm:"6",md:"3"},{default:e(()=>[t(S,{border:"",flat:"",class:"rounded-xl overflow-hidden pa-1"},{default:e(()=>[t(V,{class:"pa-4 bg-success-lighten-5"},{default:e(()=>[s("div",Dt,[s("div",null,[i[0]||(i[0]=s("div",{class:"text-caption font-weight-bold text-success mb-1"},"إجمالي المبيعات",-1)),s("div",Ct,r(_(M)(m.stats.totalSales)),1)]),t(A,{color:"success",size:"48",variant:"flat",class:"rounded-lg"},{default:e(()=>[t($,{icon:"ri-money-dollar-box-line",color:"white",size:"28"})]),_:1})]),i[1]||(i[1]=s("div",{class:"mt-3 text-caption text-grey"},"تراكمي منذ البداية",-1))]),_:1})]),_:1})]),_:1}),t(b,{cols:"12",sm:"6",md:"3"},{default:e(()=>[t(S,{border:"",flat:"",class:"rounded-xl overflow-hidden pa-1"},{default:e(()=>[t(V,{class:"pa-4 bg-primary-lighten-5"},{default:e(()=>[s("div",zt,[s("div",null,[i[2]||(i[2]=s("div",{class:"text-caption font-weight-bold text-primary mb-1"},"مبيعات الشهر",-1)),s("div",St,r(_(M)(m.stats.monthlySales)),1)]),t(A,{color:"primary",size:"48",variant:"flat",class:"rounded-lg"},{default:e(()=>[t($,{icon:"ri-calendar-event-line",color:"white",size:"28"})]),_:1})]),i[3]||(i[3]=s("div",{class:"mt-3 text-caption text-grey"},"مبيعات الشهر الحالي",-1))]),_:1})]),_:1})]),_:1}),t(b,{cols:"12",sm:"6",md:"3"},{default:e(()=>[t(S,{border:"",flat:"",class:"rounded-xl overflow-hidden pa-1"},{default:e(()=>[t(V,{class:"pa-4 bg-error-lighten-5"},{default:e(()=>[s("div",It,[s("div",null,[i[4]||(i[4]=s("div",{class:"text-caption font-weight-bold text-error mb-1"},"تحصيل معلق",-1)),s("div",Tt,r(_(M)(m.stats.pendingPayments)),1)]),t(A,{color:"error",size:"48",variant:"flat",class:"rounded-lg"},{default:e(()=>[t($,{icon:"ri-hand-coin-line",color:"white",size:"28"})]),_:1})]),i[5]||(i[5]=s("div",{class:"mt-3 text-caption text-grey"},"مبالغ لم يتم تحصيلها",-1))]),_:1})]),_:1})]),_:1}),t(b,{cols:"12",sm:"6",md:"3"},{default:e(()=>[t(S,{border:"",flat:"",class:"rounded-xl overflow-hidden pa-1"},{default:e(()=>[t(V,{class:"pa-4 bg-info-lighten-5"},{default:e(()=>[s("div",Vt,[s("div",null,[i[6]||(i[6]=s("div",{class:"text-caption font-weight-bold text-info mb-1"},"العملاء",-1)),s("div",At,r(m.stats.totalCustomers||0),1)]),t(A,{color:"info",size:"48",variant:"flat",class:"rounded-lg"},{default:e(()=>[t($,{icon:"ri-team-line",color:"white",size:"28"})]),_:1})]),i[7]||(i[7]=s("div",{class:"mt-3 text-caption text-grey"},"عدد العملاء النشطين",-1))]),_:1})]),_:1})]),_:1})]),_:1}))}},Lt={__name:"QuickActions",props:{actions:{type:Array,required:!0}},emits:["action-click"],setup(m){return(p,i)=>(f(),v(kt,{title:"إجراءات سريعة",icon:"ri-flashlight-line",class:"h-100"},{actions:e(()=>[t(E,{size:"x-small",color:"primary",variant:"flat",class:"font-weight-black"},{default:e(()=>i[0]||(i[0]=[k("أكثر استخداماً")])),_:1})]),default:e(()=>[t(q,{class:"pa-0"},{default:e(()=>[(f(!0),P(j,null,N(m.actions,u=>(f(),v(F,{key:u.title,class:"border-b last-child-no-border py-3 px-4 clickable-action",onClick:g=>p.$emit("action-click",u.route)},{prepend:e(()=>[t(A,{color:`${u.color}-lighten-5`,size:"40",class:"me-3"},{default:e(()=>[t($,{icon:u.icon,color:u.color},null,8,["icon","color"])]),_:2},1032,["color"])]),append:e(()=>[t($,{icon:"ri-arrow-left-s-line",color:"grey-lighten-1",size:"small"})]),default:e(()=>[t(at,{class:"font-weight-bold text-body-1"},{default:e(()=>[k(r(u.title),1)]),_:2},1024),t(nt,{class:"text-caption"},{default:e(()=>[k(r(u.subtitle),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}))}},Ut={class:"font-weight-black text-primary"},Et={class:"font-weight-medium"},Bt={class:"font-weight-black text-h6 text-success"},Gt={class:"text-center pa-8"},ut={__name:"RecentInvoices",props:{invoices:{type:Array,required:!0},loading:{type:Boolean,default:!1}},setup(m){const p=[{title:"رقم الفاتورة",key:"invoice_number"},{title:"العميل",key:"customer"},{title:"المبلغ",key:"total",align:"end"},{title:"الحالة",key:"status"}],i=d=>d?new Intl.NumberFormat("ar-EG",{style:"currency",currency:"EGP"}).format(d):"0.00 ج.م",u=d=>({draft:"grey",pending:"warning",approved:"success",cancelled:"error"})[d]||"grey",g=d=>({draft:"مسودة",pending:"قيد الانتظار",approved:"معتمدة",cancelled:"ملغاة"})[d]||d;return(d,h)=>(f(),v(J,{headers:p,items:m.invoices,loading:m.loading,title:"آخر الفواتير الصادرة",icon:"ri-file-list-3-line","hide-footer":"","items-per-page":5},{"item.invoice_number":e(({item:y})=>[s("div",Ut,"#"+r(y.invoice_number),1)]),"item.customer":e(({item:y})=>{var x;return[s("div",Et,r(((x=y.customer)==null?void 0:x.name)||"---"),1)]}),"item.total":e(({item:y})=>[s("div",Bt,r(i(y.total)),1)]),"item.status":e(({item:y})=>[t(E,{color:u(y.status),size:"small",variant:"flat",class:"font-weight-bold px-3"},{default:e(()=>[k(r(g(y.status)),1)]),_:2},1032,["color"])]),"no-data":e(()=>[s("div",Gt,[t($,{icon:"ri-file-history-line",size:"48",color:"grey-lighten-2",class:"mb-2"}),h[0]||(h[0]=s("div",{class:"text-subtitle-1 text-grey font-weight-medium"},"لا توجد فواتير حديثة حتى الآن",-1))])]),_:1},8,["items","loading"]))}},jt={class:"d-flex align-center py-2"},Nt={class:"text-primary font-weight-bold text-caption"},Mt={class:"d-flex flex-column"},qt={class:"font-weight-bold text-body-1"},Ft={class:"text-caption text-grey"},Ot={class:"d-flex flex-column"},Rt={class:"font-weight-medium text-body-2"},Ht={class:"d-flex flex-column align-end"},Qt={class:"font-weight-black text-body-1 text-error"},Wt={class:"text-caption text-grey"},Xt={class:"text-center pa-8"},Jt={__name:"UpcomingPayments",props:{payments:{type:Array,required:!0},loading:{type:Boolean,default:!1}},setup(m){const p=m,i=[{title:"العميل",key:"customer"},{title:"تاريخ الاستحقاق",key:"due_date"},{title:"المبلغ المتبقي",key:"amount",align:"end"},{title:"الأولوية",key:"urgency"}],u=U(()=>p.payments.length),g=n=>n?new Date(n).toLocaleDateString("ar-EG",{day:"numeric",month:"short"}):"-",d=n=>n?new Intl.NumberFormat("ar-EG",{style:"currency",currency:"EGP"}).format(n):"0.00 ج.م",h=n=>{if(!n)return"-";const c=new Date,o=new Date(n)-c,l=Math.ceil(o/(1e3*60*60*24));return l<0?"متأخر!":l===0?"اليوم":l===1?"غداً":`بعد ${l} يوم`},y=n=>{if(!n)return"";const c=new Date,o=new Date(n)-c,l=Math.ceil(o/(1e3*60*60*24));return l<0?"text-error font-weight-bold":l<=1?"text-warning font-weight-bold":"text-medium-emphasis"},x=n=>{if(!n)return"grey";const c=new Date,o=new Date(n)-c,l=Math.ceil(o/(1e3*60*60*24));return l<0?"error":l<=1?"warning":l<=3?"info":"success"},C=n=>{if(!n)return"-";const c=new Date,o=new Date(n)-c,l=Math.ceil(o/(1e3*60*60*24));return l<0?"متأخر":l<=1?"عاجل":l<=3?"قريب":"عادي"};return(n,c)=>(f(),v(J,{headers:i,items:m.payments,loading:m.loading,title:"الفواتير المستحقة قريباً",icon:"ri-calendar-todo-line","hide-footer":"","items-per-page":5},{actions:e(()=>[u.value>0?(f(),v(E,{key:0,color:"error",size:"small",variant:"flat",class:"font-weight-black"},{default:e(()=>[k(r(u.value)+" فواتير متأخرة ",1)]),_:1})):O("",!0)]),"item.customer":e(({item:a})=>{var o;return[s("div",jt,[t(A,{size:"36",color:"primary-lighten-5",class:"me-3"},{default:e(()=>{var l,D;return[s("span",Nt,r((D=(l=a.customer)==null?void 0:l.name)==null?void 0:D.charAt(0)),1)]}),_:2},1024),s("div",Mt,[s("span",qt,r((o=a.customer)==null?void 0:o.name),1),s("span",Ft,"فاتورة #"+r(a.invoice_number),1)])])]}),"item.due_date":e(({item:a})=>[s("div",Ot,[s("span",Rt,r(g(a.due_date)),1),s("span",{class:R([y(a.due_date),"text-caption"])},r(h(a.due_date)),3)])]),"item.amount":e(({item:a})=>[s("div",Ht,[s("span",Qt,r(d(a.remaining)),1),s("span",Wt,"من "+r(d(a.total)),1)])]),"item.urgency":e(({item:a})=>[t(E,{color:x(a.due_date),size:"small",variant:"flat",class:"font-weight-bold px-3"},{default:e(()=>[k(r(C(a.due_date)),1)]),_:2},1032,["color"])]),"no-data":e(()=>[s("div",Xt,[t($,{icon:"ri-checkbox-circle-fill",size:"48",color:"success",class:"mb-2 opacity-50"}),c[0]||(c[0]=s("div",{class:"text-subtitle-1 text-success font-weight-medium"},"ممتاز! لا توجد مديونيات متأخرة حالياً",-1))])]),_:1},8,["items","loading"]))}},Kt={class:"d-flex align-center py-2"},Yt={class:"text-info font-weight-bold text-caption"},Zt={class:"d-flex flex-column"},te={class:"font-weight-bold text-body-1"},ee={class:"text-caption text-grey"},se={class:"d-flex flex-column"},ae={class:"font-weight-bold text-body-2"},ne={class:"text-caption text-grey"},oe={class:"d-flex flex-column"},le={class:"font-weight-medium text-body-2"},ie={class:"font-weight-black text-body-1 text-info text-end"},re={class:"text-center pa-8"},ce={__name:"UpcomingInstallments",props:{installments:{type:Array,required:!0},loading:{type:Boolean,default:!1}},setup(m){const p=m,i=[{title:"العميل",key:"customer"},{title:"القسط",key:"installment_details"},{title:"تاريخ الاستحقاق",key:"due_date"},{title:"المبلغ",key:"amount",align:"end"},{title:"الحالة",key:"status"}],u=U(()=>p.installments.length),g=n=>n?new Date(n).toLocaleDateString("ar-EG",{day:"numeric",month:"short"}):"-",d=n=>n?new Intl.NumberFormat("ar-EG",{style:"currency",currency:"EGP"}).format(n):"0.00 ج.م",h=n=>{if(!n)return"-";const c=new Date,o=new Date(n)-c,l=Math.ceil(o/(1e3*60*60*24));return l<0?"متأخر!":l===0?"اليوم":l===1?"غداً":`بعد ${l} يوم`},y=n=>{if(!n)return"";const c=new Date,o=new Date(n)-c,l=Math.ceil(o/(1e3*60*60*24));return l<0?"text-error font-weight-bold":l<=1?"text-warning font-weight-bold":"text-medium-emphasis"},x=n=>({pending:"warning",paid:"success",overdue:"error",cancelled:"grey"})[n]||"info",C=n=>({pending:"معلق",paid:"مدفوع",overdue:"متأخر",cancelled:"ملغي"})[n]||n;return(n,c)=>(f(),v(J,{headers:i,items:m.installments,loading:m.loading,title:"الأقساط المستحقة قريباً",icon:"ri-calendar-schedule-line","hide-footer":"","items-per-page":5},{actions:e(()=>[u.value>0?(f(),v(E,{key:0,color:"info",size:"small",variant:"flat",class:"font-weight-black"},{default:e(()=>[k(r(u.value)+" أقساط مجدولة ",1)]),_:1})):O("",!0)]),"item.customer":e(({item:a})=>{var o;return[s("div",Kt,[t(A,{size:"36",color:"info-lighten-5",class:"me-3"},{default:e(()=>{var l,D;return[s("span",Yt,r((D=(l=a.customer)==null?void 0:l.name)==null?void 0:D.charAt(0)),1)]}),_:2},1024),s("div",Zt,[s("span",te,r((o=a.customer)==null?void 0:o.name),1),s("span",ee,"خطة #"+r(a.plan_number||a.id),1)])])]}),"item.installment_details":e(({item:a})=>[s("div",se,[s("span",ae,"قسط #"+r(a.installment_number),1),s("span",ne,"من "+r(a.total_installments)+" قسط",1)])]),"item.due_date":e(({item:a})=>[s("div",oe,[s("span",le,r(g(a.due_date)),1),s("span",{class:R([y(a.due_date),"text-caption"])},r(h(a.due_date)),3)])]),"item.amount":e(({item:a})=>[s("div",ie,r(d(a.amount)),1)]),"item.status":e(({item:a})=>[t(E,{color:x(a.status),size:"small",variant:"flat",class:"font-weight-bold px-3"},{default:e(()=>[k(r(C(a.status)),1)]),_:2},1032,["color"])]),"no-data":e(()=>[s("div",re,[t($,{icon:"ri-time-line",size:"48",color:"grey-lighten-2",class:"mb-2 opacity-50"}),c[0]||(c[0]=s("div",{class:"text-subtitle-1 text-grey font-weight-medium"},"لا توجد أقساط مستحقة خلال الفترة القادمة",-1))])]),_:1},8,["items","loading"]))}},de={class:"d-flex align-center justify-space-between mb-4"},ue={class:"chart-wrapper"},fe={key:1,class:"d-flex align-center justify-center height-300"},me={__name:"TopProductsChart",props:{data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},setup(m){const p=m,i=U(()=>[{name:"الكمية",data:p.data.map(g=>g.total_qty)}]),u=U(()=>({chart:{type:"bar",toolbar:{show:!1},fontFamily:"Inter, sans-serif"},plotOptions:{bar:{borderRadius:6,horizontal:!0,distributed:!0,barHeight:"60%"}},colors:["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6"],dataLabels:{enabled:!0,textAnchor:"start",style:{colors:["#fff"]},formatter:function(g,d){return d.w.globals.labels[d.dataPointIndex]+":  "+g},offsetX:0},legend:{show:!1},xaxis:{categories:p.data.map(g=>g.name),labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{show:!1}},grid:{show:!1},tooltip:{theme:"light",y:{formatter:g=>`${g} قطعة`}}}));return(g,d)=>{const h=ft("apexchart");return f(),v(S,{variant:"flat",border:"",class:"chart-card rounded-xl overflow-hidden pa-1"},{default:e(()=>[t(V,{class:"pa-4"},{default:e(()=>[s("div",de,[d[0]||(d[0]=s("div",null,[s("div",{class:"text-caption font-weight-bold text-grey-darken-1 mb-1"},"الأكثر مبيعاً"),s("h3",{class:"text-h6 font-weight-black"},"أفضل 5 منتجات")],-1)),t(Q,{icon:"ri-bar-chart-2-line",variant:"text",size:"small",color:"primary"})]),s("div",ue,[m.loading?(f(),P("div",fe,[t(mt,{indeterminate:"",color:"primary"})])):(f(),v(h,{key:0,type:"bar",height:"300",options:u.value,series:i.value},null,8,["options","series"]))])]),_:1})]),_:1})}}},pe=H(me,[["__scopeId","data-v-83b41ec9"]]),ge={class:"d-flex align-center mt-2 flex-row-reverse justify-end"},_e={class:"text-caption white--text",style:{"font-size":"10px !important"}},ye={key:1,class:"text-center pa-12"},he={key:2,class:"pa-6"},xe={__name:"DashboardTasksWidget",setup(m){const p=z([]),i=z(!0),u=W(),g=ot(),d=async()=>{i.value=!0;try{const n=await st.getAll({status:"pending",per_page:5});p.value=n.data}catch(n){console.error("Error fetching dashboard tasks",n)}finally{i.value=!1}},h=async n=>{const c=n.status==="completed"?"pending":"completed";try{await st.update(n.id,{status:c}),d()}catch(a){console.error("Failed to toggle task",a)}},y=n=>{g.push({name:"tasks",query:{taskId:n.id}})},x=n=>({urgent:"error",high:"warning",medium:"info",low:"success"})[n]||"grey",C=n=>({urgent:"عاجل",high:"عالي",medium:"متوسط",low:"منخفض"})[n]||n;return X(()=>{d(),u.currentUser&&(et.private(`user.${u.currentUser.id}`).listen(".task.updated",n=>{console.log("Task updated real-time:",n),d()}),et.private(`company.${u.currentUser.company_id}`).listen(".task.updated",n=>{console.log("Task updated (company level):",n),d()}))}),(n,c)=>(f(),v(S,{class:"rounded-xl border-grey-lighten-4 h-100",variant:"flat",border:""},{default:e(()=>[t(lt,{class:"pa-5 d-flex align-center gap-3"},{default:e(()=>[t($,{icon:"ri-list-check-line",color:"primary"}),c[0]||(c[0]=s("span",{class:"text-h6 font-weight-bold"},"مهامي اليوم",-1)),t(it),t(Q,{icon:"ri-external-link-line",variant:"text",size:"small",to:"/tasks"})]),_:1}),t(rt),t(V,{class:"pa-0"},{default:e(()=>[p.value.length>0?(f(),v(q,{key:0,class:"py-0"},{default:e(()=>[(f(!0),P(j,null,N(p.value,a=>(f(),v(F,{key:a.id,class:"border-b border-grey-lighten-4 pa-4",onClick:o=>y(a)},{prepend:e(()=>[t(pt,{modelValue:a.isDone,"onUpdate:modelValue":o=>a.isDone=o,density:"compact",color:"success",class:"me-2",onClick:gt(o=>h(a),["stop"])},null,8,["modelValue","onUpdate:modelValue","onClick"])]),append:e(()=>[t(E,{color:x(a.priority),size:"x-small",variant:"flat"},{default:e(()=>[k(r(C(a.priority)),1)]),_:2},1032,["color"])]),default:e(()=>[t(at,{class:R([{"text-decoration-line-through text-grey":a.status==="completed"},"font-weight-bold"])},{default:e(()=>[k(r(a.title),1)]),_:2},1032,["class"]),t(nt,null,{default:e(()=>{var o;return[k(r(a.description||"لا يوجد وصف")+" ",1),s("div",ge,[(f(!0),P(j,null,N((o=a.assignments)==null?void 0:o.slice(0,3),(l,D)=>(f(),v(A,{key:l.id,size:"24",color:l.assignable.color||"primary",class:"border border-white ms-n1",style:_t({zIndex:10-D})},{default:e(()=>{var w,I;return[s("span",_e,r(((w=l.assignable.nickname)==null?void 0:w[0])||((I=l.assignable.name)==null?void 0:I[0])),1)]}),_:2},1032,["color","style"]))),128))])]}),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):i.value?(f(),P("div",he,[t(yt,{type:"list-item-three-line@3"})])):(f(),P("div",ye,[t($,{icon:"ri-check-double-line",size:"48",color:"grey-lighten-3",class:"mb-2"}),c[1]||(c[1]=s("p",{class:"text-grey mb-0"},"لا يوجد مهام تتطلب انتباهك حالياً",-1))]))]),_:1})]),_:1}))}},be={class:"admin-dashboard"},ve={class:"mb-6 px-6 pt-6 d-flex align-center justify-space-between"},we={class:"px-6 mb-6"},ke={__name:"AdminDashboard",setup(m){const p=ot(),{stats:i,recentInvoices:u,upcomingPayments:g,upcomingInstallments:d,salesTrend:h,topProducts:y,loading:x,loadingUpcoming:C,loadingInstallments:n,refreshing:c,refreshAll:a}=dt(),o=[{title:"فاتورة جديدة",subtitle:"إنشاء فاتورة بيع",icon:"ri-file-add-line",color:"primary",route:"/invoices/create"},{title:"تسجيل دفعة",subtitle:"إضافة دفعة جديدة",icon:"ri-money-dollar-circle-line",color:"success",route:"/payments/create"},{title:"منتج جديد",subtitle:"إضافة منتج للمخزون",icon:"ri-shopping-bag-line",color:"info",route:"/products/create"},{title:"عرض التقارير",subtitle:"تقارير مفصلة",icon:"ri-bar-chart-line",color:"warning",route:"/reports"}],l=D=>{p.push(D)};return X(async()=>{await a()}),(D,w)=>(f(),P("div",be,[s("div",ve,[w[1]||(w[1]=s("div",null,[s("h1",{class:"text-h4 font-weight-bold"},"لوحة التحكم الإحصائية"),s("p",{class:"text-body-1 text-grey"},"تحليل أداء النظام، الفواتير، وحركات المخزون في مكان واحد")],-1)),t(ct,{color:"primary","prepend-icon":"ri-refresh-line",variant:"tonal",loading:_(c),onClick:_(a)},{default:e(()=>w[0]||(w[0]=[k(" تحديث البيانات ")])),_:1},8,["loading","onClick"])]),s("div",we,[_(x)?(f(),v(ht,{key:0,indeterminate:"",color:"primary",class:"rounded-t"})):O("",!0),t(Pt,{stats:_(i)},null,8,["stats"])]),t(L,{class:"px-6 mx-0 mb-6"},{default:e(()=>[t(b,{cols:"12",lg:"8"},{default:e(()=>[t(L,null,{default:e(()=>[t(b,{cols:"12"},{default:e(()=>[t($t,{data:_(h),loading:_(x)},null,8,["data","loading"])]),_:1})]),_:1})]),_:1}),t(b,{cols:"12",lg:"4"},{default:e(()=>[t(xe)]),_:1})]),_:1}),t(L,{class:"px-6 mx-0 mb-6"},{default:e(()=>[t(b,{cols:"12"},{default:e(()=>[t(pe,{data:_(y),loading:_(x)},null,8,["data","loading"])]),_:1})]),_:1}),t(L,{class:"px-6 mx-0"},{default:e(()=>[t(b,{cols:"12",lg:"4"},{default:e(()=>[t(Lt,{actions:o,onActionClick:l})]),_:1}),t(b,{cols:"12",lg:"8"},{default:e(()=>[t(ut,{invoices:_(u),loading:_(x)},null,8,["invoices","loading"])]),_:1})]),_:1}),t(L,{class:"px-6 mx-0 pb-6 mt-4"},{default:e(()=>[t(b,{cols:"12",md:"6"},{default:e(()=>[t(Jt,{payments:_(g),loading:_(C)},null,8,["payments","loading"])]),_:1}),t(b,{cols:"12",md:"6"},{default:e(()=>[t(ce,{installments:_(d),loading:_(n)},null,8,["installments","loading"])]),_:1})]),_:1})]))}},$e={class:"customer-dashboard pa-6"},De={class:"welcome-section mb-8"},Ce={class:"text-h3 font-weight-bold primary-gradient-text"},ze={class:"text-h6 text-grey-darken-1 font-weight-regular mt-2"},Se={class:"text-h3 font-weight-black text-white mt-1"},Ie={class:"text-h5 font-weight-bold"},Te={class:"text-h5 font-weight-bold"},Ve={class:"d-flex align-center justify-space-between mb-2"},Ae={__name:"CustomerDashboard",setup(m){const p=W(),{stats:i,recentInvoices:u,upcomingInstallments:g,loadingInvoices:d,refreshAll:h}=dt(),y=U(()=>{var a,o;return((o=(a=p.currentUser)==null?void 0:a.full_name)==null?void 0:o.split(" ")[0])||"أهلاً بك"}),x=U(()=>{const a=p.companies.find(o=>{var l;return o.id===((l=p.currentUser)==null?void 0:l.company_id)});return(a==null?void 0:a.name)||"الشركة"}),C=U(()=>{const a=new Date().getHours();return a<12?"صباح الخير":a<18?"مساء الخير":"أهلاً بك"}),n=a=>new Intl.NumberFormat("ar-EG",{style:"currency",currency:"EGP"}).format(a||0),c=[{title:"كشف حسابي",icon:"ri-file-search-line",props:{to:"/reports/my-statement"}},{title:"فواتيري السابقة",icon:"ri-bill-line",props:{to:"/invoices"}},{title:"جدول أقساطي",icon:"ri-calendar-2-line",props:{to:"/installments"}},{title:"تحويل نقدي",icon:"ri-send-plane-2-line",props:{to:"/transactions/create"}}];return X(()=>{h()}),(a,o)=>(f(),P("div",$e,[s("div",De,[s("h1",Ce,r(C.value)+", "+r(y.value)+"!",1),s("p",ze,"إليك ملخص معاملاتك في "+r(x.value),1)]),t(L,null,{default:e(()=>[t(b,{cols:"12",md:"4"},{default:e(()=>[t(S,{class:"premium-card balance-card",elevation:"4"},{default:e(()=>[o[1]||(o[1]=s("div",{class:"card-glow"},null,-1)),t(V,{class:"d-flex flex-column align-center py-8"},{default:e(()=>{var l;return[t($,{icon:"ri-wallet-3-line",size:"48",color:"white",class:"mb-4"}),o[0]||(o[0]=s("div",{class:"text-overline text-white-50"},"رصيدك الحالي",-1)),s("div",Se,r(n((l=_(p).currentUser)==null?void 0:l.balance)),1)]}),_:1})]),_:1})]),_:1}),t(b,{cols:"12",md:"4"},{default:e(()=>[t(S,{class:"premium-card info-card",elevation:"2"},{default:e(()=>[t(V,{class:"d-flex align-center py-6"},{default:e(()=>[t(A,{color:"primary-lighten-4",size:"64",class:"me-4"},{default:e(()=>[t($,{icon:"ri-shopping-cart-2-line",color:"primary",size:"32"})]),_:1}),s("div",null,[o[2]||(o[2]=s("div",{class:"text-caption text-grey"},"إجمالي المشتريات",-1)),s("div",Ie,r(_(i).totalInvoices)+" فاتورة",1)])]),_:1})]),_:1})]),_:1}),t(b,{cols:"12",md:"4"},{default:e(()=>[t(S,{class:"premium-card info-card",elevation:"2"},{default:e(()=>[t(V,{class:"d-flex align-center py-6"},{default:e(()=>[t(A,{color:"warning-lighten-4",size:"64",class:"me-4"},{default:e(()=>[t($,{icon:"ri-calendar-todo-line",color:"warning",size:"32"})]),_:1}),s("div",null,[o[3]||(o[3]=s("div",{class:"text-caption text-grey"},"أقساط قادمة",-1)),s("div",Te,r(_(g).length)+" قسط قريباً",1)])]),_:1})]),_:1})]),_:1})]),_:1}),t(L,{class:"mt-6"},{default:e(()=>[t(b,{cols:"12",lg:"8"},{default:e(()=>[t(S,{rounded:"xl",class:"border"},{default:e(()=>[t(xt,{flat:"",color:"transparent",class:"px-4"},{default:e(()=>[t(bt,{class:"font-weight-bold"},{default:e(()=>o[4]||(o[4]=[k("آخر مشترياتي")])),_:1}),t(it),t(ct,{variant:"text",size:"small",to:"/invoices"},{default:e(()=>o[5]||(o[5]=[k("عرض الكل")])),_:1})]),_:1}),t(rt),t(ut,{invoices:_(u),loading:_(d),"hide-actions":""},null,8,["invoices","loading"])]),_:1})]),_:1}),t(b,{cols:"12",lg:"4"},{default:e(()=>[t(S,{rounded:"xl",class:"border bg-grey-lighten-5"},{default:e(()=>[t(lt,{class:"font-weight-bold px-6 pt-6"},{default:e(()=>o[6]||(o[6]=[k("روابط سريعة")])),_:1}),t(V,{class:"px-4 pb-6"},{default:e(()=>[t(q,{"bg-color":"transparent"},{default:e(()=>[(f(),P(j,null,N(c,(l,D)=>t(F,vt({key:D,ref_for:!0},l.props,{class:"mb-2 rounded-lg py-3 action-item","prepend-icon":l.icon,title:l.title,variant:"flat",color:"white",elevation:"1"}),null,16,["prepend-icon","title"])),64))]),_:1})]),_:1})]),_:1}),t(S,{rounded:"xl",class:"mt-4 primary-gradient text-white pa-6"},{default:e(()=>[s("div",Ve,[o[7]||(o[7]=s("span",{class:"text-h6 font-weight-bold"},"هل تحتاج مساعدة؟",-1)),t($,{icon:"ri-customer-service-2-line",size:"32"})]),o[9]||(o[9]=s("p",{class:"text-body-2 mb-4 opacity-80"},"نحن هنا لخدمتك دائماً. تواصل معنا لأي استفسار حول معاملاتك.",-1)),t(Q,{block:"",color:"white",variant:"flat",class:"text-primary font-weight-bold rounded-lg"},{default:e(()=>o[8]||(o[8]=[k("تواصل مع الدعم")])),_:1})]),_:1})]),_:1})]),_:1})]))}},Pe=H(Ae,[["__scopeId","data-v-108c0bd7"]]),Le={class:"dashboard-container"},Ue={__name:"Dashboard",setup(m){const p=W();return(i,u)=>(f(),P("div",Le,[t(wt,{name:"fade",mode:"out-in"},{default:e(()=>[_(p).isStaff?(f(),v(ke,{key:0})):(f(),v(Pe,{key:1}))]),_:1})]))}},Oe=H(Ue,[["__scopeId","data-v-da67bed2"]]);export{Oe as default};
