import{au as B,r as s,y as G,aI as o,q as i,aJ as f,aK as I}from"./index-DPR0tjT6.js";const j=B("userManagement",()=>{const n=s([]),h=s([]),g=s({}),m=s(null),t=s(!1),E=s(0),R=s({total:0,active:0,inactive:0,admins:0}),v=s(1),U=s(10),y=s(""),d=s([]),p=s(null),w=s(null),S=s(!1),b=G(()=>{var e,r;return{page:v.value,per_page:U.value,search:y.value,role:p.value,status:w.value,sort_by:((e=d.value[0])==null?void 0:e.key)||"",order:((r=d.value[0])==null?void 0:r.order)||"desc",global:S.value}});async function A(e){t.value=!0;try{return(await o.lookup(e)).data}catch(r){throw console.error("Error looking up user:",r),r}finally{t.value=!1}}async function l(e={}){const{append:r=!1}=e;t.value=!0;try{const a=await o.getAll(b.value,{showToast:!1});return r?n.value=[...n.value,...a.data]:n.value=a.data,E.value=a.total,a}catch(a){throw console.error("Error fetching users:",a),a}finally{t.value=!1}}async function c(){try{const e=await o.getStats();return R.value=e.data,e.data}catch(e){console.error("Error fetching user stats:",e)}}async function k(e){t.value=!0;try{const r=await o.getOne(e);return m.value=r.data[0],r.data[0]}catch(r){throw console.error("Error fetching user:",r),r}finally{t.value=!1}}async function P(e){t.value=!0;try{const r=await o.save(e);return await l(),await c(),i.success("تم إنشاء المستخدم بنجاح"),r.data[0]}catch(r){throw console.error("Error creating user:",r),r}finally{t.value=!1}}async function F(e,r){t.value=!0;try{const a=await o.update(e,r);return await l(),await c(),i.success("تم تحديث المستخدم بنجاح"),a.data[0]}catch(a){throw console.error("Error updating user:",a),a}finally{t.value=!1}}async function M(e){t.value=!0;try{await o.delete(e),await l(),await c(),i.success("تم حذف المستخدم بنجاح")}catch(r){throw console.error("Error deleting user:",r),r}finally{t.value=!1}}async function _(e,r){t.value=!0;try{await o.assignRole(e,r),await k(e),i.success("تم تعيين الدور بنجاح")}catch(a){throw console.error("Error assigning role:",a),a}finally{t.value=!1}}async function u(){try{const e=await f.getAll();return h.value=e.data,e.data}catch(e){console.error("Error fetching roles:",e)}}async function q(){try{const e=await I.getAll();return g.value=e.data,e.data}catch(e){console.error("Error fetching permissions:",e)}}function x(){p.value=null,w.value=null,y.value="",v.value=1}return{users:n,roles:h,availablePermissions:g,currentUser:m,loading:t,totalItems:E,stats:R,page:v,itemsPerPage:U,search:y,sortBy:d,roleFilter:p,statusFilter:w,isGlobalMode:S,params:b,fetchUsers:l,fetchStats:c,fetchUser:k,lookupUser:A,createUser:P,updateUser:F,deleteUser:M,assignRole:_,fetchRoles:u,fetchAvailablePermissions:q,resetFilters:x,createRole:async e=>{const r=await f.create(e);return r&&await u(),r},updateRole:async(e,r)=>{const a=await f.update(e,r);return a&&await u(),a},deleteRole:async e=>{const r=await f.delete(e);return r&&await u(),r}}});export{j as u};
