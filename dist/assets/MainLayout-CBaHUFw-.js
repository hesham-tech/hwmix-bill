import{P as t,v as H,r as M,x as R,o as i,s as p,w as s,a as v,b as e,d as ce,c as g,F as P,h as B,e as ue,f as de,u as o,y as G,z as Y,A as j,g as k,t as w,B as pe,l as U,C as x,D as me,E as ee,p as L,G as te,H as _e,I as q,J as ve,T as ie,K as W,j as fe,L as N,M as F,N as se,O as E,Q as le,R as ge,m as oe,S as ne,U as he,W as ye,X as be,Y as xe,Z as Ve,_ as Se,V as Q,$ as ke,n as Ae,q as Ee,a0 as we}from"./index-CuR9-sbN.js";import{A as Ce}from"./AppDialog-vLCI3uF9.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as Z}from"./AppButton-CREzoRf6.js";const Le=[{title:"لوحة التحكم",icon:"ri-dashboard-line",to:"/dashboard",permission:null},{title:"الفواتير",icon:"ri-file-list-3-line",permission:t.INVOICES_PAGE,children:[{title:"قائمة الفواتير",to:"/invoices",icon:"ri-file-list-line",permission:t.INVOICES_VIEW_ALL},{title:"فاتورة جديدة",to:"/invoices/create",icon:"ri-file-add-line",permission:t.INVOICES_CREATE}]},{title:"المنتجات",icon:"ri-shopping-bag-3-line",permission:t.PRODUCTS_PAGE,children:[{title:"قائمة المنتجات",to:"/products",icon:"ri-list-check",permission:t.PRODUCTS_VIEW_ALL},{title:"منتج جديد",to:"/products/create",icon:"ri-add-box-line",permission:t.PRODUCTS_CREATE},{title:"أشكال المنتجات",to:"/product-variants",icon:"ri-stack-line",permission:t.PRODUCTS_VIEW_ALL},{title:"الأقسام والفئات",to:"/categories",icon:"ri-organization-chart",permission:t.CATEGORIES_VIEW_ALL},{title:"العلامات التجارية",to:"/brands",icon:"ri-price-tag-3-line",permission:t.BRANDS_VIEW_ALL},{title:"خصائص المنتج",to:"/attributes",icon:"ri-list-settings-line",permission:t.PRODUCTS_VIEW_ALL},{title:"المخازن",to:"/warehouses",icon:"ri-building-line",permission:t.WAREHOUSES_VIEW_ALL},{title:"المخزون",to:"/stock",icon:"ri-archive-line",permission:t.PRODUCTS_VIEW_ALL}]},{title:"المدفوعات",icon:"ri-money-dollar-circle-line",permission:t.PAYMENTS_PAGE,children:[{title:"قائمة المدفوعات",to:"/payments",icon:"ri-list-check-2",permission:t.PAYMENTS_VIEW_ALL},{title:"إضافة دفعة",to:"/payments/create",icon:"ri-add-circle-line",permission:t.PAYMENTS_CREATE}]},{title:"التقسيط",icon:"ri-calendar-schedule-line",permission:t.PAYMENTS_PAGE,children:[{title:"خطط التقسيط",to:"/installment-plans",icon:"ri-calendar-check-line",permission:t.PAYMENTS_VIEW_ALL},{title:"دفعات الأقساط",to:"/installment-payments",icon:"ri-money-dollar-box-line",permission:t.PAYMENTS_VIEW_ALL}]},{title:"الخزائن",icon:"ri-safe-line",permission:t.ADMIN_COMPANY,children:[{title:"قائمة الخزائن",to:"/cashboxes",icon:"ri-inbox-line",permission:t.ADMIN_COMPANY},{title:"التحويلات",to:"/transactions",icon:"ri-exchange-line",permission:t.ADMIN_COMPANY}]},{title:"التقارير",icon:"ri-line-chart-line",permission:null,children:[{title:"تقرير المبيعات",to:"/reports/sales",icon:"ri-bar-chart-box-line",permission:t.REPORTS_SALES},{title:"تقرير المخزون",to:"/reports/stock",icon:"ri-database-2-line",permission:t.REPORTS_STOCK},{title:"تقرير الأرباح",to:"/reports/profit",icon:"ri-funds-line",permission:t.REPORTS_PROFIT},{title:"التدفق النقدي",to:"/reports/cash-flow",icon:"ri-exchange-funds-line",permission:t.REPORTS_CASH_FLOW},{title:"تقرير الضرائب",to:"/reports/tax",icon:"ri-percent-line",permission:t.REPORTS_TAX}]},{title:"المستخدمين",icon:"ri-user-line",permission:t.USERS_VIEW_ALL,children:[{title:"قائمة المستخدمين",to:"/users",icon:"ri-group-line",permission:t.USERS_VIEW_ALL},{title:"الأدوار والصلاحيات",to:"/roles",icon:"ri-shield-user-line",permission:t.ROLES_VIEW_ALL}]},{title:"الإعدادات",icon:"ri-settings-3-line",permission:t.ADMIN_COMPANY,children:[{title:"بيانات الشركة",to:"/company",icon:"ri-building-2-line",permission:t.ADMIN_COMPANY},{title:"طرق الدفع",to:"/payment-methods",icon:"ri-bank-card-line",permission:t.PAYMENT_METHODS_VIEW_ALL},{title:"أنواع الفواتير",to:"/invoice-types",icon:"ri-file-copy-line",permission:t.INVOICES_VIEW_ALL},{title:"أنواع الخزائن",to:"/cashbox-types",icon:"ri-safe-2-line",permission:t.ADMIN_COMPANY},{title:"سجل الأنشطة",to:"/activity-logs",icon:"ri-history-line",permission:t.ADMIN_SUPER}]}],Ie=[{title:"لوحة التحكم",icon:"ri-dashboard-3-line",to:"/dashboard",permission:null},{title:"مشترياتي",icon:"ri-bill-line",to:"/invoices",permission:null},{title:"جدول الأقساط",icon:"ri-calendar-todo-line",to:"/installments",permission:null},{title:"حسابي المالي",icon:"ri-wallet-3-line",to:"/reports/my-statement",permission:null},{title:"التحويلات",icon:"ri-exchange-line",to:"/transactions",permission:null}],Ne={class:"pa-0 dialog-content"},Pe={class:"pa-4 pt-2 overflow-y-auto",style:{"max-height":"500px"}},Me={class:"d-flex pa-3 align-start"},Re={class:"flex-grow-1"},Te={class:"d-flex align-center justify-space-between mb-1"},Oe={class:"text-h6 font-weight-bold company-name"},Ue={class:"d-flex flex-wrap gap-2 mb-2 align-center"},De={key:0,class:"text-caption text-grey-darken-1 d-flex align-center"},$e={key:1,class:"text-caption text-grey-darken-1 d-flex align-center"},ze={key:0,class:"text-caption text-grey mb-2 line-clamp-1"},We={class:"ms-2 align-self-center"},Ye={key:0,class:"text-center py-10"},Be={__name:"CompanySwitchDialog",props:{modelValue:{type:Boolean,required:!0}},emits:["update:modelValue"],setup(D,{emit:I}){const V=I,a=H(),h=M(null),C=M(""),S=R(()=>{if(!a.companies)return[];const m=C.value.toLowerCase();return a.companies.filter(u=>{var l,_,d,r;return((l=u.name)==null?void 0:l.toLowerCase().includes(m))||((_=u.field)==null?void 0:_.toLowerCase().includes(m))||((d=u.owner_name)==null?void 0:d.toLowerCase().includes(m))||((r=u.address)==null?void 0:r.toLowerCase().includes(m))})}),y=async m=>{var u;if(m.id===((u=a.currentUser)==null?void 0:u.company_id)){V("update:modelValue",!1);return}try{h.value=m.id,await a.switchCompany(m.id),L.success(`تم الانتقال إلى ${m.name} بنجاح`),V("update:modelValue",!1)}catch{L.error("فشل في تبديل الشركة، يرجى المحاولة مرة أخرى")}finally{h.value=null}};return(m,u)=>(i(),p(Ce,{"model-value":D.modelValue,title:"تبديل المتجر / الشركة",icon:"ri-exchange-funds-line","max-width":"700","hide-actions":!0,"onUpdate:modelValue":u[0]||(u[0]=l=>m.$emit("update:modelValue",l))},{default:s(()=>[v("div",Ne,[v("div",Pe,[u[3]||(u[3]=v("div",{class:"text-subtitle-2 mb-3 text-grey-darken-1 px-1"},"الشركات التي يمكنك ادارتها:",-1)),e(ce,{dense:""},{default:s(()=>[(i(!0),g(P,null,B(S.value,l=>(i(),p(ue,{key:l.id,cols:"12"},{default:s(()=>{var _,d;return[e(de,{active:l.id===((_=o(a).currentUser)==null?void 0:_.company_id),class:G(["company-card mb-2",{"active-card":l.id===((d=o(a).currentUser)==null?void 0:d.company_id)}]),variant:"outlined",onClick:r=>y(l),disabled:h.value===l.id},{default:s(()=>{var r;return[v("div",Me,[e(Y,{size:"64",rounded:"lg",color:"grey-lighten-4",class:"me-4 border-thin"},{default:s(()=>[l.logo?(i(),p(j,{key:0,src:l.logo,contain:""},null,8,["src"])):(i(),p(k,{key:1,icon:"ri-building-line",color:"primary",size:"32"}))]),_:2},1024),v("div",Re,[v("div",Te,[v("h3",Oe,w(l.name),1),l.id===((r=o(a).currentUser)==null?void 0:r.company_id)?(i(),p(pe,{key:0,size:"x-small",color:"success",class:"text-caption font-weight-bold",variant:"flat"},{default:s(()=>u[1]||(u[1]=[U(" النشطة حالياً ")])),_:1})):x("",!0)]),v("div",Ue,[l.field?(i(),g("span",De,[e(k,{icon:"ri-apps-2-line",start:"",size:"14",class:"me-1"}),U(" "+w(l.field),1)])):x("",!0),l.owner_name?(i(),g("span",$e,[e(k,{icon:"ri-user-star-line",start:"",size:"14",class:"me-1"}),U(" "+w(l.owner_name),1)])):x("",!0)]),l.description?(i(),g("div",ze,w(l.description),1)):x("",!0)]),v("div",We,[h.value===l.id?(i(),p(me,{key:0,indeterminate:"",size:"24",width:"3",color:"primary"})):(i(),p(ee,{key:1,icon:"ri-arrow-left-line",variant:"text",color:"primary",size:"small"}))])])]}),_:2},1032,["active","onClick","disabled","class"])]}),_:2},1024))),128))]),_:1}),S.value.length===0?(i(),g("div",Ye,[e(k,{icon:"ri-building-2-line",size:"64",color:"grey-lighten-2",class:"mb-3"}),u[2]||(u[2]=v("div",{class:"text-h6 text-grey"},"لا توجد شركات تطابق بحثك",-1))])):x("",!0)])])]),_:1},8,["model-value"]))}},Ge=K(Be,[["__scopeId","data-v-f9602698"]]),qe={class:"logo-container"},Fe={key:0,class:"logo-text-wrapper ms-3"},He={class:"logo-text"},je={key:0,class:"company-field text-caption text-primary font-weight-medium"},Ke={key:1,class:"text-caption text-grey-darken-1 d-flex align-center mt-0 switch-hint"},Xe={key:0,class:"header-rail-toggle"},Je={class:"sidebar-menu-wrapper"},Qe={__name:"Sidebar",props:{modelValue:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(D,{emit:I}){const V=M(!1),{xs:a,smAndUp:h}=te(),C=oe(),S=ne(),y=H(),m=R(()=>y.companies.find(f=>{var n;return f.id===((n=y.currentUser)==null?void 0:n.company_id)})),u=_e(),l=D,_=I,d=R({get:()=>l.modelValue,set:f=>_("update:modelValue",f)}),r=M(!1),A=M([]);q(a,f=>{f?d.value=!1:(d.value=!0,r.value=!1)},{immediate:!0});const T=()=>{setTimeout(()=>{const f=document.querySelector(".sidebar .active-link");f&&f.scrollIntoView({behavior:"smooth",block:"center"})},300)};ve(T),q(()=>S.path,T);const $=R(()=>(y.isStaff?Le:Ie).filter(n=>X(n.permission))),X=f=>f?y.hasPermission(f):!0,ae=async()=>{try{await u.logout(),L.success("تم تسجيل الخروج بنجاح"),C.push("/login")}catch{L.error("حدث خطأ أثناء تسجيل الخروج")}};return(f,n)=>(i(),p(ge,{modelValue:d.value,"onUpdate:modelValue":n[7]||(n[7]=z=>d.value=z),rail:r.value,permanent:o(h),persistent:o(h),temporary:o(a),touchless:o(h),scrim:o(a)?"rgba(0,0,0,0.1)":!1,width:"280",class:"sidebar",color:"background"},{default:s(()=>{var z;return[v("div",{class:G(["sidebar-sidebar-header-wrapper",{"collapsible-header":o(y).companies.length>1}])},[v("div",{class:G(["sidebar-header flex-grow-1",{clickable:o(y).companies.length>1}]),onClick:n[0]||(n[0]=c=>o(y).companies.length>1?V.value=!0:null)},[v("div",qe,[(z=m.value)!=null&&z.logo?(i(),p(Y,{key:0,size:"50",rounded:"lg",class:"logo-avatar"},{default:s(()=>[e(j,{src:m.value.logo,contain:""},null,8,["src"])]),_:1})):(i(),p(Y,{key:1,size:"50",rounded:"lg",color:"primary",variant:"tonal",class:"logo-avatar"},{default:s(()=>[e(k,{icon:"ri-building-line",size:"28"})]),_:1})),e(ie,{name:"fade"},{default:s(()=>{var c,O;return[!r.value||o(a)?(i(),g("div",Fe,[v("h2",He,w(((c=m.value)==null?void 0:c.name)||"hwmix-bill"),1),(O=m.value)!=null&&O.field&&!r.value?(i(),g("div",je,w(m.value.field),1)):x("",!0),o(y).companies.length>1?(i(),g("div",Ke,[n[8]||(n[8]=v("span",null,"تبديل الشركة",-1)),e(k,{icon:"ri-arrow-up-down-line",size:"10",class:"ms-1"})])):x("",!0)])):x("",!0)]}),_:1})])],2),o(a)?x("",!0):(i(),g("div",Xe,[e(N,{text:r.value?"توسيع القائمة":"تقليص القائمة",location:"right"},{activator:s(({props:c})=>[e(ee,W(c,{icon:r.value?"ri-arrow-left-s-line":"ri-arrow-right-s-line",color:"primary",size:"40",class:"rail-floating-btn",elevation:"4",onClick:n[1]||(n[1]=fe(O=>r.value=!r.value,["stop"]))}),null,16,["icon"])]),_:1},8,["text"])]))],2),e(F),v("div",Je,[e(le,{opened:A.value,"onUpdate:opened":n[5]||(n[5]=c=>A.value=c),"open-strategy":"single",density:"compact",nav:"",class:"sidebar-menu"},{default:s(()=>[(i(!0),g(P,null,B($.value,(c,O)=>(i(),g(P,{key:O},[c.children&&c.children.length>0?(i(),p(he,{key:0,value:c.title},{activator:s(({props:b})=>[e(E,W({ref_for:!0},b,{"prepend-icon":c.icon,title:c.title,class:"menu-item group-header"}),{default:s(()=>[r.value&&!o(a)?(i(),p(N,{key:0,activator:"parent",text:c.title,location:"end"},null,8,["text"])):x("",!0)]),_:2},1040,["prepend-icon","title"])]),default:s(()=>[(i(!0),g(P,null,B(c.children.filter(b=>X(b.permission)),(b,re)=>(i(),g(P,{key:re},[r.value&&!o(a)?(i(),p(N,{key:0,text:b.title,location:"end"},{activator:s(({props:J})=>[e(E,W({ref_for:!0},J,{to:b.to,title:b.title,"prepend-icon":b.icon||"ri-subtract-line",class:"menu-sub-item","selected-class":"active-link",onClick:n[2]||(n[2]=st=>o(a)?d.value=!1:null)}),null,16,["to","title","prepend-icon"])]),_:2},1032,["text"])):(i(),p(E,{key:1,to:b.to,title:b.title,"prepend-icon":b.icon||"ri-subtract-line",class:"menu-sub-item","selected-class":"active-link",onClick:n[3]||(n[3]=J=>o(a)?d.value=!1:null)},null,8,["to","title","prepend-icon"]))],64))),128))]),_:2},1032,["value"])):(i(),p(E,{key:1,to:c.to,"prepend-icon":c.icon,title:c.title,class:"menu-item","selected-class":"active-link",onClick:n[4]||(n[4]=b=>o(a)?d.value=!1:null)},{default:s(()=>[r.value&&!o(a)?(i(),p(N,{key:0,activator:"parent",text:c.title,location:"end"},null,8,["text"])):x("",!0)]),_:2},1032,["to","prepend-icon","title"]))],64))),128)),e(se),e(F,{class:"my-2"}),e(E,{"prepend-icon":"ri-logout-box-line",title:"تسجيل الخروج",onClick:ae,class:"logout-item"},{default:s(()=>[r.value&&!o(a)?(i(),p(N,{key:0,activator:"parent",text:"تسجيل الخروج",location:"end"})):x("",!0)]),_:1})]),_:1},8,["opened"])]),e(Ge,{modelValue:V.value,"onUpdate:modelValue":n[6]||(n[6]=c=>V.value=c)},null,8,["modelValue"])]}),_:1},8,["modelValue","rail","permanent","persistent","temporary","touchless","scrim"]))}},Ze=K(Qe,[["__scopeId","data-v-43950085"]]),et={class:"d-none d-sm-inline"},tt={class:"sticky-breadcrumbs-container border-b"},it={__name:"MainLayout",setup(D){const{xs:I}=te(),V=ne(),a=oe(),h=H(),C=ye(),S=M(!I.value);q(I,_=>{S.value=!_},{immediate:!0});const y=R(()=>{var _;return((_=h.currentUser)==null?void 0:_.full_name)||"المستخدم"}),m=R(()=>{const _=[{title:"الرئيسية",to:"/dashboard",disabled:!1}];return V.meta.breadcrumbs?_.push(...V.meta.breadcrumbs):V.meta.title&&_.push({title:V.meta.title,disabled:!0}),_}),u=()=>{C.toggleLocale(),L.success(C.locale==="ar"?"تم التبديل للعربية":"Switched to English")},l=async()=>{try{await Ae.logout(),L.success("تم تسجيل الخروج بنجاح"),a.push("/login")}catch{L.error("فشل تسجيل الخروج")}};return(_,d)=>{const r=Ee("router-view");return i(),g(P,null,[e(Ze,{modelValue:S.value,"onUpdate:modelValue":d[0]||(d[0]=A=>S.value=A)},null,8,["modelValue"]),e(be,{color:"surface",elevation:"0",class:"border-b"},{default:s(()=>[e(Ve,{color:"primary",onClick:d[1]||(d[1]=A=>S.value=!S.value),class:"d-flex d-sm-none"}),e(se),e(Z,{icon:"",variant:"text",onClick:u,class:"mx-2"},{default:s(()=>[e(k,null,{default:s(()=>d[2]||(d[2]=[U("ri-translate-2")])),_:1}),e(N,{activator:"parent",location:"bottom"},{default:s(()=>[U(w(o(C).locale==="ar"?"English":"عربي"),1)]),_:1})]),_:1}),e(Se,null,{activator:s(({props:A})=>[e(Z,W(A,{variant:"text",class:"user-menu-btn px-2"}),{default:s(()=>[e(Y,{size:"30",color:"primary",class:"ml-2"},{default:s(()=>{var T,$;return[(T=o(h).currentUser)!=null&&T.avatar_url?(i(),p(j,{key:0,src:($=o(h).currentUser)==null?void 0:$.avatar_url,cover:""},null,8,["src"])):(i(),p(k,{key:1,icon:"ri-user-line",size:"small"}))]}),_:1}),v("span",et,w(y.value),1),e(k,{icon:"ri-arrow-down-s-line",size:"x-small",class:"ms-1"})]),_:2},1040)]),default:s(()=>[e(le,{density:"compact"},{default:s(()=>[e(E,{"prepend-icon":"ri-user-settings-line",title:"الملف الشخصي",to:"/profile"}),e(E,{"prepend-icon":"ri-settings-3-line",title:"الإعدادات",to:"/settings"}),e(F,{class:"my-1"}),e(E,{"prepend-icon":"ri-logout-box-line",title:"تسجيل الخروج",onClick:l,class:"text-error"})]),_:1})]),_:1})]),_:1}),e(xe,{class:"main-content"},{default:s(()=>[v("div",tt,[e(Q,{fluid:"",class:"py-1 px-6"},{default:s(()=>[e(ke,{items:m.value,class:"pa-0 text-caption"},{divider:s(()=>[e(k,{icon:"ri-arrow-left-s-line",size:"small"})]),_:1},8,["items"])]),_:1})]),e(Q,{fluid:"",class:"pa-6"},{default:s(()=>[e(r,null,{default:s(({Component:A})=>[e(ie,{name:"page",mode:"out-in"},{default:s(()=>[(i(),p(we(A)))]),_:2},1024)]),_:1})]),_:1})]),_:1})],64)}}},rt=K(it,[["__scopeId","data-v-4d13416a"]]);export{rt as default};
