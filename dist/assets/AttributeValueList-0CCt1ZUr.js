import{r as l,x as U,J as $,c as j,a as s,b as n,t as b,w as u,S as L,o as T,l as y,i as F,j as G}from"./index-CuR9-sbN.js";import{u as k}from"./useApi-CjhFmPue.js";import{A as J}from"./AppDataTable-CnA5lOqV.js";import{A}from"./AppDialog-vLCI3uF9.js";import{_ as E}from"./AppButton-CREzoRf6.js";import{_ as X}from"./AppInput-06Y7zOXl.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const q={class:"attribute-values-page"},z={class:"mb-6 px-6 pt-6 d-flex align-center justify-space-between"},H={class:"d-flex align-center mb-1"},K={class:"text-h4 font-weight-bold"},O={class:"px-6 pb-6"},P={class:"font-weight-bold text-primary"},oe={__name:"AttributeValueList",setup(Q){const _=L().params.id,d=k(`/api/attributes/${_}/values`),B=k("/api/attributes"),h=l(null),w=l([]),m=l(!1),r=l(!1),c=l(!1),o=l(null),v=l(!1),f=l(!1),x=l(null),i=l({name:""}),p=U(()=>{var e;return!!((e=o.value)!=null&&e.id)}),C=[{title:"القيمة",key:"name"},{title:"تاريخ الإضافة",key:"created_at"},{title:"الإجراءات",key:"actions",sortable:!1,align:"end"}],M=async()=>{try{const e=await B.getById(_);h.value=e.data}catch(e){console.error("Error fetching attribute:",e)}},g=async()=>{m.value=!0;try{const e=await d.get();w.value=e.data||[]}catch(e){console.error("Error fetching values:",e)}finally{m.value=!1}},S=()=>{o.value=null,i.value={name:""},r.value=!0},I=e=>{o.value=e,i.value={name:e.name},r.value=!0},N=e=>{o.value=e,c.value=!0},V=async()=>{const{valid:e}=await x.value.validate();if(e){v.value=!0;try{p.value?await d.update(o.value.id,i.value,{successMessage:"تم التحديث بنجاح"}):await d.create(i.value,{successMessage:"تم الإضافة بنجاح"}),r.value=!1,g()}finally{v.value=!1}}},R=async()=>{f.value=!0;try{await d.remove(o.value.id,{successMessage:"تم الحذف بنجاح"}),c.value=!1,g()}finally{f.value=!1}};return $(()=>{M(),g()}),(e,t)=>{var D;return T(),j("div",q,[s("div",z,[s("div",null,[s("div",H,[n(E,{icon:"ri-arrow-right-line",variant:"text",color:"grey",class:"me-2",to:"/attributes"}),s("h1",K,"قيم الخاصية: "+b(((D=h.value)==null?void 0:D.name)||"..."),1)]),t[3]||(t[3]=s("p",{class:"text-body-1 text-grey ms-10"},"إدارة القيم المتاحة لهذه الخاصية لاستخدامها في المنتجات",-1))]),n(E,{"prepend-icon":"ri-add-line",onClick:S},{default:u(()=>t[4]||(t[4]=[y(" إضافة قيمة جديدة ")])),_:1})]),s("div",O,[n(J,{title:"قيم الخاصية",icon:"ri-list-check",headers:C,items:w.value,loading:m.value,onEdit:I,onDelete:N},{"item.name":u(({item:a})=>[s("div",P,b(a.name),1)]),_:1},8,["items","loading"])]),n(A,{modelValue:r.value,"onUpdate:modelValue":t[1]||(t[1]=a=>r.value=a),title:p.value?"تعديل القيمة":"إضافة قيمة جديدة",icon:p.value?"ri-edit-line":"ri-add-line",loading:v.value,onConfirm:V},{default:u(()=>[n(F,{ref_key:"formRef",ref:x,onSubmit:G(V,["prevent"])},{default:u(()=>[n(X,{modelValue:i.value.name,"onUpdate:modelValue":t[0]||(t[0]=a=>i.value.name=a),label:"اسم القيمة *",placeholder:"مثال: أحمر، XL، 128GB",rules:[a=>!!a||"مطلوب"]},null,8,["modelValue","rules"])]),_:1},512)]),_:1},8,["modelValue","title","icon","loading"]),n(A,{modelValue:c.value,"onUpdate:modelValue":t[2]||(t[2]=a=>c.value=a),title:"تأكيد الحذف",icon:"ri-delete-bin-line","confirm-color":"error","confirm-text":"حذف",loading:f.value,onConfirm:R},{default:u(()=>{var a;return[t[5]||(t[5]=y(' هل أنت متأكد من حذف القيمة "')),s("strong",null,b((a=o.value)==null?void 0:a.name),1),t[6]||(t[6]=y('"؟ '))]}),_:1},8,["modelValue","loading"])])}}};export{oe as default};
