import{n as N}from"./navigation-Bi0sk9Vp.js";import{a as q,r as U,z as $,L as W,x as k,w as o,V as X,aO as B,o as n,d as t,a7 as M,i as y,b as r,P as w,D as S,n as u,v as f,H as h,N as E,O as C,a3 as L,R as O,c as i,aH as G,F,j,E as x,G as Z,h as z,ak as ee,aJ as te,aI as le,a8 as A,Q as ae,a4 as oe,A as se}from"./index-B0c0aplS.js";const ne={class:"text-right d-flex align-center gap-4"},re={key:0},ie={class:"pa-3 d-flex align-center bg-grey-lighten-5"},ce={class:"font-weight-bold text-subtitle-1"},de={class:"d-flex align-center gap-2"},ue={key:0,class:"text-caption text-grey-darken-1 bg-amber-lighten-5 px-3 py-1 rounded-pill border border-amber-lighten-4 max-w-200 text-truncate"},ge={class:"d-flex align-center gap-2"},pe={class:"d-flex align-center gap-2"},ve={key:0,class:"text-caption text-grey-darken-1 bg-amber-lighten-5 px-2 py-0 rounded border border-amber-lighten-4 max-w-150 text-truncate"},fe={key:1,class:"mt-8"},xe={class:"d-flex align-center gap-2 mb-4 px-2"},ye={class:"pa-3 d-flex align-center bg-grey-lighten-5"},ke={class:"font-weight-bold text-subtitle-1 text-grey text-decoration-line-through opacity-50"},he={class:"d-flex align-center gap-2"},me={key:0,class:"text-caption text-grey-darken-1 bg-amber-lighten-5 px-3 py-1 rounded-pill border border-amber-lighten-4 max-w-200 text-truncate"},be={key:0,class:"text-center pa-12"},_e={class:"d-flex justify-center mt-6"},Ve={__name:"TestingChecklist",setup(we){const g=U({}),b=U(!0),c=U({show:!1,title:"",key:"",text:""}),p=l=>l.to||`group-${l.title}`,J=$(()=>{const l=K(),e=l.length;if(e===0)return 0;const a=l.filter(s=>{var m;return(m=g.value[s])==null?void 0:m.checked}).length;return Math.round(a/e*100)}),K=()=>{const l=[];return N.forEach(e=>{l.push(p(e)),e.children&&e.children.forEach(a=>{l.push(p(a))})}),l},I=$(()=>N.filter(l=>!v(l))),_=$(()=>N.filter(l=>v(l))),Q=l=>l?[...l].sort((e,a)=>{const s=v(e),m=v(a);return s===m?0:s?1:-1}):[],V=l=>g.value[l]||{checked:!1,note:""},v=l=>{const e=p(l);return V(e).checked},d=l=>{const e=p(l);return V(e).note||""},P=async()=>{b.value=!0;try{const l=await B.get("/dev/testing-checklist");g.value=l.data||{}}catch(l){console.error("Failed to fetch testing checklist",l)}finally{b.value=!1}},H=async()=>{try{await B.post("/dev/testing-checklist",g.value)}catch(l){console.error("Failed to save testing checklist",l)}},T=l=>{const e=p(l),a=V(e);g.value={...g.value,[e]:{...a,checked:!a.checked}},H()},D=l=>{const e=p(l);c.value={show:!0,title:l.title,key:e,text:d(l)}},R=()=>{const l=c.value.key,e=V(l);g.value={...g.value,[l]:{...e,note:c.value.text.trim()}},H(),c.value.show=!1},Y=async()=>{confirm("هل أنت متأكد من مسح كافة علامات التقدم والملاحظات من الباك إند؟")&&(g.value={},await B.post("/dev/testing-checklist",{}))};return W(()=>{P()}),(l,e)=>(n(),k(X,{fluid:"",class:"pa-6"},{default:o(()=>[t(z,{class:"rounded-xl border border-grey-lighten-4 elevation-sm overflow-hidden"},{default:o(()=>[t(M,{class:"pa-6 d-flex align-center gap-3 bg-grey-lighten-5"},{default:o(()=>[t(y,{icon:"ri-checkbox-multiple-line",color:"primary",size:"28"}),e[4]||(e[4]=r("div",null,[r("h2",{class:"text-h5 font-weight-bold"},"قائمة فحص النظام"),r("p",{class:"text-caption text-grey-darken-1 mb-0"},"تابع تقدم اختبار موديولات النظام")],-1)),t(w),r("div",ne,[t(S,{color:"primary",variant:"flat",size:"small",class:"font-weight-bold px-4"},{default:o(()=>[u(" تم إنجاز: "+f(J.value)+"% ",1)]),_:1}),t(h,{icon:"ri-refresh-line",variant:"text",size:"small",loading:b.value,onClick:P},{default:o(()=>[t(E,{activator:"parent",location:"top"},{default:o(()=>e[3]||(e[3]=[u("تحديث البيانات")])),_:1})]),_:1},8,["loading"])])]),_:1}),t(C),b.value?(n(),k(L,{key:1,class:"text-center pa-12"},{default:o(()=>[t(Z,{indeterminate:"",color:"primary"}),e[11]||(e[11]=r("p",{class:"text-grey mt-4"},"جاري تحميل البيانات من الباك إند...",-1))]),_:1})):(n(),k(L,{key:0,class:"pa-6"},{default:o(()=>[t(O,{class:"pa-0"},{default:o(()=>[I.value.length>0?(n(),i("div",re,[t(G,{group:""},{default:o(()=>[(n(!0),i(F,null,j(I.value,a=>(n(),i("div",{key:p(a)},[t(z,{variant:"flat",border:"",class:"mb-4 rounded-lg overflow-hidden border-grey-lighten-3 transition-all"},{default:o(()=>[r("div",ie,[t(A,{"model-value":v(a),"onUpdate:modelValue":s=>T(a),color:"success",class:"flex-grow-0"},null,8,["model-value","onUpdate:modelValue"]),t(y,{icon:a.icon,size:"20",class:"me-3",color:"grey-darken-2"},null,8,["icon"]),r("span",ce,f(a.title),1),t(w),r("div",de,[d(a)?(n(),i("div",ue,f(d(a)),1)):x("",!0),t(h,{icon:"ri-sticky-note-line",variant:"text",size:"small",color:d(a)?"amber-darken-1":"grey",onClick:s=>D(a)},{default:o(()=>[t(E,{activator:"parent",location:"top"},{default:o(()=>e[5]||(e[5]=[u("ملاحظات")])),_:1})]),_:2},1032,["color","onClick"])])]),a.children?(n(),k(O,{key:0,class:"py-0"},{default:o(()=>[t(C),(n(!0),i(F,null,j(Q(a.children),s=>(n(),k(ae,{key:p(s),density:"compact",class:"ps-10 border-b border-grey-lighten-4 ripple-0"},{prepend:o(()=>[t(A,{"model-value":v(s),"onUpdate:modelValue":m=>T(s),color:"success",class:"flex-grow-0"},null,8,["model-value","onUpdate:modelValue"])]),default:o(()=>[t(oe,{class:"text-body-2 d-flex align-center justify-space-between w-100"},{default:o(()=>[r("div",ge,[s.icon?(n(),k(y,{key:0,icon:s.icon,size:"16",color:"grey"},null,8,["icon"])):x("",!0),r("span",{class:se({"text-grey text-decoration-line-through opacity-50":v(s)})},f(s.title),3)]),r("div",pe,[d(s)?(n(),i("div",ve,f(d(s)),1)):x("",!0),t(h,{icon:"ri-sticky-note-2-line",variant:"text",size:"x-small",color:d(s)?"amber-darken-1":"grey-lighten-1",onClick:m=>D(s)},null,8,["color","onClick"]),v(s)?(n(),k(y,{key:1,icon:"ri-check-line",color:"success",size:"18"})):x("",!0)])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)):x("",!0)]),_:2},1024)]))),128))]),_:1})])):x("",!0),_.value.length>0?(n(),i("div",fe,[t(C,{class:"mb-6"}),r("div",xe,[t(y,{icon:"ri-checkbox-circle-fill",color:"success",size:"20"}),e[6]||(e[6]=r("h3",{class:"text-subtitle-1 font-weight-black text-success"},"الموديولات المكتملة",-1)),t(S,{size:"x-small",color:"success",variant:"tonal",class:"ms-2"},{default:o(()=>[u(f(_.value.length),1)]),_:1})]),t(G,{group:""},{default:o(()=>[(n(!0),i(F,null,j(_.value,a=>(n(),i("div",{key:p(a)},[t(z,{variant:"flat",border:"",class:"mb-4 rounded-lg overflow-hidden border-grey-lighten-3 transition-all checklist-item-checked"},{default:o(()=>[r("div",ye,[t(A,{"model-value":v(a),"onUpdate:modelValue":s=>T(a),color:"success",class:"flex-grow-0"},null,8,["model-value","onUpdate:modelValue"]),t(y,{icon:a.icon,size:"20",class:"me-3",color:"grey-darken-2"},null,8,["icon"]),r("span",ke,f(a.title),1),t(w),r("div",he,[d(a)?(n(),i("div",me,f(d(a)),1)):x("",!0),t(h,{icon:"ri-sticky-note-line",variant:"text",size:"small",color:d(a)?"amber-darken-1":"grey",onClick:s=>D(a)},{default:o(()=>[t(E,{activator:"parent",location:"top"},{default:o(()=>e[7]||(e[7]=[u("ملاحظات")])),_:1})]),_:2},1032,["color","onClick"]),t(S,{size:"x-small",color:"success",variant:"tonal",class:"rounded"},{default:o(()=>e[8]||(e[8]=[u("تم الفحص")])),_:1})])])]),_:2},1024)]))),128))]),_:1})])):x("",!0)]),_:1}),I.value.length===0&&_.value.length===0?(n(),i("div",be,[t(y,{icon:"ri-inbox-line",size:"64",color:"grey-lighten-2"}),e[9]||(e[9]=r("p",{class:"text-grey mt-4"},"لا توجد موديولات مبرمجة حالياً",-1))])):x("",!0),r("div",_e,[t(h,{variant:"text",color:"error","prepend-icon":"ri-refresh-line",size:"small",onClick:Y},{default:o(()=>e[10]||(e[10]=[u(" إعادة تعيين كافة التقدم (سيتم مسح الملف من الباك إند) ")])),_:1})])]),_:1}))]),_:1}),t(le,{modelValue:c.value.show,"onUpdate:modelValue":e[2]||(e[2]=a=>c.value.show=a),"max-width":"500px"},{default:o(()=>[t(z,{class:"rounded-xl overflow-hidden"},{default:o(()=>[t(M,{class:"pa-4 bg-primary text-white d-flex align-center gap-2"},{default:o(()=>[t(y,{icon:"ri-sticky-note-line"}),u(" ملاحظات: "+f(c.value.title),1)]),_:1}),t(L,{class:"pa-4"},{default:o(()=>[t(ee,{modelValue:c.value.text,"onUpdate:modelValue":e[0]||(e[0]=a=>c.value.text=a),placeholder:"اكتب ملاحظاتك هنا...",variant:"outlined","auto-grow":"",rows:"4",class:"rounded-lg",color:"primary","hide-details":""},null,8,["modelValue"])]),_:1}),t(C),t(te,{class:"pa-4"},{default:o(()=>[t(w),t(h,{variant:"text",color:"grey-darken-1",onClick:e[1]||(e[1]=a=>c.value.show=!1),class:"px-4"},{default:o(()=>e[12]||(e[12]=[u(" إلغاء ")])),_:1}),t(h,{variant:"flat",color:"primary",onClick:R,class:"px-6 rounded-lg font-weight-bold"},{default:o(()=>e[13]||(e[13]=[u(" حفظ الملاحظة ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},Ie=q(Ve,[["__scopeId","data-v-58efea6a"]]);export{Ie as default};
