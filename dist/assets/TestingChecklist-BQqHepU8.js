import{n as N}from"./navigation-BXqiVAI0.js";import{a as J,r as U,z as $,L as W,x as k,w as s,V as X,aG as B,o as n,d as t,a6 as M,i as y,b as r,P as w,D as S,n as u,v as f,H as h,N as E,O as C,a3 as F,R as H,c as i,aF as K,F as L,j,E as x,G as Z,h as z,ai as ee,ar as te,as as le,a7 as A,Q as ae,a4 as se,A as oe}from"./index-Flp88uEA.js";const ne={class:"text-right d-flex align-center gap-4"},re={key:0},ie={class:"pa-3 d-flex align-center bg-grey-lighten-5"},ce={class:"font-weight-bold text-subtitle-1"},de={class:"d-flex align-center gap-2"},ue={key:0,class:"text-caption text-grey-darken-1 bg-amber-lighten-5 px-3 py-1 rounded-pill border border-amber-lighten-4 max-w-200 text-truncate"},ge={class:"d-flex align-center gap-2"},pe={class:"d-flex align-center gap-2"},ve={key:0,class:"text-caption text-grey-darken-1 bg-amber-lighten-5 px-2 py-0 rounded border border-amber-lighten-4 max-w-150 text-truncate"},fe={key:1,class:"mt-8"},xe={class:"d-flex align-center gap-2 mb-4 px-2"},ye={class:"pa-3 d-flex align-center bg-grey-lighten-5"},ke={class:"font-weight-bold text-subtitle-1 text-grey text-decoration-line-through opacity-50"},he={class:"d-flex align-center gap-2"},me={key:0,class:"text-caption text-grey-darken-1 bg-amber-lighten-5 px-3 py-1 rounded-pill border border-amber-lighten-4 max-w-200 text-truncate"},be={key:0,class:"text-center pa-12"},_e={class:"d-flex justify-center mt-6"},Ve={__name:"TestingChecklist",setup(we){const g=U({}),b=U(!0),c=U({show:!1,title:"",key:"",text:""}),p=l=>l.to||`group-${l.title}`,O=$(()=>{const l=Q(),e=l.length;if(e===0)return 0;const a=l.filter(o=>{var m;return(m=g.value[o])==null?void 0:m.checked}).length;return Math.round(a/e*100)}),Q=()=>{const l=[];return N.forEach(e=>{l.push(p(e)),e.children&&e.children.forEach(a=>{l.push(p(a))})}),l},T=$(()=>N.filter(l=>!v(l))),_=$(()=>N.filter(l=>v(l))),R=l=>l?[...l].sort((e,a)=>{const o=v(e),m=v(a);return o===m?0:o?1:-1}):[],V=l=>g.value[l]||{checked:!1,note:""},v=l=>{const e=p(l);return V(e).checked},d=l=>{const e=p(l);return V(e).note||""},P=async()=>{b.value=!0;try{const l=await B.get("/dev/testing-checklist");g.value=l.data||{}}catch(l){console.error("Failed to fetch testing checklist",l)}finally{b.value=!1}},G=async()=>{try{await B.post("/dev/testing-checklist",g.value)}catch(l){console.error("Failed to save testing checklist",l)}},I=l=>{const e=p(l),a=V(e);g.value={...g.value,[e]:{...a,checked:!a.checked}},G()},D=l=>{const e=p(l);c.value={show:!0,title:l.title,key:e,text:d(l)}},Y=()=>{const l=c.value.key,e=V(l);g.value={...g.value,[l]:{...e,note:c.value.text.trim()}},G(),c.value.show=!1},q=async()=>{confirm("هل أنت متأكد من مسح كافة علامات التقدم والملاحظات من الباك إند؟")&&(g.value={},await B.post("/dev/testing-checklist",{}))};return W(()=>{P()}),(l,e)=>(n(),k(X,{fluid:"",class:"pa-6"},{default:s(()=>[t(z,{class:"rounded-xl border border-grey-lighten-4 elevation-sm overflow-hidden"},{default:s(()=>[t(M,{class:"pa-6 d-flex align-center gap-3 bg-grey-lighten-5"},{default:s(()=>[t(y,{icon:"ri-checkbox-multiple-line",color:"primary",size:"28"}),e[4]||(e[4]=r("div",null,[r("h2",{class:"text-h5 font-weight-bold"},"قائمة فحص النظام"),r("p",{class:"text-caption text-grey-darken-1 mb-0"},"تابع تقدم اختبار موديولات النظام")],-1)),t(w),r("div",ne,[t(S,{color:"primary",variant:"flat",size:"small",class:"font-weight-bold px-4"},{default:s(()=>[u(" تم إنجاز: "+f(O.value)+"% ",1)]),_:1}),t(h,{icon:"ri-refresh-line",variant:"text",size:"small",loading:b.value,onClick:P},{default:s(()=>[t(E,{activator:"parent",location:"top"},{default:s(()=>e[3]||(e[3]=[u("تحديث البيانات")])),_:1})]),_:1},8,["loading"])])]),_:1}),t(C),b.value?(n(),k(F,{key:1,class:"text-center pa-12"},{default:s(()=>[t(Z,{indeterminate:"",color:"primary"}),e[11]||(e[11]=r("p",{class:"text-grey mt-4"},"جاري تحميل البيانات من الباك إند...",-1))]),_:1})):(n(),k(F,{key:0,class:"pa-6"},{default:s(()=>[t(H,{class:"pa-0"},{default:s(()=>[T.value.length>0?(n(),i("div",re,[t(K,{group:""},{default:s(()=>[(n(!0),i(L,null,j(T.value,a=>(n(),i("div",{key:p(a)},[t(z,{variant:"flat",border:"",class:"mb-4 rounded-lg overflow-hidden border-grey-lighten-3 transition-all"},{default:s(()=>[r("div",ie,[t(A,{"model-value":v(a),"onUpdate:modelValue":o=>I(a),color:"success",class:"flex-grow-0"},null,8,["model-value","onUpdate:modelValue"]),t(y,{icon:a.icon,size:"20",class:"me-3",color:"grey-darken-2"},null,8,["icon"]),r("span",ce,f(a.title),1),t(w),r("div",de,[d(a)?(n(),i("div",ue,f(d(a)),1)):x("",!0),t(h,{icon:"ri-sticky-note-line",variant:"text",size:"small",color:d(a)?"amber-darken-1":"grey",onClick:o=>D(a)},{default:s(()=>[t(E,{activator:"parent",location:"top"},{default:s(()=>e[5]||(e[5]=[u("ملاحظات")])),_:1})]),_:2},1032,["color","onClick"])])]),a.children?(n(),k(H,{key:0,class:"py-0"},{default:s(()=>[t(C),(n(!0),i(L,null,j(R(a.children),o=>(n(),k(ae,{key:p(o),density:"compact",class:"ps-10 border-b border-grey-lighten-4 ripple-0"},{prepend:s(()=>[t(A,{"model-value":v(o),"onUpdate:modelValue":m=>I(o),color:"success",class:"flex-grow-0"},null,8,["model-value","onUpdate:modelValue"])]),default:s(()=>[t(se,{class:"text-body-2 d-flex align-center justify-space-between w-100"},{default:s(()=>[r("div",ge,[o.icon?(n(),k(y,{key:0,icon:o.icon,size:"16",color:"grey"},null,8,["icon"])):x("",!0),r("span",{class:oe({"text-grey text-decoration-line-through opacity-50":v(o)})},f(o.title),3)]),r("div",pe,[d(o)?(n(),i("div",ve,f(d(o)),1)):x("",!0),t(h,{icon:"ri-sticky-note-2-line",variant:"text",size:"x-small",color:d(o)?"amber-darken-1":"grey-lighten-1",onClick:m=>D(o)},null,8,["color","onClick"]),v(o)?(n(),k(y,{key:1,icon:"ri-check-line",color:"success",size:"18"})):x("",!0)])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)):x("",!0)]),_:2},1024)]))),128))]),_:1})])):x("",!0),_.value.length>0?(n(),i("div",fe,[t(C,{class:"mb-6"}),r("div",xe,[t(y,{icon:"ri-checkbox-circle-fill",color:"success",size:"20"}),e[6]||(e[6]=r("h3",{class:"text-subtitle-1 font-weight-black text-success"},"الموديولات المكتملة",-1)),t(S,{size:"x-small",color:"success",variant:"tonal",class:"ms-2"},{default:s(()=>[u(f(_.value.length),1)]),_:1})]),t(K,{group:""},{default:s(()=>[(n(!0),i(L,null,j(_.value,a=>(n(),i("div",{key:p(a)},[t(z,{variant:"flat",border:"",class:"mb-4 rounded-lg overflow-hidden border-grey-lighten-3 transition-all checklist-item-checked"},{default:s(()=>[r("div",ye,[t(A,{"model-value":v(a),"onUpdate:modelValue":o=>I(a),color:"success",class:"flex-grow-0"},null,8,["model-value","onUpdate:modelValue"]),t(y,{icon:a.icon,size:"20",class:"me-3",color:"grey-darken-2"},null,8,["icon"]),r("span",ke,f(a.title),1),t(w),r("div",he,[d(a)?(n(),i("div",me,f(d(a)),1)):x("",!0),t(h,{icon:"ri-sticky-note-line",variant:"text",size:"small",color:d(a)?"amber-darken-1":"grey",onClick:o=>D(a)},{default:s(()=>[t(E,{activator:"parent",location:"top"},{default:s(()=>e[7]||(e[7]=[u("ملاحظات")])),_:1})]),_:2},1032,["color","onClick"]),t(S,{size:"x-small",color:"success",variant:"tonal",class:"rounded"},{default:s(()=>e[8]||(e[8]=[u("تم الفحص")])),_:1})])])]),_:2},1024)]))),128))]),_:1})])):x("",!0)]),_:1}),T.value.length===0&&_.value.length===0?(n(),i("div",be,[t(y,{icon:"ri-inbox-line",size:"64",color:"grey-lighten-2"}),e[9]||(e[9]=r("p",{class:"text-grey mt-4"},"لا توجد موديولات مبرمجة حالياً",-1))])):x("",!0),r("div",_e,[t(h,{variant:"text",color:"error","prepend-icon":"ri-refresh-line",size:"small",onClick:q},{default:s(()=>e[10]||(e[10]=[u(" إعادة تعيين كافة التقدم (سيتم مسح الملف من الباك إند) ")])),_:1})])]),_:1}))]),_:1}),t(le,{modelValue:c.value.show,"onUpdate:modelValue":e[2]||(e[2]=a=>c.value.show=a),"max-width":"500px"},{default:s(()=>[t(z,{class:"rounded-xl overflow-hidden"},{default:s(()=>[t(M,{class:"pa-4 bg-primary text-white d-flex align-center gap-2"},{default:s(()=>[t(y,{icon:"ri-sticky-note-line"}),u(" ملاحظات: "+f(c.value.title),1)]),_:1}),t(F,{class:"pa-4"},{default:s(()=>[t(ee,{modelValue:c.value.text,"onUpdate:modelValue":e[0]||(e[0]=a=>c.value.text=a),placeholder:"اكتب ملاحظاتك هنا...",variant:"outlined","auto-grow":"",rows:"4",class:"rounded-lg",color:"primary","hide-details":""},null,8,["modelValue"])]),_:1}),t(C),t(te,{class:"pa-4"},{default:s(()=>[t(w),t(h,{variant:"text",color:"grey-darken-1",onClick:e[1]||(e[1]=a=>c.value.show=!1),class:"px-4"},{default:s(()=>e[12]||(e[12]=[u(" إلغاء ")])),_:1}),t(h,{variant:"flat",color:"primary",onClick:Y,class:"px-6 rounded-lg font-weight-bold"},{default:s(()=>e[13]||(e[13]=[u(" حفظ الملاحظة ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},Te=J(Ve,[["__scopeId","data-v-58efea6a"]]);export{Te as default};
