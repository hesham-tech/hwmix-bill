import{r as n,L as z,c as m,b as a,d as o,w as s,o as g,v as i,D as f,i as D,n as h,p as I}from"./index-a34Ydvtq.js";import{u as L}from"./useApi-DR0m7am6.js";import{A as N}from"./AppDataTable-u95EW4-x.js";import{_ as A}from"./AppButton-CLlOdaZ_.js";import"./usePermissions-CTYSXYZg.js";const B={class:"installment-plans-page"},E={class:"px-6 pb-6"},S={key:0,class:"d-flex flex-column"},$={class:"font-weight-bold text-primary"},G={class:"text-caption text-grey"},T={key:1,class:"text-grey-lighten-1"},U={class:"font-weight-black text-h6"},j={class:"d-flex justify-end"},K={__name:"InstallmentPlanList",setup(F){const y=I(),x=L("/api/installment-plans"),v=n([]),r=n(!1),_=n(0),c=n(1),d=n(10),b=[{title:"الفاتورة",key:"invoice"},{title:"المبلغ الإجمالي",key:"total_amount",align:"end"},{title:"عدد الأقساط",key:"installments_count"},{title:"الحالة",key:"status"},{title:"الإجراءات",key:"actions",sortable:!1,align:"end"}],k=e=>e?new Intl.NumberFormat("ar-EG",{style:"currency",currency:"EGP"}).format(e):"0.00 ج.م",w=e=>({active:"success",completed:"info",cancelled:"error"})[e]||"grey",P=e=>({active:"نشط",completed:"مكتمل",cancelled:"ملغي"})[e]||e,C=e=>{y.push(`/installments/${e.id}`)},u=async()=>{r.value=!0;try{const e=await x.get({page:c.value,per_page:d.value},{showLoading:!1});v.value=e.data||[],_.value=e.total||0}finally{r.value=!1}},V=e=>{d.value=e,c.value=1,u()};return z(u),(e,l)=>(g(),m("div",B,[l[1]||(l[1]=a("div",{class:"mb-6 px-6 pt-6"},[a("h1",{class:"text-h4 font-weight-bold"},"خطط التقسيط"),a("p",{class:"text-body-1 text-grey"},"متابعة وإدارة جدول تحصيل الأقساط والمدفوعات الآجلة")],-1)),a("div",E,[o(N,{headers:b,items:v.value,loading:r.value,"items-length":_.value,"items-per-page":d.value,page:c.value,title:"سجل خطط التقسيط",icon:"ri-calendar-schedule-line","onUpdate:page":l[0]||(l[0]=t=>{c.value=t,u()}),"onUpdate:itemsPerPage":V},{"item.invoice":s(({item:t})=>{var p;return[t.invoice?(g(),m("div",S,[a("span",$,"فاتورة #"+i(t.invoice.invoice_number),1),a("span",G,"العميل: "+i(((p=t.invoice.customer)==null?void 0:p.name)||"غير معروف"),1)])):(g(),m("span",T,"غير مرتبط بفاتورة"))]}),"item.total_amount":s(({item:t})=>[a("div",U,i(k(t.total_amount)),1)]),"item.installments_count":s(({item:t})=>[o(f,{size:"small",variant:"flat",color:"secondary-lighten-5",class:"text-secondary font-weight-bold"},{default:s(()=>[o(D,{icon:"ri-grid-line",size:"14",class:"me-1"}),h(" "+i(t.installments_count)+" قسط ",1)]),_:2},1024)]),"item.status":s(({item:t})=>[o(f,{color:w(t.status),size:"small",variant:"flat",class:"font-weight-bold px-3"},{default:s(()=>[h(i(P(t.status)),1)]),_:2},1032,["color"])]),"item.actions":s(({item:t})=>[a("div",j,[o(A,{icon:"ri-eye-line",size:"x-small",variant:"text",color:"info",tooltip:"عرض التفاصيل",onClick:p=>C(t)},null,8,["onClick"])])]),_:1},8,["items","loading","items-length","items-per-page","page"])])]))}};export{K as default};
