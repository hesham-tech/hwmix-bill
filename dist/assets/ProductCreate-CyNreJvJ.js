import{a as E,z as K,o as x,c as A,d as e,w as l,b as o,B as j,i as S,e as B,f as _,am as U,D as T,n as $,ai as oe,h as z,r as v,A as fe,l as L,x as I,F as G,j as O,an as ve,M as R,C as ge,H as k,E as D,ao as q,ap as re,aq as W,a6 as H,a3 as J,k as X,ar as Y,P as Z,as as ee,at as ne,v as Q,ag as be,au as ie,av as Ve,K as se,Q as ye,a4 as xe,a5 as we,L as he,p as _e,U as ke}from"./index-Flp88uEA.js";import{u as $e}from"./useProductsData-Dz62C_rp.js";import{u as N}from"./useApi-Dl4iYKvS.js";import{c as Ue,b as Ce}from"./brand.service-B99HMbY7.js";const Ae={class:"product-general-info"},ze={class:"d-flex align-center gap-3 mb-6"},Se={class:"d-flex align-center justify-space-between mb-2 px-1"},Pe={__name:"ProductGeneral",props:{modelValue:{type:Object,required:!0}},emits:["update:modelValue"],setup(w,{emit:h}){const V=w,c=h,t=K({get:()=>V.modelValue,set:m=>c("update:modelValue",m)});return(m,n)=>(x(),A("div",Ae,[e(z,{variant:"flat",class:"pa-4 pa-md-6 rounded-xl border bg-white mb-6"},{default:l(()=>[o("div",ze,[e(j,{color:"info-lighten-5",rounded:"lg"},{default:l(()=>[e(S,{icon:"ri-information-line",color:"info"})]),_:1}),n[4]||(n[4]=o("h3",{class:"text-subtitle-1 font-weight-black"},"المعلومات الأساسية",-1))]),e(B,{dense:""},{default:l(()=>[e(_,{cols:"12"},{default:l(()=>[e(U,{modelValue:t.value.name,"onUpdate:modelValue":n[0]||(n[0]=i=>t.value.name=i),label:"اسم المنتج",placeholder:"مثال: آيفون 15 برو ماكس",variant:"solo",flat:"","bg-color":"grey-lighten-5",class:"premium-input-field",rules:[i=>!!i||"اسم المنتج مطلوب"],"persistent-placeholder":""},null,8,["modelValue","rules"])]),_:1}),e(_,{cols:"12",md:"6"},{default:l(()=>[e(U,{modelValue:t.value.sku,"onUpdate:modelValue":n[1]||(n[1]=i=>t.value.sku=i),label:"SKU (كود المنتج)",placeholder:"اتركه فارغاً للتوليد التلقائي",variant:"solo",flat:"","bg-color":"grey-lighten-5",class:"premium-input-field","persistent-placeholder":""},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",md:"6"},{default:l(()=>[e(U,{modelValue:t.value.barcode,"onUpdate:modelValue":n[2]||(n[2]=i=>t.value.barcode=i),label:"الباركود (Barcode)",placeholder:"رقم الباركود العالمي",variant:"solo",flat:"","bg-color":"grey-lighten-5",class:"premium-input-field","persistent-placeholder":""},null,8,["modelValue"])]),_:1}),e(_,{cols:"12"},{default:l(()=>[o("div",Se,[n[6]||(n[6]=o("span",{class:"text-subtitle-2 font-weight-bold"},"وصف المنتج",-1)),e(T,{size:"x-small",color:"grey",variant:"tonal"},{default:l(()=>n[5]||(n[5]=[$("يدعم التنسيق الغني")])),_:1})]),e(oe,{modelValue:t.value.desc,"onUpdate:modelValue":n[3]||(n[3]=i=>t.value.desc=i),placeholder:"اكتب وصفاً جذاباً للمنتج...",variant:"solo",flat:"","bg-color":"grey-lighten-5",class:"premium-input-field",rows:"4","auto-grow":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]))}},Ie=E(Pe,[["__scopeId","data-v-3b6788b2"]]),je={class:"product-media-manager overflow-hidden"},Be={key:0,class:"overlay-actions d-flex align-center justify-center gap-2"},De={key:2,class:"drag-handle"},Ee={__name:"ProductMedia",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(w,{emit:h}){const V=w,c=h,t=v(!1),m=v([...V.modelValue]),n=s=>{t.value=!1;const a=Array.from(s.dataTransfer.files);p(a)},i=s=>{const a=Array.from(s.target.files);p(a)},p=s=>{const a=s.filter(b=>b.type.startsWith("image/")).map(b=>({file:b,preview:URL.createObjectURL(b),id:Math.random().toString(36).substr(2,9)}));m.value=[...m.value,...a],c("update:modelValue",m.value)},r=s=>{m.value.splice(s,1),c("update:modelValue",m.value)},d=s=>{const a=m.value.splice(s,1)[0];m.value.unshift(a),c("update:modelValue",m.value)};return(s,a)=>(x(),A("div",je,[o("div",{class:fe(["upload-zone pa-8 rounded-xl border-dashed border-2 text-center transition-all",{"border-primary bg-primary-lighten-5 scale-98":t.value}]),onDragover:a[0]||(a[0]=L(b=>t.value=!0,["prevent"])),onDragleave:a[1]||(a[1]=L(b=>t.value=!1,["prevent"])),onDrop:L(n,["prevent"]),onClick:a[2]||(a[2]=b=>s.$refs.fileInput.click())},[o("input",{ref:"fileInput",type:"file",multiple:"",accept:"image/*",class:"d-none",onChange:i},null,544),e(j,{size:"64",color:"primary-lighten-5",class:"mb-4"},{default:l(()=>[e(S,{icon:"ri-upload-cloud-2-line",color:"primary",size:"32"})]),_:1}),a[4]||(a[4]=o("h3",{class:"text-h6 font-weight-black mb-1"},"اسحب وأفلت صور المنتج هنا",-1)),a[5]||(a[5]=o("p",{class:"text-body-2 text-grey-darken-1"},"أو اضغط لاختيار ملفات من جهازك (يدعم JPG, PNG, WebP)",-1)),e(T,{size:"small",variant:"tonal",color:"primary",class:"mt-2 text-caption"},{default:l(()=>a[3]||(a[3]=[$(" يسع حتى 10 صور بدقة عالية ")])),_:1})],34),m.value.length?(x(),I(B,{key:0,class:"mt-6",dense:""},{default:l(()=>[(x(!0),A(G,null,O(m.value,(b,u)=>(x(),I(_,{key:b.id||u,cols:"6",sm:"4",md:"3",lg:"2"},{default:l(()=>[e(ve,null,{default:l(({isHovering:f,props:y})=>[e(z,R({ref_for:!0},y,{class:["media-item-card rounded-xl overflow-hidden elevation-1 relative",{"is-primary":u===0}]}),{default:l(()=>[e(ge,{src:b.preview||b.url,"aspect-ratio":"1",cover:""},{default:l(()=>[f?(x(),A("div",Be,[e(k,{icon:"ri-delete-bin-line",color:"error",size:"x-small",variant:"flat",onClick:L(g=>r(u),["stop"])},null,8,["onClick"]),u!==0?(x(),I(k,{key:0,icon:"ri-star-line",color:"primary",size:"x-small",variant:"flat",title:"تعيين كصورة أساسية",onClick:L(g=>d(u),["stop"])},null,8,["onClick"])):D("",!0)])):D("",!0),u===0?(x(),I(T,{key:1,size:"x-small",color:"primary",variant:"flat",class:"primary-label px-2"},{default:l(()=>a[6]||(a[6]=[$(" الأساسية ")])),_:1})):D("",!0),f?(x(),A("div",De,[e(S,{icon:"ri-drag-move-2-line",color:"white",size:"18"})])):D("",!0)]),_:2},1032,["src"])]),_:2},1040,["class"])]),_:2},1024)]),_:2},1024))),128))]),_:1})):D("",!0)]))}},Me=E(Ee,[["__scopeId","data-v-74c0c5b5"]]),Le={class:"product-pricing-inventory"},Te={class:"d-flex align-center gap-3 mb-6"},Re={class:"d-flex align-center gap-3 mb-6"},Fe={__name:"ProductPricing",props:{modelValue:{type:Object,required:!0},warehouses:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(w,{emit:h}){const V=w,c=h,t=K({get:()=>V.modelValue,set:m=>c("update:modelValue",m)});return(m,n)=>(x(),A("div",Le,[e(B,null,{default:l(()=>[e(_,{cols:"12",md:"6"},{default:l(()=>[e(z,{variant:"flat",class:"pa-4 pa-md-6 rounded-xl border bg-white h-100"},{default:l(()=>[o("div",Te,[e(j,{color:"primary-lighten-5",rounded:"lg"},{default:l(()=>[e(S,{icon:"ri-money-dollar-circle-line",color:"primary"})]),_:1}),n[6]||(n[6]=o("h3",{class:"text-subtitle-1 font-weight-black"},"إعدادات التسعير",-1))]),e(B,{dense:""},{default:l(()=>[e(_,{cols:"12",sm:"6"},{default:l(()=>[e(U,{modelValue:t.value.retail_price,"onUpdate:modelValue":n[0]||(n[0]=i=>t.value.retail_price=i),modelModifiers:{number:!0},label:"سعر البيع (قطاعي)",prefix:"ج.م",variant:"solo",flat:"","bg-color":"grey-lighten-5",class:"premium-input-field",type:"number","persistent-placeholder":""},null,8,["modelValue"])]),_:1}),e(_,{cols:"12",sm:"6"},{default:l(()=>[e(U,{modelValue:t.value.wholesale_price,"onUpdate:modelValue":n[1]||(n[1]=i=>t.value.wholesale_price=i),modelModifiers:{number:!0},label:"سعر البيع (جمله)",prefix:"ج.م",variant:"solo",flat:"","bg-color":"grey-lighten-5",class:"premium-input-field",type:"number","persistent-placeholder":""},null,8,["modelValue"])]),_:1}),e(_,{cols:"12"},{default:l(()=>[e(U,{modelValue:t.value.tax,"onUpdate:modelValue":n[2]||(n[2]=i=>t.value.tax=i),modelModifiers:{number:!0},label:"الضريبة المفروضة",suffix:"%",variant:"solo",flat:"","bg-color":"grey-lighten-5",class:"premium-input-field",type:"number","persistent-placeholder":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(_,{cols:"12",md:"6"},{default:l(()=>[e(z,{variant:"flat",class:"pa-4 pa-md-6 rounded-xl border bg-white h-100"},{default:l(()=>[o("div",Re,[e(j,{color:"warning-lighten-5",rounded:"lg"},{default:l(()=>[e(S,{icon:"ri-home-gear-line",color:"warning"})]),_:1}),n[7]||(n[7]=o("h3",{class:"text-subtitle-1 font-weight-black"},"المخزون واللوجستيات",-1))]),e(B,{dense:""},{default:l(()=>[e(_,{cols:"12"},{default:l(()=>[e(q,{modelValue:t.value.warehouse_id,"onUpdate:modelValue":n[3]||(n[3]=i=>t.value.warehouse_id=i),items:w.warehouses,"item-title":"name","item-value":"id",label:"المخزن الافتراضي",variant:"solo",flat:"","bg-color":"grey-lighten-5",class:"premium-input-field"},null,8,["modelValue","items"])]),_:1}),e(_,{cols:"6"},{default:l(()=>[e(U,{modelValue:t.value.min_quantity,"onUpdate:modelValue":n[4]||(n[4]=i=>t.value.min_quantity=i),modelModifiers:{number:!0},label:"الحد الأدنى",variant:"solo",flat:"","bg-color":"grey-lighten-5",class:"premium-input-field",type:"number",hint:"تنبيه عند نقص الكمية","container-class":"pb-0"},null,8,["modelValue"])]),_:1}),e(_,{cols:"6"},{default:l(()=>[e(U,{modelValue:t.value.weight,"onUpdate:modelValue":n[5]||(n[5]=i=>t.value.weight=i),modelModifiers:{number:!0},label:"الوزن (كجم)",variant:"solo",flat:"","bg-color":"grey-lighten-5",class:"premium-input-field",type:"number"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]))}},Ne=E(Fe,[["__scopeId","data-v-47b92f26"]]);class qe extends re{constructor(){super("attributes")}async toggle(h){return this.apiClient.patch(`${this.resource}/${h}/toggle`)}}const Ge=new qe,Oe={__name:"QuickAddAttribute",emits:["saved"],setup(w,{emit:h}){const V=h,c=v(!1),t=v(!1),m=v(!1),n=v(null),i=v(""),p=v(""),r=async()=>{const{valid:d}=await n.value.validate();if(d){t.value=!0;try{const s={name:i.value,name_en:p.value,active:1},a=await Ge.create(s,{showToast:!0});a.status&&(V("saved",a.data[0]),c.value=!1,i.value="",p.value="")}finally{t.value=!1}}};return(d,s)=>(x(),I(ee,{modelValue:c.value,"onUpdate:modelValue":s[4]||(s[4]=a=>c.value=a),"max-width":"500px"},{activator:l(({props:a})=>[W(d.$slots,"activator",{props:a},()=>[e(k,R({icon:"ri-add-line",size:"small",variant:"text",color:"primary"},a),null,16)])]),default:l(()=>[e(z,{rounded:"xl",class:"pa-4"},{default:l(()=>[e(H,{class:"d-flex align-center gap-2"},{default:l(()=>[e(j,{color:"primary-lighten-5",rounded:"lg",size:"40"},{default:l(()=>[e(S,{icon:"ri-settings-5-line",color:"primary"})]),_:1}),s[5]||(s[5]=o("span",{class:"font-weight-black"},"إضافة سمة جديدة",-1))]),_:1}),e(J,{class:"mt-4"},{default:l(()=>[e(X,{ref_key:"form",ref:n,modelValue:m.value,"onUpdate:modelValue":s[2]||(s[2]=a=>m.value=a)},{default:l(()=>[e(U,{modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=a=>i.value=a),label:"اسم السمة (AR)",placeholder:"مثال: اللون، المقاس، الخامة",variant:"solo-filled",flat:"",rounded:"lg",rules:[a=>!!a||"اسم السمة مطلوب"],autofocus:""},null,8,["modelValue","rules"]),e(U,{modelValue:p.value,"onUpdate:modelValue":s[1]||(s[1]=a=>p.value=a),label:"اسم السمة (EN)",placeholder:"e.g. Color, Size, Material",variant:"solo-filled",flat:"",rounded:"lg",class:"mt-2 text-left",dir:"ltr"},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),e(Y,{class:"pa-4"},{default:l(()=>[e(Z),e(k,{variant:"text",color:"grey",onClick:s[3]||(s[3]=a=>c.value=!1),disabled:t.value},{default:l(()=>s[6]||(s[6]=[$("إلغاء")])),_:1},8,["disabled"]),e(k,{color:"primary",variant:"flat",rounded:"lg",class:"px-6 font-weight-bold",loading:t.value,onClick:r},{default:l(()=>s[7]||(s[7]=[$(" حفظ السمة ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:3},8,["modelValue"]))}};class Qe extends re{constructor(){super("attribute-values")}}const Ke=new Qe,We={class:"product-variants-builder"},He={class:"variants-setup-glass pa-6 rounded-xl border mb-6"},Je={class:"d-flex align-center justify-space-between mb-6"},Xe={key:0,class:"text-center mt-6"},Ye={key:0,class:"variants-matrix mt-8"},Ze={class:"d-flex align-center justify-space-between mb-4 px-2"},el={class:"text-subtitle-1 font-weight-black"},ll={class:"d-flex gap-2"},al={class:"glass-table-wrapper rounded-xl border overflow-hidden"},tl={class:"font-weight-bold"},sl={class:"d-flex align-center gap-2"},ol={class:"text-center"},rl={class:"text-center"},nl={__name:"ProductVariants",props:{modelValue:{type:Array,default:()=>[]},availableAttributes:{type:Array,default:()=>[]}},emits:["update:modelValue","refresh-attributes"],setup(w,{emit:h}){const V=w,c=h,t=v([]),m=v([...V.modelValue]),n=v(!1),i=b=>{t.value.splice(b,1)},p=b=>{const u=t.value[b],f=V.availableAttributes.find(y=>y.id===u.id);f&&(u.availableValues=f.values||[])},r=async b=>{const u=t.value[b];if(!u.id)return;const f=u.selectedValues[u.selectedValues.length-1];if(typeof f=="string")try{const y=await Ke.create({attribute_id:u.id,name:f,active:1});y.status&&(u.selectedValues[u.selectedValues.length-1]=y.data[0],u.availableValues.push(y.data[0]))}catch(y){console.error("Failed to create attribute value:",y),u.selectedValues.pop()}},d=()=>{n.value=!0;const b=t.value.reduce((u,f)=>{if(f.selectedValues.length===0)return u;const y=[];return f.selectedValues.forEach(g=>{u.length===0?y.push({label:g.name||g,values:[g]}):u.forEach(M=>{y.push({label:`${M.label} / ${g.name||g}`,values:[...M.values,g]})})}),y},[]);m.value=b.map(u=>({label:u.label,values:u.values,sku:"",price_modifier:0,stock:0,enabled:!0})),n.value=!1,c("update:modelValue",m.value)},s=b=>{m.value.splice(b,1),c("update:modelValue",m.value)},a=b=>{c("refresh-attributes"),t.value.push({id:b.id,selectedValues:[],availableValues:b.values||[]})};return(b,u)=>(x(),A("div",We,[o("div",He,[o("div",Je,[u[1]||(u[1]=o("div",null,[o("h3",{class:"text-h6 font-weight-black mb-1"},"بناء المتغيرات"),o("p",{class:"text-body-2 text-grey-darken-1"},"أضف سمات مثل (اللون، المقاس، الخامة) لتوليد تشكيلات المنتج")],-1)),e(Oe,{onSaved:a},{activator:l(({props:f})=>[e(k,R({color:"primary","prepend-icon":"ri-add-line",variant:"tonal",rounded:"xl"},f),{default:l(()=>u[0]||(u[0]=[$(" إضافة سمة ")])),_:2},1040)]),_:1})]),(x(!0),A(G,null,O(t.value,(f,y)=>(x(),A("div",{key:y,class:"attr-row-glass pa-4 rounded-lg mb-4 bg-white border"},[e(B,{dense:"",align:"center"},{default:l(()=>[e(_,{cols:"12",md:"3"},{default:l(()=>[e(q,{modelValue:f.id,"onUpdate:modelValue":[g=>f.id=g,g=>p(y)],items:w.availableAttributes,"item-title":"name","item-value":"id",label:"السمة",placeholder:"اختر السمة...",variant:"solo",flat:"",density:"comfortable","hide-details":"","bg-color":"grey-lighten-4"},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),e(_,{cols:"12",md:"7"},{default:l(()=>[e(ne,{modelValue:f.selectedValues,"onUpdate:modelValue":[g=>f.selectedValues=g,g=>r(y)],items:f.availableValues,"item-title":"name",label:"القيم المختارة",multiple:"",chips:"","closable-chips":"",variant:"solo",flat:"",density:"comfortable","hide-details":"","bg-color":"grey-lighten-4",placeholder:"مثال: أحمر، أخضر، XL..."},null,8,["modelValue","onUpdate:modelValue","items"])]),_:2},1024),e(_,{cols:"12",md:"2",class:"text-end"},{default:l(()=>[e(k,{icon:"ri-delete-bin-7-line",color:"error",variant:"text",onClick:g=>i(y)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]))),128)),t.value.length>0?(x(),A("div",Xe,[e(k,{color:"primary",size:"large",class:"px-8 font-weight-black",rounded:"xl","prepend-icon":"ri-magic-line",loading:n.value,onClick:d},{default:l(()=>u[2]||(u[2]=[$(" توليد تشكيلات المتغيرات ")])),_:1},8,["loading"])])):D("",!0)]),e(Ve,null,{default:l(()=>[m.value.length>0?(x(),A("div",Ye,[o("div",Ze,[o("h4",el,"تشكيلات المتغيرات المختارة ("+Q(m.value.length)+")",1),o("div",ll,[e(k,{size:"small",variant:"text",color:"primary","prepend-icon":"ri-edit-line"},{default:l(()=>u[3]||(u[3]=[$("تعديل جماعي")])),_:1})])]),o("div",al,[e(be,{density:"comfortable",class:"premium-table"},{default:l(()=>[u[4]||(u[4]=o("thead",null,[o("tr",{class:"bg-grey-lighten-5"},[o("th",{class:"text-right"},"المتغير"),o("th",{class:"text-right"},"SKU"),o("th",{class:"text-right"},"السعر الإضافي"),o("th",{class:"text-right"},"الكمية"),o("th",{class:"text-center"},"الحالة"),o("th",{class:"text-center"},"حذف")])],-1)),o("tbody",null,[(x(!0),A(G,null,O(m.value,(f,y)=>(x(),A("tr",{key:y,class:"variant-row"},[o("td",tl,[o("div",sl,[e(j,{size:"32",color:"grey-lighten-4",class:"rounded-lg"},{default:l(()=>[e(S,{icon:"ri-box-3-line",size:"16"})]),_:1}),o("span",null,Q(f.label),1)])]),o("td",null,[e(U,{modelValue:f.sku,"onUpdate:modelValue":g=>f.sku=g,variant:"plain",density:"compact","hide-details":"",class:"sku-input"},null,8,["modelValue","onUpdate:modelValue"])]),o("td",null,[e(U,{modelValue:f.price_modifier,"onUpdate:modelValue":g=>f.price_modifier=g,modelModifiers:{number:!0},prefix:"+",variant:"plain",density:"compact","hide-details":"",type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),o("td",null,[e(U,{modelValue:f.stock,"onUpdate:modelValue":g=>f.stock=g,modelModifiers:{number:!0},variant:"plain",density:"compact","hide-details":"",type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),o("td",ol,[e(ie,{modelValue:f.enabled,"onUpdate:modelValue":g=>f.enabled=g,color:"primary","hide-details":"",density:"compact"},null,8,["modelValue","onUpdate:modelValue"])]),o("td",rl,[e(k,{icon:"ri-close-circle-line",size:"x-small",color:"grey",variant:"text",onClick:g=>s(y)},null,8,["onClick"])])]))),128))])]),_:1})])])):D("",!0)]),_:1})]))}},il=E(nl,[["__scopeId","data-v-69862169"]]),dl={__name:"QuickAddCategory",emits:["saved"],setup(w,{emit:h}){const V=h,c=v(!1),t=v(!1),m=v(!1),n=v(null),i=v(""),p=v(""),r=async()=>{const{valid:d}=await n.value.validate();if(d){t.value=!0;try{const s={name:i.value,name_en:p.value,active:1},a=await Ue.create(s,{showToast:!0});a.status&&(V("saved",a.data[0]),c.value=!1,i.value="",p.value="")}finally{t.value=!1}}};return(d,s)=>(x(),I(ee,{modelValue:c.value,"onUpdate:modelValue":s[4]||(s[4]=a=>c.value=a),"max-width":"500px"},{activator:l(({props:a})=>[W(d.$slots,"activator",{props:a},()=>[e(k,R({icon:"ri-add-line",size:"small",variant:"text",color:"primary"},a),null,16)])]),default:l(()=>[e(z,{rounded:"xl",class:"pa-4"},{default:l(()=>[e(H,{class:"d-flex align-center gap-2"},{default:l(()=>[e(j,{color:"primary-lighten-5",rounded:"lg",size:"40"},{default:l(()=>[e(S,{icon:"ri-folder-add-line",color:"primary"})]),_:1}),s[5]||(s[5]=o("span",{class:"font-weight-black"},"إضافة قسم جديد",-1))]),_:1}),e(J,{class:"mt-4"},{default:l(()=>[e(X,{ref_key:"form",ref:n,modelValue:m.value,"onUpdate:modelValue":s[2]||(s[2]=a=>m.value=a)},{default:l(()=>[e(U,{modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=a=>i.value=a),label:"اسم القسم (AR)",placeholder:"مثال: الهواتف الذكية",variant:"solo-filled",flat:"",rounded:"lg",rules:[a=>!!a||"اسم القسم مطلوب"],autofocus:""},null,8,["modelValue","rules"]),e(U,{modelValue:p.value,"onUpdate:modelValue":s[1]||(s[1]=a=>p.value=a),label:"اسم القسم (EN)",placeholder:"Smartphones",variant:"solo-filled",flat:"",rounded:"lg",class:"mt-2 text-left",dir:"ltr"},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),e(Y,{class:"pa-4"},{default:l(()=>[e(Z),e(k,{variant:"text",color:"grey",onClick:s[3]||(s[3]=a=>c.value=!1),disabled:t.value},{default:l(()=>s[6]||(s[6]=[$("إلغاء")])),_:1},8,["disabled"]),e(k,{color:"primary",variant:"flat",rounded:"lg",class:"px-6 font-weight-bold",loading:t.value,onClick:r},{default:l(()=>s[7]||(s[7]=[$(" حفظ القسم ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:3},8,["modelValue"]))}},ul={__name:"QuickAddBrand",emits:["saved"],setup(w,{emit:h}){const V=h,c=v(!1),t=v(!1),m=v(!1),n=v(null),i=v(""),p=v(""),r=async()=>{const{valid:d}=await n.value.validate();if(d){t.value=!0;try{const s={name:i.value,name_en:p.value,active:1},a=await Ce.create(s,{showToast:!0});a.status&&(V("saved",a.data[0]),c.value=!1,i.value="",p.value="")}finally{t.value=!1}}};return(d,s)=>(x(),I(ee,{modelValue:c.value,"onUpdate:modelValue":s[4]||(s[4]=a=>c.value=a),"max-width":"500px"},{activator:l(({props:a})=>[W(d.$slots,"activator",{props:a},()=>[e(k,R({icon:"ri-add-line",size:"small",variant:"text",color:"primary"},a),null,16)])]),default:l(()=>[e(z,{rounded:"xl",class:"pa-4"},{default:l(()=>[e(H,{class:"d-flex align-center gap-2"},{default:l(()=>[e(j,{color:"primary-lighten-5",rounded:"lg",size:"40"},{default:l(()=>[e(S,{icon:"ri-verified-badge-line",color:"primary"})]),_:1}),s[5]||(s[5]=o("span",{class:"font-weight-black"},"إضافة علامة تجارية جديدة",-1))]),_:1}),e(J,{class:"mt-4"},{default:l(()=>[e(X,{ref_key:"form",ref:n,modelValue:m.value,"onUpdate:modelValue":s[2]||(s[2]=a=>m.value=a)},{default:l(()=>[e(U,{modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=a=>i.value=a),label:"اسم العلامة التجارية (AR)",placeholder:"مثال: سامسونج",variant:"solo-filled",flat:"",rounded:"lg",rules:[a=>!!a||"الاسم مطلوب"],autofocus:""},null,8,["modelValue","rules"]),e(U,{modelValue:p.value,"onUpdate:modelValue":s[1]||(s[1]=a=>p.value=a),label:"اسم العلامة التجارية (EN)",placeholder:"Samsung",variant:"solo-filled",flat:"",rounded:"lg",class:"mt-2 text-left",dir:"ltr"},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),e(Y,{class:"pa-4"},{default:l(()=>[e(Z),e(k,{variant:"text",color:"grey",onClick:s[3]||(s[3]=a=>c.value=!1),disabled:t.value},{default:l(()=>s[6]||(s[6]=[$("إلغاء")])),_:1},8,["disabled"]),e(k,{color:"primary",variant:"flat",rounded:"lg",class:"px-6 font-weight-bold",loading:t.value,onClick:r},{default:l(()=>s[7]||(s[7]=[$(" حفظ البراند ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:3},8,["modelValue"]))}},ml={class:"product-form-overhaul"},cl={class:"sticky-header pa-3 pa-md-4 glass-blur border-b"},pl={class:"container-premium d-flex flex-column flex-sm-row align-start align-sm-center justify-space-between mx-auto gap-3"},fl={class:"d-flex align-center gap-2 gap-md-4"},vl={class:"text-caption text-grey d-none d-sm-flex align-center gap-1"},gl={class:"text-subtitle-1 text-md-h6 font-weight-black mb-0"},bl={class:"d-flex align-center justify-space-between justify-sm-end w-100 w-sm-auto gap-2 gap-md-3"},Vl={class:"d-flex align-center gap-2"},yl={class:"d-flex align-center gap-1 gap-md-2"},xl={class:"main-content-wrapper pa-6 bg-grey-lighten-5 min-h-screen"},wl={class:"container-premium mx-auto"},hl={class:"d-flex flex-column gap-6"},_l={class:"d-flex align-center gap-3 mb-6"},kl={class:"sticky-sidebar d-flex flex-column gap-6"},$l={class:"d-flex align-center justify-space-between mb-1"},Ul={class:"d-flex align-center justify-space-between mb-1"},Cl={__name:"ProductForm",props:{modelValue:{type:Object,required:!0},categories:{type:Array,default:()=>[]},brands:{type:Array,default:()=>[]},warehouses:{type:Array,default:()=>[]},availableAttributes:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},errors:{type:Object,default:()=>({})},isEdit:{type:Boolean,default:!1}},emits:["update:modelValue","submit","cancel","refresh-categories","refresh-brands"],setup(w,{emit:h}){const V=w,c=h,t=v({...V.modelValue,images:V.modelValue.images||[],variants:V.modelValue.variants||[],tags:V.modelValue.tags||[],active:V.modelValue.active??!0});se(()=>V.modelValue,p=>{t.value={...p}},{deep:!0}),se(t,p=>{c("update:modelValue",p)},{deep:!0});const m=()=>{c("submit",t.value)},n=p=>{c("refresh-categories"),t.value.category_id=p.id},i=p=>{c("refresh-brands"),t.value.brand_id=p.id};return(p,r)=>(x(),A("div",ml,[o("div",cl,[o("div",pl,[o("div",fl,[e(k,{icon:"ri-arrow-right-line",variant:"text",size:"small",onClick:r[0]||(r[0]=d=>p.$emit("cancel"))}),o("div",null,[o("div",vl,[r[11]||(r[11]=o("span",null,"المنتجات",-1)),e(S,{icon:"ri-arrow-left-s-line",size:"14"}),r[12]||(r[12]=o("span",null,"إضافة منتج جديد",-1))]),o("h1",gl,Q(t.value.name||"منتج جديد"),1)])]),o("div",bl,[o("div",Vl,[t.value.active?(x(),I(T,{key:0,color:"success",size:"x-small",variant:"flat",class:"font-weight-bold"},{default:l(()=>r[13]||(r[13]=[$("نشط")])),_:1})):(x(),I(T,{key:1,color:"grey",size:"x-small",variant:"flat",class:"font-weight-bold"},{default:l(()=>r[14]||(r[14]=[$("مسودة")])),_:1}))]),o("div",yl,[e(k,{variant:"text",color:"grey-darken-1",size:"small",class:"font-weight-bold d-none d-sm-flex",onClick:r[1]||(r[1]=d=>p.$emit("cancel"))},{default:l(()=>r[15]||(r[15]=[$("تجاهل")])),_:1}),e(k,{color:"primary",size:p.$vuetify.display.mobile?"default":"large",rounded:"xl",class:"px-4 px-md-8 font-weight-black elevation-4",loading:w.loading,"prepend-icon":"ri-shield-check-line",onClick:m},{default:l(()=>r[16]||(r[16]=[$(" حفظ "),o("span",{class:"d-none d-md-inline ms-1"},"المنتج",-1)])),_:1},8,["size","loading"])])])])]),o("div",xl,[o("div",wl,[e(B,null,{default:l(()=>[e(_,{cols:"12",lg:"8"},{default:l(()=>[o("div",hl,[e(Ie,{modelValue:t.value,"onUpdate:modelValue":r[2]||(r[2]=d=>t.value=d)},null,8,["modelValue"]),e(z,{variant:"flat",class:"pa-4 pa-md-6 rounded-xl border bg-white"},{default:l(()=>[o("div",_l,[e(j,{color:"secondary-lighten-5",rounded:"lg"},{default:l(()=>[e(S,{icon:"ri-image-2-line",color:"secondary"})]),_:1}),r[17]||(r[17]=o("h3",{class:"text-subtitle-1 font-weight-black"},"معرض الصور",-1))]),e(Me,{modelValue:t.value.images,"onUpdate:modelValue":r[3]||(r[3]=d=>t.value.images=d)},null,8,["modelValue"])]),_:1}),e(Ne,{modelValue:t.value,"onUpdate:modelValue":r[4]||(r[4]=d=>t.value=d),warehouses:w.warehouses},null,8,["modelValue","warehouses"]),e(z,{variant:"flat",class:"pa-4 pa-md-6 rounded-xl border bg-white mb-6"},{default:l(()=>[e(il,{modelValue:t.value.variants,"onUpdate:modelValue":r[5]||(r[5]=d=>t.value.variants=d),"available-attributes":w.availableAttributes},null,8,["modelValue","available-attributes"])]),_:1})])]),_:1}),e(_,{cols:"12",lg:"4"},{default:l(()=>[o("div",kl,[e(z,{variant:"flat",class:"pa-4 pa-md-6 rounded-xl border bg-white"},{default:l(()=>[r[20]||(r[20]=o("h3",{class:"text-subtitle-1 font-weight-black mb-6"},"التصنيف والبراند",-1)),e(B,{dense:""},{default:l(()=>[e(_,{cols:"12"},{default:l(()=>[o("div",$l,[r[18]||(r[18]=o("label",{class:"text-caption font-weight-bold text-grey-darken-1"},"الفئة الأساسية",-1)),e(dl,{onSaved:n})]),e(q,{modelValue:t.value.category_id,"onUpdate:modelValue":r[6]||(r[6]=d=>t.value.category_id=d),items:w.categories,"item-title":"name","item-value":"id",placeholder:"اختر الفئة...",variant:"solo",flat:"","bg-color":"grey-lighten-4",class:"premium-input-field"},null,8,["modelValue","items"])]),_:1}),e(_,{cols:"12"},{default:l(()=>[o("div",Ul,[r[19]||(r[19]=o("label",{class:"text-caption font-weight-bold text-grey-darken-1"},"العلامة التجارية",-1)),e(ul,{onSaved:i})]),e(q,{modelValue:t.value.brand_id,"onUpdate:modelValue":r[7]||(r[7]=d=>t.value.brand_id=d),items:w.brands,"item-title":"name","item-value":"id",placeholder:"اختر البراند...",variant:"solo",flat:"","bg-color":"grey-lighten-4",class:"premium-input-field"},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1}),e(z,{variant:"flat",class:"pa-4 pa-md-6 rounded-xl border bg-white"},{default:l(()=>[r[23]||(r[23]=o("h3",{class:"text-subtitle-1 font-weight-black mb-4"},"الحالة والظهور",-1)),e(ye,{class:"pa-0"},{prepend:l(()=>[e(S,{icon:"ri-eye-line",color:"grey"})]),append:l(()=>[e(ie,{modelValue:t.value.active,"onUpdate:modelValue":r[8]||(r[8]=d=>t.value.active=d),color:"success","hide-details":"",density:"compact"},null,8,["modelValue"])]),default:l(()=>[e(xe,{class:"text-body-2"},{default:l(()=>r[21]||(r[21]=[$("ظهور المنتج")])),_:1}),e(we,{class:"text-caption"},{default:l(()=>r[22]||(r[22]=[$("تحديد ما إذا كان المنتج متاحاً للعملاء")])),_:1})]),_:1})]),_:1}),e(z,{variant:"flat",class:"pa-4 pa-md-6 rounded-xl border bg-white"},{default:l(()=>[r[24]||(r[24]=o("h3",{class:"text-subtitle-1 font-weight-black mb-1"},"الكلمات الدلالية",-1)),r[25]||(r[25]=o("p",{class:"text-caption text-grey mb-4"},"تساعد على تسريع البحث داخل النظام",-1)),e(ne,{modelValue:t.value.tags,"onUpdate:modelValue":r[9]||(r[9]=d=>t.value.tags=d),multiple:"",chips:"","closable-chips":"",variant:"solo",flat:"","bg-color":"grey-lighten-4",placeholder:"أضف تاجات...",class:"premium-input-field"},null,8,["modelValue"])]),_:1}),e(z,{variant:"flat",class:"pa-4 pa-md-6 rounded-xl border bg-white"},{default:l(()=>[r[26]||(r[26]=o("h3",{class:"text-subtitle-1 font-weight-black mb-1"},"ملاحظات داخلية",-1)),r[27]||(r[27]=o("p",{class:"text-caption text-grey mb-4"},"ملاحظات لا يراها العميل",-1)),e(oe,{modelValue:t.value.internal_note,"onUpdate:modelValue":r[10]||(r[10]=d=>t.value.internal_note=d),variant:"solo",flat:"","bg-color":"grey-lighten-4",class:"premium-input-field",rows:"3"},null,8,["modelValue"])]),_:1})])]),_:1})]),_:1})])])]))}},Al=E(Cl,[["__scopeId","data-v-1f13c601"]]),zl={class:"product-create-container"},Sl={__name:"ProductCreate",setup(w){const h=_e(),V=ke(),{getProduct:c,createProduct:t,updateProduct:m}=$e(),n=N("/api/categories"),i=N("/api/brands"),p=N("/api/warehouses"),r=N("/api/attributes"),d=v(!1),s=v({}),a=v([]),b=v([]),u=v([]),f=v([]),y=v({name:"",sku:"",barcode:"",category_id:null,brand_id:null,desc:"",desc_long:"",retail_price:0,wholesale_price:0,tax:0,warehouse_id:null,min_quantity:1,weight:0,active:!0,featured:!1,returnable:!0,images:[],variants:[],tags:[],internal_note:""}),g=K(()=>!!V.params.id),M=async()=>{const C=await n.get({per_page:100},{showLoading:!1});a.value=C.data||[]},le=async()=>{const C=await i.get({per_page:100},{showLoading:!1});b.value=C.data||[]},de=async()=>{const C=await p.get({per_page:100},{showLoading:!1});u.value=C.data||[]},ae=async()=>{const C=await r.get({per_page:100},{showLoading:!1});f.value=C.data||[]},ue=async()=>{try{await Promise.all([M(),le(),de(),ae()])}catch(C){console.error("Failed to load initial data:",C)}},me=async()=>{if(g.value)try{const P=(await c(V.params.id)).data;y.value={...P,images:P.images||[],variants:P.variants||[],tags:P.tags||[]}}catch(C){console.error("Error loading product:",C),h.push("/products")}},ce=async C=>{var P,F;d.value=!0,s.value={};try{g.value?await m(V.params.id,C):await t(C),h.push("/products")}catch(te){(F=(P=te.response)==null?void 0:P.data)!=null&&F.errors&&(s.value=te.response.data.errors)}finally{d.value=!1}},pe=()=>{h.push("/products")};return he(async()=>{await ue(),g.value&&await me()}),(C,P)=>(x(),A("div",zl,[e(Al,{modelValue:y.value,"onUpdate:modelValue":P[0]||(P[0]=F=>y.value=F),categories:a.value,brands:b.value,warehouses:u.value,"available-attributes":f.value,loading:d.value,errors:s.value,"is-edit":g.value,onSubmit:ce,onCancel:pe,onRefreshCategories:M,onRefreshBrands:le,onRefreshAttributes:ae},null,8,["modelValue","categories","brands","warehouses","available-attributes","loading","errors","is-edit"])]))}},Dl=E(Sl,[["__scopeId","data-v-9b5e6726"]]);export{Dl as default};
