import{r as l,y as L,K as T,c as F,a as s,b as i,t as b,u as G,v as K,w as u,D as P,S as X,o as D,m as y,j as q,k as z}from"./index-DPR0tjT6.js";import{u as A}from"./useApi-CTBDEoea.js";import{u as H}from"./usePermissions-BOh6stgy.js";import{A as J}from"./AppDataTable-CV9gFKLg.js";import{A as B}from"./AppDialog-CVbZwWX_.js";import{_ as C}from"./AppButton-DiF3_7lr.js";import{_ as O}from"./AppInput-CYR4AaBJ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Q={class:"attribute-values-page"},W={class:"mb-6 px-6 pt-6 d-flex align-center justify-space-between"},Y={class:"d-flex align-center mb-1"},Z={class:"text-h4 font-weight-bold"},ee={class:"px-6 pb-6"},te={class:"font-weight-bold text-primary"},ce={__name:"AttributeValueList",setup(ae){const E=X(),{can:M}=H(),_=E.params.id,d=A(`/api/attributes/${_}/values`),N=A("/api/attributes"),h=l(null),V=l([]),m=l(!1),r=l(!1),c=l(!1),o=l(null),v=l(!1),f=l(!1),w=l(null),n=l({name:""}),p=L(()=>{var e;return!!((e=o.value)!=null&&e.id)}),S=[{title:"القيمة",key:"name"},{title:"تاريخ الإضافة",key:"created_at"},{title:"الإجراءات",key:"actions",sortable:!1,align:"end"}],I=async()=>{try{const e=await N.getById(_);h.value=e.data}catch(e){console.error("Error fetching attribute:",e)}},g=async()=>{m.value=!0;try{const e=await d.get();V.value=e.data||[]}catch(e){console.error("Error fetching values:",e)}finally{m.value=!1}},R=()=>{o.value=null,n.value={name:""},r.value=!0},U=e=>{o.value=e,n.value={name:e.name},r.value=!0},$=e=>{o.value=e,c.value=!0},x=async()=>{const{valid:e}=await w.value.validate();if(e){v.value=!0;try{p.value?await d.update(o.value.id,n.value,{successMessage:"تم التحديث بنجاح"}):await d.create(n.value,{successMessage:"تم الإضافة بنجاح"}),r.value=!1,g()}finally{v.value=!1}}},j=async()=>{f.value=!0;try{await d.remove(o.value.id,{successMessage:"تم الحذف بنجاح"}),c.value=!1,g()}finally{f.value=!1}};return T(()=>{I(),g()}),(e,t)=>{var k;return D(),F("div",Q,[s("div",W,[s("div",null,[s("div",Y,[i(C,{icon:"ri-arrow-right-line",variant:"text",color:"grey",class:"me-2",to:"/attributes"}),s("h1",Z,"قيم الخاصية: "+b(((k=h.value)==null?void 0:k.name)||"..."),1)]),t[3]||(t[3]=s("p",{class:"text-body-1 text-grey ms-10"},"إدارة القيم المتاحة لهذه الخاصية لاستخدامها في المنتجات",-1))]),G(M)("attributes.create")?(D(),K(C,{key:0,"prepend-icon":"ri-add-line",onClick:R},{default:u(()=>t[4]||(t[4]=[y(" إضافة قيمة جديدة ")])),_:1})):P("",!0)]),s("div",ee,[i(J,{title:"قيم الخاصية",icon:"ri-list-check",headers:S,items:V.value,loading:m.value,"permission-module":"attributes",onEdit:U,onDelete:$},{"item.name":u(({item:a})=>[s("div",te,b(a.name),1)]),_:1},8,["items","loading"])]),i(B,{modelValue:r.value,"onUpdate:modelValue":t[1]||(t[1]=a=>r.value=a),title:p.value?"تعديل القيمة":"إضافة قيمة جديدة",icon:p.value?"ri-edit-line":"ri-add-line",loading:v.value,onConfirm:x},{default:u(()=>[i(q,{ref_key:"formRef",ref:w,onSubmit:z(x,["prevent"])},{default:u(()=>[i(O,{modelValue:n.value.name,"onUpdate:modelValue":t[0]||(t[0]=a=>n.value.name=a),label:"اسم القيمة *",placeholder:"مثال: أحمر، XL، 128GB",rules:[a=>!!a||"مطلوب"]},null,8,["modelValue","rules"])]),_:1},512)]),_:1},8,["modelValue","title","icon","loading"]),i(B,{modelValue:c.value,"onUpdate:modelValue":t[2]||(t[2]=a=>c.value=a),title:"تأكيد الحذف",icon:"ri-delete-bin-line","confirm-color":"error","confirm-text":"حذف",loading:f.value,onConfirm:j},{default:u(()=>{var a;return[t[5]||(t[5]=y(' هل أنت متأكد من حذف القيمة "')),s("strong",null,b((a=o.value)==null?void 0:a.name),1),t[6]||(t[6]=y('"؟ '))]}),_:1},8,["modelValue","loading"])])}}};export{ce as default};
