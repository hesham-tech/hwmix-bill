import{r as l,z as T,L as j,c as z,b as s,d as i,v as b,u as F,x as G,w as u,E as P,U as X,o as D,n as y,k as q,l as H}from"./index-B0c0aplS.js";import{u as A}from"./useApi-C9JqAxpT.js";import{u as J}from"./usePermissions-D1W15K8H.js";import{A as K}from"./AppDataTable-DRQWa6GE.js";import{A as E}from"./AppDialog-yMQfGMN-.js";import{_ as B}from"./AppButton-CoaWq9vh.js";import{_ as O}from"./AppInput-B9V4fNt_.js";const Q={class:"attribute-values-page"},W={class:"mb-6 px-6 pt-6 d-flex align-center justify-space-between"},Y={class:"d-flex align-center mb-1"},Z={class:"text-h4 font-weight-bold"},ee={class:"px-6 pb-6"},te={class:"font-weight-bold text-primary"},de={__name:"AttributeValueList",setup(ae){const C=X(),{can:M}=J(),_=C.params.id,d=A(`/api/attributes/${_}/values`),N=A("/api/attributes"),h=l(null),V=l([]),m=l(!1),r=l(!1),c=l(!1),o=l(null),v=l(!1),f=l(!1),w=l(null),n=l({name:""}),p=T(()=>{var e;return!!((e=o.value)!=null&&e.id)}),U=[{title:"القيمة",key:"name"},{title:"تاريخ الإضافة",key:"created_at"},{title:"الإجراءات",key:"actions",sortable:!1,align:"end"}],I=async()=>{try{const e=await N.getById(_);h.value=e.data}catch(e){console.error("Error fetching attribute:",e)}},g=async()=>{m.value=!0;try{const e=await d.get();V.value=e.data||[]}catch(e){console.error("Error fetching values:",e)}finally{m.value=!1}},L=()=>{o.value=null,n.value={name:""},r.value=!0},R=e=>{o.value=e,n.value={name:e.name},r.value=!0},S=e=>{o.value=e,c.value=!0},x=async()=>{const{valid:e}=await w.value.validate();if(e){v.value=!0;try{p.value?await d.update(o.value.id,n.value,{successMessage:"تم التحديث بنجاح"}):await d.create(n.value,{successMessage:"تم الإضافة بنجاح"}),r.value=!1,g()}finally{v.value=!1}}},$=async()=>{f.value=!0;try{await d.remove(o.value.id,{successMessage:"تم الحذف بنجاح"}),c.value=!1,g()}finally{f.value=!1}};return j(()=>{I(),g()}),(e,t)=>{var k;return D(),z("div",Q,[s("div",W,[s("div",null,[s("div",Y,[i(B,{icon:"ri-arrow-right-line",variant:"text",color:"grey",class:"me-2",to:"/attributes"}),s("h1",Z,"قيم الخاصية: "+b(((k=h.value)==null?void 0:k.name)||"..."),1)]),t[3]||(t[3]=s("p",{class:"text-body-1 text-grey ms-10"},"إدارة القيم المتاحة لهذه الخاصية لاستخدامها في المنتجات",-1))]),F(M)("attributes.create")?(D(),G(B,{key:0,"prepend-icon":"ri-add-line",onClick:L},{default:u(()=>t[4]||(t[4]=[y(" إضافة قيمة جديدة ")])),_:1})):P("",!0)]),s("div",ee,[i(K,{title:"قيم الخاصية",icon:"ri-list-check",headers:U,items:V.value,loading:m.value,"permission-module":"attributes",onEdit:R,onDelete:S},{"item.name":u(({item:a})=>[s("div",te,b(a.name),1)]),_:1},8,["items","loading"])]),i(E,{modelValue:r.value,"onUpdate:modelValue":t[1]||(t[1]=a=>r.value=a),title:p.value?"تعديل القيمة":"إضافة قيمة جديدة",icon:p.value?"ri-edit-line":"ri-add-line",loading:v.value,onConfirm:x},{default:u(()=>[i(q,{ref_key:"formRef",ref:w,onSubmit:H(x,["prevent"])},{default:u(()=>[i(O,{modelValue:n.value.name,"onUpdate:modelValue":t[0]||(t[0]=a=>n.value.name=a),label:"اسم القيمة *",placeholder:"مثال: أحمر، XL، 128GB",rules:[a=>!!a||"مطلوب"]},null,8,["modelValue","rules"])]),_:1},512)]),_:1},8,["modelValue","title","icon","loading"]),i(E,{modelValue:c.value,"onUpdate:modelValue":t[2]||(t[2]=a=>c.value=a),title:"تأكيد الحذف",icon:"ri-delete-bin-line","confirm-color":"error","confirm-text":"حذف",loading:f.value,onConfirm:$},{default:u(()=>{var a;return[t[5]||(t[5]=y(' هل أنت متأكد من حذف القيمة "')),s("strong",null,b((a=o.value)==null?void 0:a.name),1),t[6]||(t[6]=y('"؟ '))]}),_:1},8,["modelValue","loading"])])}}};export{de as default};
