import{r as S,o as m,x as v,w as e,d as t,f as x,h as D,a3 as T,b as s,v as r,u as _,B as V,i as k,e as L,D as E,n as w,R as O,c as P,F as j,j as N,Q as q,a4 as tt,a5 as et,z as U,E as F,A as R,a as H,t as ct,H as Q,G as dt,L as W,a6 as st,P as at,O as ot,a7 as ut,l as ft,a8 as mt,a9 as pt,p as gt,aa as _t,y as nt,ab as yt,ac as ht,M as bt,T as xt}from"./index-Flp88uEA.js";import{u as G}from"./useApi-Dl4iYKvS.js";import{_ as lt}from"./AppButton-DMkx3xLA.js";import{f as M}from"./formatters-CKQiR5Fb.js";import{_ as vt}from"./AppCard-D6xOpfLS.js";import{A as X}from"./AppDataTable-anW7O1Lb.js";import{S as wt}from"./SalesTrendChart-D_cFqFhC.js";import"./task.service-BnND5amn.js";import"./usePermissions-BSwY7w5L.js";function it(){const p=G("/api/invoices");G("/api/products"),G("/api/users"),G("/api/payments");const u=G("/api/installments"),i=S(!0),c=S(!1),f=S(!1),d=S(!1),h=S({totalInvoices:0,totalProducts:0,totalUsers:0,totalPayments:0,totalSales:0,monthlySales:0,pendingPayments:0}),y=S([]),b=S([]),z=S([]),l=S([]),g=S([]),a=async()=>{var $,A,B,J,K,Y;i.value=!0;try{const I=(await G("/api/dashboard/summary").get({},{showLoading:!1})).data;I&&(h.value={totalSales:(($=I.kpis)==null?void 0:$.total_sales)||0,monthlySales:((A=I.kpis)==null?void 0:A.monthly_sales)||0,pendingPayments:((B=I.kpis)==null?void 0:B.pending_payments)||0,totalCustomers:((J=I.kpis)==null?void 0:J.total_customers)||0,totalProducts:((K=I.kpis)==null?void 0:K.total_products)||0,totalInvoices:((Y=I.recent_invoices)==null?void 0:Y.length)||0},l.value=I.sales_trend||[],y.value=I.recent_invoices||[],g.value=I.top_products||[])}catch(Z){console.error("Error fetching dashboard summary:",Z)}finally{i.value=!1}},o=async()=>{c.value=!0;try{const $=new Date,A=new Date;A.setDate($.getDate()+5);const B=await p.get({payment_status:"unpaid,partial",due_date_from:$.toISOString().split("T")[0],due_date_to:A.toISOString().split("T")[0],per_page:5},{showLoading:!1});b.value=B.data||[]}finally{c.value=!1}},n=async()=>{f.value=!0;try{const $=new Date,A=new Date;A.setDate($.getDate()+5);const B=await u.get({status:"pending",due_date_from:$.toISOString().split("T")[0],due_date_to:A.toISOString().split("T")[0],per_page:5},{showLoading:!1});z.value=B.data||[]}finally{f.value=!1}};return{stats:h,recentInvoices:y,upcomingPayments:b,upcomingInstallments:z,salesTrend:l,topProducts:g,loading:i,loadingUpcoming:c,loadingInstallments:f,refreshing:d,fetchDashboardData:a,fetchUpcomingPayments:o,fetchUpcomingInstallments:n,refreshAll:async()=>{d.value=!0;try{await Promise.all([a(),o(),n()])}finally{d.value=!1}}}}const kt={class:"d-flex align-center justify-space-between"},$t={class:"text-h5 font-weight-black text-success"},Dt={class:"d-flex align-center justify-space-between"},Ct={class:"text-h5 font-weight-black text-primary"},zt={class:"d-flex align-center justify-space-between"},It={class:"text-h5 font-weight-black text-error"},St={class:"d-flex align-center justify-space-between"},Tt={class:"text-h5 font-weight-black text-info"},Vt={__name:"StatsCards",props:{stats:{type:Object,required:!0}},setup(p){return(u,i)=>(m(),v(L,{dense:""},{default:e(()=>[t(x,{cols:"12",sm:"6",md:"3"},{default:e(()=>[t(D,{border:"",flat:"",class:"rounded-xl overflow-hidden pa-1"},{default:e(()=>[t(T,{class:"pa-4 bg-success-lighten-5"},{default:e(()=>[s("div",kt,[s("div",null,[i[0]||(i[0]=s("div",{class:"text-caption font-weight-bold text-success mb-1"},"إجمالي المبيعات",-1)),s("div",$t,r(_(M)(p.stats.totalSales)),1)]),t(V,{color:"success",size:"48",variant:"flat",class:"rounded-lg"},{default:e(()=>[t(k,{icon:"ri-money-dollar-box-line",color:"white",size:"28"})]),_:1})]),i[1]||(i[1]=s("div",{class:"mt-3 text-caption text-grey"},"تراكمي منذ البداية",-1))]),_:1})]),_:1})]),_:1}),t(x,{cols:"12",sm:"6",md:"3"},{default:e(()=>[t(D,{border:"",flat:"",class:"rounded-xl overflow-hidden pa-1"},{default:e(()=>[t(T,{class:"pa-4 bg-primary-lighten-5"},{default:e(()=>[s("div",Dt,[s("div",null,[i[2]||(i[2]=s("div",{class:"text-caption font-weight-bold text-primary mb-1"},"مبيعات الشهر",-1)),s("div",Ct,r(_(M)(p.stats.monthlySales)),1)]),t(V,{color:"primary",size:"48",variant:"flat",class:"rounded-lg"},{default:e(()=>[t(k,{icon:"ri-calendar-event-line",color:"white",size:"28"})]),_:1})]),i[3]||(i[3]=s("div",{class:"mt-3 text-caption text-grey"},"مبيعات الشهر الحالي",-1))]),_:1})]),_:1})]),_:1}),t(x,{cols:"12",sm:"6",md:"3"},{default:e(()=>[t(D,{border:"",flat:"",class:"rounded-xl overflow-hidden pa-1"},{default:e(()=>[t(T,{class:"pa-4 bg-error-lighten-5"},{default:e(()=>[s("div",zt,[s("div",null,[i[4]||(i[4]=s("div",{class:"text-caption font-weight-bold text-error mb-1"},"تحصيل معلق",-1)),s("div",It,r(_(M)(p.stats.pendingPayments)),1)]),t(V,{color:"error",size:"48",variant:"flat",class:"rounded-lg"},{default:e(()=>[t(k,{icon:"ri-hand-coin-line",color:"white",size:"28"})]),_:1})]),i[5]||(i[5]=s("div",{class:"mt-3 text-caption text-grey"},"مبالغ لم يتم تحصيلها",-1))]),_:1})]),_:1})]),_:1}),t(x,{cols:"12",sm:"6",md:"3"},{default:e(()=>[t(D,{border:"",flat:"",class:"rounded-xl overflow-hidden pa-1"},{default:e(()=>[t(T,{class:"pa-4 bg-info-lighten-5"},{default:e(()=>[s("div",St,[s("div",null,[i[6]||(i[6]=s("div",{class:"text-caption font-weight-bold text-info mb-1"},"العملاء",-1)),s("div",Tt,r(p.stats.totalCustomers||0),1)]),t(V,{color:"info",size:"48",variant:"flat",class:"rounded-lg"},{default:e(()=>[t(k,{icon:"ri-team-line",color:"white",size:"28"})]),_:1})]),i[7]||(i[7]=s("div",{class:"mt-3 text-caption text-grey"},"عدد العملاء النشطين",-1))]),_:1})]),_:1})]),_:1})]),_:1}))}},Pt={__name:"QuickActions",props:{actions:{type:Array,required:!0}},emits:["action-click"],setup(p){return(u,i)=>(m(),v(vt,{title:"إجراءات سريعة",icon:"ri-flashlight-line",class:"h-100"},{actions:e(()=>[t(E,{size:"x-small",color:"primary",variant:"flat",class:"font-weight-black"},{default:e(()=>i[0]||(i[0]=[w("أكثر استخداماً")])),_:1})]),default:e(()=>[t(O,{class:"pa-0"},{default:e(()=>[(m(!0),P(j,null,N(p.actions,c=>(m(),v(q,{key:c.title,class:"border-b last-child-no-border py-3 px-4 clickable-action",onClick:f=>u.$emit("action-click",c.route)},{prepend:e(()=>[t(V,{color:`${c.color}-lighten-5`,size:"40",class:"me-3"},{default:e(()=>[t(k,{icon:c.icon,color:c.color},null,8,["icon","color"])]),_:2},1032,["color"])]),append:e(()=>[t(k,{icon:"ri-arrow-left-s-line",color:"grey-lighten-1",size:"small"})]),default:e(()=>[t(tt,{class:"font-weight-bold text-body-1"},{default:e(()=>[w(r(c.title),1)]),_:2},1024),t(et,{class:"text-caption"},{default:e(()=>[w(r(c.subtitle),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}))}},At={class:"font-weight-black text-primary"},Lt={class:"font-weight-medium"},Ut={class:"font-weight-black text-h6 text-success"},Et={class:"text-center pa-8"},rt={__name:"RecentInvoices",props:{invoices:{type:Array,required:!0},loading:{type:Boolean,default:!1}},setup(p){const u=[{title:"رقم الفاتورة",key:"invoice_number"},{title:"العميل",key:"customer"},{title:"المبلغ",key:"total",align:"end"},{title:"الحالة",key:"status"}],i=d=>d?new Intl.NumberFormat("ar-EG",{style:"currency",currency:"EGP"}).format(d):"0.00 ج.م",c=d=>({draft:"grey",pending:"warning",approved:"success",cancelled:"error"})[d]||"grey",f=d=>({draft:"مسودة",pending:"قيد الانتظار",approved:"معتمدة",cancelled:"ملغاة"})[d]||d;return(d,h)=>(m(),v(X,{headers:u,items:p.invoices,loading:p.loading,title:"آخر الفواتير الصادرة",icon:"ri-file-list-3-line","hide-footer":"","items-per-page":5},{"item.invoice_number":e(({item:y})=>[s("div",At,"#"+r(y.invoice_number),1)]),"item.customer":e(({item:y})=>{var b;return[s("div",Lt,r(((b=y.customer)==null?void 0:b.name)||"---"),1)]}),"item.total":e(({item:y})=>[s("div",Ut,r(i(y.total)),1)]),"item.status":e(({item:y})=>[t(E,{color:c(y.status),size:"small",variant:"flat",class:"font-weight-bold px-3"},{default:e(()=>[w(r(f(y.status)),1)]),_:2},1032,["color"])]),"no-data":e(()=>[s("div",Et,[t(k,{icon:"ri-file-history-line",size:"48",color:"grey-lighten-2",class:"mb-2"}),h[0]||(h[0]=s("div",{class:"text-subtitle-1 text-grey font-weight-medium"},"لا توجد فواتير حديثة حتى الآن",-1))])]),_:1},8,["items","loading"]))}},Bt={class:"d-flex align-center py-2"},Gt={class:"text-primary font-weight-bold text-caption"},jt={class:"d-flex flex-column"},Nt={class:"font-weight-bold text-body-1"},Mt={class:"text-caption text-grey"},Ot={class:"d-flex flex-column"},qt={class:"font-weight-medium text-body-2"},Ft={class:"d-flex flex-column align-end"},Rt={class:"font-weight-black text-body-1 text-error"},Ht={class:"text-caption text-grey"},Qt={class:"text-center pa-8"},Wt={__name:"UpcomingPayments",props:{payments:{type:Array,required:!0},loading:{type:Boolean,default:!1}},setup(p){const u=p,i=[{title:"العميل",key:"customer"},{title:"تاريخ الاستحقاق",key:"due_date"},{title:"المبلغ المتبقي",key:"amount",align:"end"},{title:"الأولوية",key:"urgency"}],c=U(()=>u.payments.length),f=l=>l?new Date(l).toLocaleDateString("ar-EG",{day:"numeric",month:"short"}):"-",d=l=>l?new Intl.NumberFormat("ar-EG",{style:"currency",currency:"EGP"}).format(l):"0.00 ج.م",h=l=>{if(!l)return"-";const g=new Date,o=new Date(l)-g,n=Math.ceil(o/(1e3*60*60*24));return n<0?"متأخر!":n===0?"اليوم":n===1?"غداً":`بعد ${n} يوم`},y=l=>{if(!l)return"";const g=new Date,o=new Date(l)-g,n=Math.ceil(o/(1e3*60*60*24));return n<0?"text-error font-weight-bold":n<=1?"text-warning font-weight-bold":"text-medium-emphasis"},b=l=>{if(!l)return"grey";const g=new Date,o=new Date(l)-g,n=Math.ceil(o/(1e3*60*60*24));return n<0?"error":n<=1?"warning":n<=3?"info":"success"},z=l=>{if(!l)return"-";const g=new Date,o=new Date(l)-g,n=Math.ceil(o/(1e3*60*60*24));return n<0?"متأخر":n<=1?"عاجل":n<=3?"قريب":"عادي"};return(l,g)=>(m(),v(X,{headers:i,items:p.payments,loading:p.loading,title:"الفواتير المستحقة قريباً",icon:"ri-calendar-todo-line","hide-footer":"","items-per-page":5},{actions:e(()=>[c.value>0?(m(),v(E,{key:0,color:"error",size:"small",variant:"flat",class:"font-weight-black"},{default:e(()=>[w(r(c.value)+" فواتير متأخرة ",1)]),_:1})):F("",!0)]),"item.customer":e(({item:a})=>{var o;return[s("div",Bt,[t(V,{size:"36",color:"primary-lighten-5",class:"me-3"},{default:e(()=>{var n,C;return[s("span",Gt,r((C=(n=a.customer)==null?void 0:n.name)==null?void 0:C.charAt(0)),1)]}),_:2},1024),s("div",jt,[s("span",Nt,r((o=a.customer)==null?void 0:o.name),1),s("span",Mt,"فاتورة #"+r(a.invoice_number),1)])])]}),"item.due_date":e(({item:a})=>[s("div",Ot,[s("span",qt,r(f(a.due_date)),1),s("span",{class:R([y(a.due_date),"text-caption"])},r(h(a.due_date)),3)])]),"item.amount":e(({item:a})=>[s("div",Ft,[s("span",Rt,r(d(a.remaining)),1),s("span",Ht,"من "+r(d(a.total)),1)])]),"item.urgency":e(({item:a})=>[t(E,{color:b(a.due_date),size:"small",variant:"flat",class:"font-weight-bold px-3"},{default:e(()=>[w(r(z(a.due_date)),1)]),_:2},1032,["color"])]),"no-data":e(()=>[s("div",Qt,[t(k,{icon:"ri-checkbox-circle-fill",size:"48",color:"success",class:"mb-2 opacity-50"}),g[0]||(g[0]=s("div",{class:"text-subtitle-1 text-success font-weight-medium"},"ممتاز! لا توجد مديونيات متأخرة حالياً",-1))])]),_:1},8,["items","loading"]))}},Xt={class:"d-flex align-center py-2"},Jt={class:"text-info font-weight-bold text-caption"},Kt={class:"d-flex flex-column"},Yt={class:"font-weight-bold text-body-1"},Zt={class:"text-caption text-grey"},te={class:"d-flex flex-column"},ee={class:"font-weight-bold text-body-2"},se={class:"text-caption text-grey"},ae={class:"d-flex flex-column"},oe={class:"font-weight-medium text-body-2"},ne={class:"font-weight-black text-body-1 text-info text-end"},le={class:"text-center pa-8"},ie={__name:"UpcomingInstallments",props:{installments:{type:Array,required:!0},loading:{type:Boolean,default:!1}},setup(p){const u=p,i=[{title:"العميل",key:"customer"},{title:"القسط",key:"installment_details"},{title:"تاريخ الاستحقاق",key:"due_date"},{title:"المبلغ",key:"amount",align:"end"},{title:"الحالة",key:"status"}],c=U(()=>u.installments.length),f=l=>l?new Date(l).toLocaleDateString("ar-EG",{day:"numeric",month:"short"}):"-",d=l=>l?new Intl.NumberFormat("ar-EG",{style:"currency",currency:"EGP"}).format(l):"0.00 ج.م",h=l=>{if(!l)return"-";const g=new Date,o=new Date(l)-g,n=Math.ceil(o/(1e3*60*60*24));return n<0?"متأخر!":n===0?"اليوم":n===1?"غداً":`بعد ${n} يوم`},y=l=>{if(!l)return"";const g=new Date,o=new Date(l)-g,n=Math.ceil(o/(1e3*60*60*24));return n<0?"text-error font-weight-bold":n<=1?"text-warning font-weight-bold":"text-medium-emphasis"},b=l=>({pending:"warning",paid:"success",overdue:"error",cancelled:"grey"})[l]||"info",z=l=>({pending:"معلق",paid:"مدفوع",overdue:"متأخر",cancelled:"ملغي"})[l]||l;return(l,g)=>(m(),v(X,{headers:i,items:p.installments,loading:p.loading,title:"الأقساط المستحقة قريباً",icon:"ri-calendar-schedule-line","hide-footer":"","items-per-page":5},{actions:e(()=>[c.value>0?(m(),v(E,{key:0,color:"info",size:"small",variant:"flat",class:"font-weight-black"},{default:e(()=>[w(r(c.value)+" أقساط مجدولة ",1)]),_:1})):F("",!0)]),"item.customer":e(({item:a})=>{var o;return[s("div",Xt,[t(V,{size:"36",color:"info-lighten-5",class:"me-3"},{default:e(()=>{var n,C;return[s("span",Jt,r((C=(n=a.customer)==null?void 0:n.name)==null?void 0:C.charAt(0)),1)]}),_:2},1024),s("div",Kt,[s("span",Yt,r((o=a.customer)==null?void 0:o.name),1),s("span",Zt,"خطة #"+r(a.plan_number||a.id),1)])])]}),"item.installment_details":e(({item:a})=>[s("div",te,[s("span",ee,"قسط #"+r(a.installment_number),1),s("span",se,"من "+r(a.total_installments)+" قسط",1)])]),"item.due_date":e(({item:a})=>[s("div",ae,[s("span",oe,r(f(a.due_date)),1),s("span",{class:R([y(a.due_date),"text-caption"])},r(h(a.due_date)),3)])]),"item.amount":e(({item:a})=>[s("div",ne,r(d(a.amount)),1)]),"item.status":e(({item:a})=>[t(E,{color:b(a.status),size:"small",variant:"flat",class:"font-weight-bold px-3"},{default:e(()=>[w(r(z(a.status)),1)]),_:2},1032,["color"])]),"no-data":e(()=>[s("div",le,[t(k,{icon:"ri-time-line",size:"48",color:"grey-lighten-2",class:"mb-2 opacity-50"}),g[0]||(g[0]=s("div",{class:"text-subtitle-1 text-grey font-weight-medium"},"لا توجد أقساط مستحقة خلال الفترة القادمة",-1))])]),_:1},8,["items","loading"]))}},re={class:"d-flex align-center justify-space-between mb-4"},ce={class:"chart-wrapper"},de={key:1,class:"d-flex align-center justify-center height-300"},ue={__name:"TopProductsChart",props:{data:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1}},setup(p){const u=p,i=U(()=>[{name:"الكمية",data:u.data.map(f=>f.total_qty)}]),c=U(()=>({chart:{type:"bar",toolbar:{show:!1},fontFamily:"Inter, sans-serif"},plotOptions:{bar:{borderRadius:6,horizontal:!0,distributed:!0,barHeight:"60%"}},colors:["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6"],dataLabels:{enabled:!0,textAnchor:"start",style:{colors:["#fff"]},formatter:function(f,d){return d.w.globals.labels[d.dataPointIndex]+":  "+f},offsetX:0},legend:{show:!1},xaxis:{categories:u.data.map(f=>f.name),labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1}},yaxis:{labels:{show:!1}},grid:{show:!1},tooltip:{theme:"light",y:{formatter:f=>`${f} قطعة`}}}));return(f,d)=>{const h=ct("apexchart");return m(),v(D,{variant:"flat",border:"",class:"chart-card rounded-xl overflow-hidden pa-1"},{default:e(()=>[t(T,{class:"pa-4"},{default:e(()=>[s("div",re,[d[0]||(d[0]=s("div",null,[s("div",{class:"text-caption font-weight-bold text-grey-darken-1 mb-1"},"الأكثر مبيعاً"),s("h3",{class:"text-h6 font-weight-black"},"أفضل 5 منتجات")],-1)),t(Q,{icon:"ri-bar-chart-2-line",variant:"text",size:"small",color:"primary"})]),s("div",ce,[p.loading?(m(),P("div",de,[t(dt,{indeterminate:"",color:"primary"})])):(m(),v(h,{key:0,type:"bar",height:"300",options:c.value,series:i.value},null,8,["options","series"]))])]),_:1})]),_:1})}}},fe=H(ue,[["__scopeId","data-v-83b41ec9"]]),me={class:"d-flex align-center mt-2 flex-row-reverse justify-end"},pe={class:"text-caption white--text",style:{"font-size":"10px !important"}},ge={key:1,class:"text-center pa-12"},_e={key:2,class:"pa-6"},ye={__name:"DashboardTasksWidget",setup(p){return W(()=>{fetchDashboardTasks()}),(u,i)=>(m(),v(D,{class:"rounded-xl border-grey-lighten-4 h-100",variant:"flat",border:""},{default:e(()=>[t(st,{class:"pa-5 d-flex align-center gap-3"},{default:e(()=>[t(k,{icon:"ri-list-check-line",color:"primary"}),i[0]||(i[0]=s("span",{class:"text-h6 font-weight-bold"},"مهامي اليوم",-1)),t(at),t(Q,{icon:"ri-external-link-line",variant:"text",size:"small",to:"/tasks"})]),_:1}),t(ot),t(T,{class:"pa-0"},{default:e(()=>[u.tasks.length>0?(m(),v(O,{key:0,class:"py-0"},{default:e(()=>[(m(!0),P(j,null,N(u.tasks,c=>(m(),v(q,{key:c.id,class:"border-b border-grey-lighten-4 pa-4",onClick:f=>u.goToTask(c)},{prepend:e(()=>[t(ut,{modelValue:c.isDone,"onUpdate:modelValue":f=>c.isDone=f,density:"compact",color:"success",class:"me-2",onClick:ft(f=>u.toggleTask(c),["stop"])},null,8,["modelValue","onUpdate:modelValue","onClick"])]),append:e(()=>[t(E,{color:u.getPriorityColor(c.priority),size:"x-small",variant:"flat"},{default:e(()=>[w(r(u.translatePriority(c.priority)),1)]),_:2},1032,["color"])]),default:e(()=>[t(tt,{class:R([{"text-decoration-line-through text-grey":c.status==="completed"},"font-weight-bold"])},{default:e(()=>[w(r(c.title),1)]),_:2},1032,["class"]),t(et,null,{default:e(()=>{var f;return[w(r(c.description||"لا يوجد وصف")+" ",1),s("div",me,[(m(!0),P(j,null,N((f=c.assignments)==null?void 0:f.slice(0,3),(d,h)=>(m(),v(V,{key:d.id,size:"24",color:d.assignable.color||"primary",class:"border border-white ms-n1",style:mt({zIndex:10-h})},{default:e(()=>{var y,b;return[s("span",pe,r(((y=d.assignable.nickname)==null?void 0:y[0])||((b=d.assignable.name)==null?void 0:b[0])),1)]}),_:2},1032,["color","style"]))),128))])]}),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})):u.loading?(m(),P("div",_e,[t(pt,{type:"list-item-three-line@3"})])):(m(),P("div",ge,[t(k,{icon:"ri-check-double-line",size:"48",color:"grey-lighten-3",class:"mb-2"}),i[1]||(i[1]=s("p",{class:"text-grey mb-0"},"لا يوجد مهام تتطلب انتباهك حالياً",-1))]))]),_:1})]),_:1}))}},he={class:"admin-dashboard"},be={class:"mb-6 px-6 pt-6 d-flex align-center justify-space-between"},xe={class:"px-6 mb-6"},ve={__name:"AdminDashboard",setup(p){const u=gt(),{stats:i,recentInvoices:c,upcomingPayments:f,upcomingInstallments:d,salesTrend:h,topProducts:y,loading:b,loadingUpcoming:z,loadingInstallments:l,refreshing:g,refreshAll:a}=it(),o=[{title:"فاتورة جديدة",subtitle:"إنشاء فاتورة بيع",icon:"ri-file-add-line",color:"primary",route:"/invoices/create"},{title:"تسجيل دفعة",subtitle:"إضافة دفعة جديدة",icon:"ri-money-dollar-circle-line",color:"success",route:"/payments/create"},{title:"منتج جديد",subtitle:"إضافة منتج للمخزون",icon:"ri-shopping-bag-line",color:"info",route:"/products/create"},{title:"عرض التقارير",subtitle:"تقارير مفصلة",icon:"ri-bar-chart-line",color:"warning",route:"/reports"}],n=C=>{u.push(C)};return W(async()=>{await a()}),(C,$)=>(m(),P("div",he,[s("div",be,[$[1]||($[1]=s("div",null,[s("h1",{class:"text-h4 font-weight-bold"},"لوحة التحكم الإحصائية"),s("p",{class:"text-body-1 text-grey"},"تحليل أداء النظام، الفواتير، وحركات المخزون في مكان واحد")],-1)),t(lt,{color:"primary","prepend-icon":"ri-refresh-line",variant:"tonal",loading:_(g),onClick:_(a)},{default:e(()=>$[0]||($[0]=[w(" تحديث البيانات ")])),_:1},8,["loading","onClick"])]),s("div",xe,[_(b)?(m(),v(_t,{key:0,indeterminate:"",color:"primary",class:"rounded-t"})):F("",!0),t(Vt,{stats:_(i)},null,8,["stats"])]),t(L,{class:"px-6 mx-0 mb-6"},{default:e(()=>[t(x,{cols:"12",lg:"8"},{default:e(()=>[t(L,null,{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[t(wt,{data:_(h),loading:_(b)},null,8,["data","loading"])]),_:1})]),_:1})]),_:1}),t(x,{cols:"12",lg:"4"},{default:e(()=>[t(ye)]),_:1})]),_:1}),t(L,{class:"px-6 mx-0 mb-6"},{default:e(()=>[t(x,{cols:"12"},{default:e(()=>[t(fe,{data:_(y),loading:_(b)},null,8,["data","loading"])]),_:1})]),_:1}),t(L,{class:"px-6 mx-0"},{default:e(()=>[t(x,{cols:"12",lg:"4"},{default:e(()=>[t(Pt,{actions:o,onActionClick:n})]),_:1}),t(x,{cols:"12",lg:"8"},{default:e(()=>[t(rt,{invoices:_(c),loading:_(b)},null,8,["invoices","loading"])]),_:1})]),_:1}),t(L,{class:"px-6 mx-0 pb-6 mt-4"},{default:e(()=>[t(x,{cols:"12",md:"6"},{default:e(()=>[t(Wt,{payments:_(f),loading:_(z)},null,8,["payments","loading"])]),_:1}),t(x,{cols:"12",md:"6"},{default:e(()=>[t(ie,{installments:_(d),loading:_(l)},null,8,["installments","loading"])]),_:1})]),_:1})]))}},we={class:"customer-dashboard pa-6"},ke={class:"welcome-section mb-8"},$e={class:"text-h3 font-weight-bold primary-gradient-text"},De={class:"text-h6 text-grey-darken-1 font-weight-regular mt-2"},Ce={class:"text-h3 font-weight-black text-white mt-1"},ze={class:"text-h5 font-weight-bold"},Ie={class:"text-h5 font-weight-bold"},Se={class:"d-flex align-center justify-space-between mb-2"},Te={__name:"CustomerDashboard",setup(p){const u=nt(),{stats:i,recentInvoices:c,upcomingInstallments:f,loadingInvoices:d,refreshAll:h}=it(),y=U(()=>{var a,o;return((o=(a=u.currentUser)==null?void 0:a.full_name)==null?void 0:o.split(" ")[0])||"أهلاً بك"}),b=U(()=>{const a=u.companies.find(o=>{var n;return o.id===((n=u.currentUser)==null?void 0:n.company_id)});return(a==null?void 0:a.name)||"الشركة"}),z=U(()=>{const a=new Date().getHours();return a<12?"صباح الخير":a<18?"مساء الخير":"أهلاً بك"}),l=a=>new Intl.NumberFormat("ar-EG",{style:"currency",currency:"EGP"}).format(a||0),g=[{title:"كشف حسابي",icon:"ri-file-search-line",props:{to:"/reports/my-statement"}},{title:"فواتيري السابقة",icon:"ri-bill-line",props:{to:"/invoices"}},{title:"جدول أقساطي",icon:"ri-calendar-2-line",props:{to:"/installments"}},{title:"تحويل نقدي",icon:"ri-send-plane-2-line",props:{to:"/transactions/create"}}];return W(()=>{h()}),(a,o)=>(m(),P("div",we,[s("div",ke,[s("h1",$e,r(z.value)+", "+r(y.value)+"!",1),s("p",De,"إليك ملخص معاملاتك في "+r(b.value),1)]),t(L,null,{default:e(()=>[t(x,{cols:"12",md:"4"},{default:e(()=>[t(D,{class:"premium-card balance-card",elevation:"4"},{default:e(()=>[o[1]||(o[1]=s("div",{class:"card-glow"},null,-1)),t(T,{class:"d-flex flex-column align-center py-8"},{default:e(()=>{var n;return[t(k,{icon:"ri-wallet-3-line",size:"48",color:"white",class:"mb-4"}),o[0]||(o[0]=s("div",{class:"text-overline text-white-50"},"رصيدك الحالي",-1)),s("div",Ce,r(l((n=_(u).currentUser)==null?void 0:n.balance)),1)]}),_:1})]),_:1})]),_:1}),t(x,{cols:"12",md:"4"},{default:e(()=>[t(D,{class:"premium-card info-card",elevation:"2"},{default:e(()=>[t(T,{class:"d-flex align-center py-6"},{default:e(()=>[t(V,{color:"primary-lighten-4",size:"64",class:"me-4"},{default:e(()=>[t(k,{icon:"ri-shopping-cart-2-line",color:"primary",size:"32"})]),_:1}),s("div",null,[o[2]||(o[2]=s("div",{class:"text-caption text-grey"},"إجمالي المشتريات",-1)),s("div",ze,r(_(i).totalInvoices)+" فاتورة",1)])]),_:1})]),_:1})]),_:1}),t(x,{cols:"12",md:"4"},{default:e(()=>[t(D,{class:"premium-card info-card",elevation:"2"},{default:e(()=>[t(T,{class:"d-flex align-center py-6"},{default:e(()=>[t(V,{color:"warning-lighten-4",size:"64",class:"me-4"},{default:e(()=>[t(k,{icon:"ri-calendar-todo-line",color:"warning",size:"32"})]),_:1}),s("div",null,[o[3]||(o[3]=s("div",{class:"text-caption text-grey"},"أقساط قادمة",-1)),s("div",Ie,r(_(f).length)+" قسط قريباً",1)])]),_:1})]),_:1})]),_:1})]),_:1}),t(L,{class:"mt-6"},{default:e(()=>[t(x,{cols:"12",lg:"8"},{default:e(()=>[t(D,{rounded:"xl",class:"border"},{default:e(()=>[t(yt,{flat:"",color:"transparent",class:"px-4"},{default:e(()=>[t(ht,{class:"font-weight-bold"},{default:e(()=>o[4]||(o[4]=[w("آخر مشترياتي")])),_:1}),t(at),t(lt,{variant:"text",size:"small",to:"/invoices"},{default:e(()=>o[5]||(o[5]=[w("عرض الكل")])),_:1})]),_:1}),t(ot),t(rt,{invoices:_(c),loading:_(d),"hide-actions":""},null,8,["invoices","loading"])]),_:1})]),_:1}),t(x,{cols:"12",lg:"4"},{default:e(()=>[t(D,{rounded:"xl",class:"border bg-grey-lighten-5"},{default:e(()=>[t(st,{class:"font-weight-bold px-6 pt-6"},{default:e(()=>o[6]||(o[6]=[w("روابط سريعة")])),_:1}),t(T,{class:"px-4 pb-6"},{default:e(()=>[t(O,{"bg-color":"transparent"},{default:e(()=>[(m(),P(j,null,N(g,(n,C)=>t(q,bt({key:C,ref_for:!0},n.props,{class:"mb-2 rounded-lg py-3 action-item","prepend-icon":n.icon,title:n.title,variant:"flat",color:"white",elevation:"1"}),null,16,["prepend-icon","title"])),64))]),_:1})]),_:1})]),_:1}),t(D,{rounded:"xl",class:"mt-4 primary-gradient text-white pa-6"},{default:e(()=>[s("div",Se,[o[7]||(o[7]=s("span",{class:"text-h6 font-weight-bold"},"هل تحتاج مساعدة؟",-1)),t(k,{icon:"ri-customer-service-2-line",size:"32"})]),o[9]||(o[9]=s("p",{class:"text-body-2 mb-4 opacity-80"},"نحن هنا لخدمتك دائماً. تواصل معنا لأي استفسار حول معاملاتك.",-1)),t(Q,{block:"",color:"white",variant:"flat",class:"text-primary font-weight-bold rounded-lg"},{default:e(()=>o[8]||(o[8]=[w("تواصل مع الدعم")])),_:1})]),_:1})]),_:1})]),_:1})]))}},Ve=H(Te,[["__scopeId","data-v-108c0bd7"]]),Pe={class:"dashboard-container"},Ae={__name:"Dashboard",setup(p){const u=nt();return(i,c)=>(m(),P("div",Pe,[t(xt,{name:"fade",mode:"out-in"},{default:e(()=>[_(u).isStaff?(m(),v(ve,{key:0})):(m(),v(Ve,{key:1}))]),_:1})]))}},qe=H(Ae,[["__scopeId","data-v-da67bed2"]]);export{qe as default};
