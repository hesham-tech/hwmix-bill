import{u as d}from"./useApi-Dl4iYKvS.js";import{r as u}from"./index-Flp88uEA.js";function h(){const a=d("/api/products"),o=u([]),n=u(!1),c=u(0),p=async(e={})=>{n.value=!0;try{const s=await a.get(e,{showLoading:!1});return o.value=s.data||[],c.value=s.total||0,s}catch(s){throw console.error("Error fetching products:",s),o.value=[],c.value=0,s}finally{n.value=!1}},f=async e=>await a.getById(e),i=e=>{if(e.images&&e.images.some(s=>s.file)){const s=new FormData;return Object.keys(e).forEach(t=>{t==="images"?e.images.forEach((r,l)=>{r.file?s.append(`images[${l}]`,r.file):r.url&&s.append(`existing_images[${l}]`,r.url)}):t==="variants"?s.append("variants",JSON.stringify(e.variants)):t==="tags"?s.append("tags",JSON.stringify(e.tags)):e[t]!==null&&e[t]!==void 0&&s.append(t,e[t])}),s}return e};return{products:o,loading:n,total:c,fetchProducts:p,getProduct:f,createProduct:async e=>{const s=i(e);return await a.create(s,{successMessage:"تم إضافة المنتج بنجاح"})},updateProduct:async(e,s)=>{const t=i(s);return t instanceof FormData?(t.append("_method","PUT"),await a.post(`/${e}`,t,{successMessage:"تم تحديث المنتج بنجاح"})):await a.update(e,t,{successMessage:"تم تحديث المنتج بنجاح"})},deleteProduct:async e=>await a.remove(e,{successMessage:"تم حذف المنتج بنجاح"})}}export{h as u};
