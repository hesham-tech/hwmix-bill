# دليل الهندسة وقواعد التصميم (Engineering & UI/UX Guidelines)

هذا الملف يمثل الذاكرة التقنية والتصميمية للمشروع. يجب الالتزام بهذه القواعد في جميع الموديولات لضمان تجربة مستخدم موحدة واحترافية.

---

## 0. المبادئ الأساسية (Core Principles)
*   **المكونات العالمية أولاً**: قبل كتابة أي كود واجهة، يجب التحقق من المكونات الموجودة في `src/components/common` واستخدامها (مثل `AppButton`, `AppInput`, `AppDialog`). يمنع تكرار منطق موجود مسبقاً.
*   **سيادة Vuetify**: الأولوية القصوى دائماً لمكونات Vuetify (`v-`) وكلاسات المتريال ديزاين الخاصة بها. 
*   **تجنب الـ Custom CSS**: يمنع استخدام عناصر HTML الخام أو كتابة تنسيقات CSS يدوية إلا في حالات نادرة جداً لا تغطيها فئات Vuetify الجاهزة (Utility Classes مثل `ma-`, `pa-`, `d-flex`, `align-center`).
*   **التناسق البصري**: أي عنصر يتم إنشاؤه يجب أن يتبع روح التصميم العام للمشروع من حيث الألوان، الحواف المستديرة، والظلال.

---

## 1. ترويسة الصفحات (Page Headers)
*   **المكون**: `AppPageHeader`.
*   **التثبيت (Sticky)**: يجب أن يكون الهيدر ثابتاً (`sticky`) دائماً لسهولة الوصول للأدوات.
*   **البحث السريع**: يوضع حقل البحث الرئيسي في الـ `controls` slot الخاص بالهيدر ليكون متاحاً أثناء التمرير.
*   **الأيقونات**: يفضل تمرير أيقونة تعبيرية لكل صفحة عبر خاصية `icon`.

## 2. البحث المتقدم (Advanced Search)
*   **المسمى**: يُسمى دائماً **"بحث متقدم"**.
*   **السلوك**: يكون مخفياً افتراضياً وقابلاً للطي والتمدد (`v-expand-transition`).
*   **التحكم**: يتم التحكم في فتحه وإغلاقه عبر زر في الهيدر الثابت.
*   **المؤشرات**: يجب إظهار `v-chip` توضح وجود فلاتر نشطة حتى لو كان القسم مغلقاً.

## 3. التصميم المتجاوب (Mobile Responsiveness)
*   **قاعدة الـ 50%**: الحقول التي لا تطلب نصاً طويلاً (مثل الحالة، التاريخ، نعم/لا) يجب أن تظهر بجانب بعضها في الجوال (`cols="6"` / `sm="6"`) لتوفير المساحة الرأسية.
*   **الحقول الطويلة**: الحقول مثل الأسماء أو الملاحظات تأخذ العرض الكامل (`cols="12"`).

## 4. النوافذ المنبثقة (Dialogs & Forms)
*   **الترتيب**: يتم فصل الأزرار الأساسية (حفظ، تعديل، إغلاق) عن المحتوى القابل للتمرير.
*   **الفوتر الثابت (Fixed Footer)**:
    *   استخدام `hide-actions` في `AppDialog`.
    *   وضع الأزرار في `template #actions`.
    *   يمنع تكرار الأزرار داخل الفورم (`hideActions` prop).
*   **الاتصال**: يتم استخدام `defineExpose` في مكون الفورم لتصدير دالة الحفظ وحالة التحميل (`loading`).

## 5. الأزرار (Buttons)
*   **التوزيع في الجوال**: الأزرار في أسفل النماذج يجب أن تستخدم `flex-grow-1` و `flex-wrap` لتأخذ عرض الشاشة بالتساوي في الجوال.

## 6. قواعد المنطق البرمجي (Backend - Laravel)
*   **إدارة العلاقات**: عند الربط بين مستخدم وشركة، يجب استخدام `updateOrCreate` بدلاً من `create` المباشر لتجنب أخطاء التعارض (409 Conflict).
*   **التدقيق**: يجب إجراء فحص الـ `Conflict` فقط بعد التأكد من وجود السجل، لضمان استقرار عملية الإدخال.

## 7. حلول تقنية شائعة (Common UI Fixes)
*   **التمرير الأفقي (Horizontal Scroll)**: لمنع ظهور شريط تمرير أفقي داخل الـ `v-row` في النوافذ المنبثقة، يجب دائماً إضافة كلاس `mx-0`.
*   **عناصر الإدخال**: يفضل استخدام `density="comfortable"` و `variant="outlined"` لجميع عناصر الإدخال لضمان مظهر موحد واحترافي.

---

> [!TIP]
> **التحديث المستمر**: هذا الملف ينمو مع المشروع. أي قاعدة يتم استنتاجها من النقاش تضاف هنا فوراً.
